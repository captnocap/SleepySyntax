"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2522],{2019:(e,t,s)=>{s.d(t,{F:()=>i});var a=s(86190);let n={sm:"(min-width: 640px)",md:"(min-width: 768px)",lg:"(min-width: 1024px)",xl:"(min-width: 1280px)","2xl":"(min-width: 1536px)"};function i(e){return(0,a.U)(n[e])}},9447:(e,t,s)=>{s.d(t,{z:()=>m});var a=s(42977),n=s(54568),i=s(90510),l=s(64786),r=s(90119),o=s(32987),d=s(53600);function c(){let e=(0,a._)(["\n  from-bg-100\n  via-bg-100\n  via-65%\n  to-bg-100/0\n  pointer-events-none\n  absolute\n  inset-0\n  -bottom-5\n  z-[-1]\n  bg-gradient-to-b\n  blur-sm\n"]);return c=function(){return e},e}let u=i.J.div(c());function m(e){let{children:t,className:s,contentClassName:a,sticky:i,fixed:c,mdTitle:m,large:f,narrow:x}=e,{isMobile:h,isExpanded:g}=(0,d.V)(),p=(0,r.V)(l.E_),v=!t&&!m,j=f&&!p;return(0,n.jsxs)("header",{className:(0,o.A)("flex w-full bg-bg-100",i&&"sticky top-0 z-header",c&&"fixed top-0 z-header",p?l.X_:"h-12",p&&[!g&&"pl-[133px]",!v&&l.zo],j&&["mx-auto md:h-24 md:items-end",x?"max-w-4xl":"max-w-7xl"],s),"aria-hidden":v,children:[!p&&(i||c)&&(0,n.jsx)(u,{}),(0,n.jsx)("div",{className:(0,o.A)("flex w-full items-center justify-between gap-4",p?"pt-0.5":"",p&&!g?"pl-3":"pl-11 lg:pl-8",p&&!(h&&g)&&"draggable",a,j?"px-4 md:pl-8":"pr-3"),children:m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:(0,o.A)("text-text-200 flex items-center gap-2 text-center max-md:hidden min-w-0",p?"font-medium leading-tight tracking-tight":"font-heading",!p&&(j?"text-2xl":"text-lg")),children:(0,n.jsx)("span",{className:"truncate",children:m})}),(0,n.jsx)("div",{}),t]}):t})]})}},11062:(e,t,s)=>{s.d(t,{bl:()=>n});var a=s(61125);async function n(e,t,s,n){let i=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"quick_entry_image",n=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"quick_entry_image",n=atob(e),i=new Uint8Array(n.length);for(let e=0;e<n.length;e++)i[e]=n.charCodeAt(e);let l=a._F[t]||"png";return new File([i],"".concat(s,".").concat(l),{type:t})}(e,t,s),i=new FormData;return i.append("file",n),i}(e,t),l=await n("/api/".concat(s,"/upload"),{method:"POST",body:i});if(l.ok)return[await l.json()];throw Error("Failed to upload image: ".concat(l.status," ").concat(l.statusText))}},11480:(e,t,s)=>{s.d(t,{D8:()=>c,DT:()=>m,Ih:()=>r,h4:()=>o,i1:()=>f});var a=s(54568),n=s(32987),i=s(37463),l=s(7620);let r=(e,t)=>!(!["thinking","tool_use","tool_result"].includes(e.type)||"tool_use"===e.type&&["prism","end_conversation","dolphin","launch_extended_search_task"].includes(e.name))&&(!!t.get("timeline_artifacts_enabled",!1)||("tool_use"!==e.type||"artifacts"!==e.name)&&("tool_result"!==e.type||"artifacts"!==e.name))&&(!!t.get("timeline_gsuite_enabled",!1)||"tool_use"!==e.type||!e.integration_name),o=e=>"tool_result"!==e.type,d=l.createContext({}),c=()=>(0,l.useContext)(d),u=e=>{let[t,s]=(0,l.useState)(void 0),n=(0,l.useMemo)(()=>({expandedItemKey:t,setExpandedItemKey:s}),[t,s]);return(0,a.jsx)(d.Provider,{value:n,children:e.children})},m=e=>{let{children:t,isFirstBlockOfMessage:s,isLastBlockOfMessage:l,isStreaming:r}=e;return(0,a.jsx)(i.P.div,{initial:{opacity:+!r},animate:{opacity:1},transition:{duration:.5,ease:"easeIn"},className:(0,n.A)("transition-all duration-400 ease-out rounded-lg border-0.5 flex flex-col font-ui tracking-tight leading-normal my-3 border-border-300 min-h-[2.625rem] overflow-hidden",s?"mt-2":"mt-3",l?"mb-2":"mb-3"),children:(0,a.jsx)(u,{children:t})})},f=e=>{let{icon:t,isExpanded:s,isFirstItem:i,isLastItem:l,isActive:r,children:o}=e,d={minHeight:"calc((2.125rem - ".concat(t?"16px":"6px",") / 2)")};return(0,a.jsxs)("div",{className:(0,n.A)("flex flex-row min-h-[2.125rem] shrink-0",{"bg-bg-000":s},{"hover:bg-always-black hover:bg-opacity-[0.03]":!s}),children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center pl-3 box-border",children:[(0,a.jsx)("div",{className:(0,n.A)("transition-all w-[1px]",{"bg-border-300":!i}),style:d}),(0,a.jsx)("div",{className:(0,n.A)("transition-all flex items-center justify-center my-1 shrink-0 w-[16px]",{"h-[$16px]":!!t}),children:null!=t?t:(0,a.jsx)("div",{className:(0,n.A)("size-[6px] rounded-full",r?"bg-accent-main-200":"bg-border-300")})}),(0,a.jsx)("div",{className:(0,n.A)("transition-all grow w-[1px]",{"bg-border-300":!l}),style:d})]}),(0,a.jsx)("div",{className:"w-full flex flex-col min-w-0",children:o})]})}},13625:(e,t,s)=>{s.d(t,{d:()=>v,L:()=>p});var a=s(54568),n=s(8027),i=s(11515),l=s(1761),r=s(46760),o=s(62971),d=s(55563),c=s(94748),u=s(41417),m=s(5060);s(7620);var f=s(32987);function x(e){let{symbol:t,variant:s}=e;return(0,a.jsx)("div",{className:(0,f.$)("inline-flex items-center justify-center rounded px-1 py-0.5 text-xs ml-1","secondary"===s&&"bg-bg-300 text-text-400","primary"===s&&"bg-bg-100 bg-opacity-20 text-bg-100"),children:t})}function h(e){let{disabled:t,submitToolApproval:s,showAlwaysAllowed:n,setIsExpanded:i}=e,l=e=>{s(e),i(!1)};return(0,m.W)("keydown",e=>{if("Escape"===e.key){e.preventDefault(),l("deny");return}if("Enter"===e.key){let t=e.metaKey||e.ctrlKey;t&&n?(e.preventDefault(),l("always")):t||(e.preventDefault(),l("once"))}}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 pb-3 pl-3 pr-6",children:[(0,a.jsx)("div",{className:"flex flex-col justify-center items-start p-3 bg-bg-200 border-0.5 border-border-400/15 rounded-md min-h-[41px]",children:(0,a.jsx)("p",{className:"text-xs",children:(0,a.jsx)(o.A,{defaultMessage:"Claude cannot guarantee the security or privacy practices of third-party integrations.",id:"3gyayAmXQv"})})}),(0,a.jsxs)("div",{className:"self-end flex gap-2",children:[(0,a.jsx)(u.$,{variant:"secondary",onClick:()=>l("deny"),append:(0,a.jsx)(x,{symbol:"esc",variant:"secondary"}),children:(0,a.jsx)(o.A,{defaultMessage:"Deny",id:"htvX+Z11l+"})}),n&&(0,a.jsx)(u.$,{variant:"secondary",disabled:t,onClick:()=>l("always"),append:(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(x,{symbol:"⌘",variant:"secondary"}),(0,a.jsx)(x,{symbol:"⏎",variant:"secondary"})]}),children:(0,a.jsx)(o.A,{defaultMessage:"Always allow",id:"lr3QX/nctD"})}),(0,a.jsx)(u.$,{variant:"primary",disabled:t,onClick:()=>l("once"),append:(0,a.jsx)(x,{symbol:"⏎",variant:"primary"}),children:(0,a.jsx)(o.A,{defaultMessage:"Allow once",id:"O2tb5KUxpc"})})]})]})}var g=s(67532);let p=e=>{let{input:t,toolResult:s}=e,n=(0,r.A)(),{activeOrganization:i}=(0,l.YL)(),o=null==i?void 0:i.uuid,c="";if(void 0!==t){try{c=JSON.stringify(t,null,2)}catch(e){c=String(t)}c=(c=c.replace(/\\n/g,"\n").replace(/\\t/g,"	")).replace(RegExp('(?<!\\\\)"',"g"),"`")}return(0,a.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-1",children:[(0,a.jsx)(d.z,{title:n.formatMessage({defaultMessage:"Request",id:"p1P+hQq6tY"}),language:"javascript",code:c}),null==s?void 0:s.content.map((e,t)=>"text"===e.type?(0,a.jsx)(d.z,{title:n.formatMessage({defaultMessage:"Response",id:"MgdnPiJHcj"}),language:"json",code:e.text},t):"image"===e.type?(0,a.jsx)("img",{src:"/api/".concat(o,"/files/").concat(e.file_uuid,"/preview"),alt:n.formatMessage({defaultMessage:"Tool result",id:"OJmR+3dTK6"}),className:"max-w-md max-h-md h-auto rounded-md"},t):void 0)]})},v=e=>{let{toolName:t,integrationName:s,integrationIcon:l,approvalData:r,...d}=e,{input:u,toolResult:m,groupItemKey:f}=d,{isExpanded:x,setIsExpanded:v,snappyTransition:j}=(0,g.a)(!!(null==r?void 0:r.approvalRequired),f),b=!!(null==r?void 0:r.approvalRequired)&&!(null==r?void 0:r.approved),y=b?s?(0,a.jsx)(o.A,{defaultMessage:"Claude wants to use {toolName} from {integrationName}",id:"wPBSjwhfE4",values:{toolName:t,integrationName:s}}):(0,a.jsx)(o.A,{defaultMessage:"Claude wants to use {toolName}",id:"ZNLjFNb5bD",values:{toolName:t}}):t;return(0,a.jsx)(c.sH,{isExpanded:x,setIsExpanded:v,isExpandingDisabled:b,text:y,icon:(0,a.jsx)(i.d,{url:l,fallbackSvg:(0,a.jsx)(n.B,{letter:s||t,size:18}),size:18}),...d,children:(0,a.jsx)(c.NG,{isExpanded:x,snappyTransition:j,isScrollable:!0,footer:b?(0,a.jsx)(h,{...r,setIsExpanded:v}):null,children:(0,a.jsx)(p,{input:u,toolResult:m})})})}},18395:(e,t,s)=>{s.d(t,{B:()=>g});var a=s(54568),n=s(7726),i=s(1761),l=s(9537),r=s(41417),o=s(37076),d=s(54890),c=s(27261),u=s.n(c),m=s(7620),f=s(46760),x=s(62971),h=s(77336);function g(e){var t,s,c,g,p,v;let{conversationUuid:j,message:b,requestedFeedbackType:y,setRequestedFeedbackType:w,isOpen:_,onClose:k,onSuccess:N,showOptions:M=!0}=e,C=(0,f.A)(),[A,S]=(0,m.useState)(""),{data:z}=(0,n.Bq)(j),E=null==z?void 0:z.chat_messages.some(e=>(0,d.Xz)(e).length>0),I=(0,h.V)(null!=(c=null==z?void 0:z.chat_messages)?c:[]).length>0,{mutate:R}=(0,n.HA)(j,b,!!E,{onSuccess:N}),T=(0,m.useId)(),U=null!=(g=null==(t=b.content)?void 0:t.some(e=>"thinking"===e.type))&&g,L="raven"===(0,i.$b)(),F=null;return(null==z||null==(s=z.settings)?void 0:s.enabled_web_search)&&(F=null!=(v=null==(p=b.content)?void 0:p.some(e=>"tool_use"===e.type&&"web_search"===e.name))&&v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("option",{value:"flag/web-over",children:(0,a.jsx)(x.A,{defaultMessage:"Shouldn’t have searched the web",id:"T+mr27AakV"})}),(0,a.jsx)("option",{value:"flag/web-sources",children:(0,a.jsx)(x.A,{defaultMessage:"Don’t like the cited sources",id:"MBNotx/VaO"})})]}):(0,a.jsx)("option",{value:"flag/web-under",children:(0,a.jsx)(x.A,{defaultMessage:"Should have searched the web",id:"CS8kdzupd9"})})),(0,a.jsxs)(o.aF,{isOpen:_,title:C.formatMessage({defaultMessage:"Feedback",id:"Ejhdi47Jk5"}),onClose:k,children:[(0,a.jsxs)("div",{className:"mt-4 flex flex-col",children:[(null==y?void 0:y.includes("flag"))&&M&&(0,a.jsxs)(l.l6,{className:"my-2 max-w-md",label:C.formatMessage({defaultMessage:"What type of issue do you wish to report? (optional)",id:"IFWIi9rs1t"}),value:y,onChange:e=>{w(e.target.value||"flag")},children:[(0,a.jsx)("option",{value:"flag",children:(0,a.jsx)(x.A,{defaultMessage:"Select…",id:"q0+99kUbd6"})}),(0,a.jsx)("option",{value:"flag/bug",children:(0,a.jsx)(x.A,{defaultMessage:"UI bug",id:"0uIYueAyDB"})}),(0,a.jsx)("option",{value:"flag/refusal",children:(0,a.jsx)(x.A,{defaultMessage:"Overactive refusal",id:"Jl0Mn6yDBI"})}),I&&(0,a.jsx)("option",{value:"flag/file",children:(0,a.jsx)(x.A,{defaultMessage:"Poor image understanding",id:"227KYxHrx5"})}),(0,a.jsx)("option",{value:"flag/instructions",children:(0,a.jsx)(x.A,{defaultMessage:"Did not fully follow my request",id:"2uOw8LgMwG"})}),(0,a.jsx)("option",{value:"flag/facts",children:(0,a.jsx)(x.A,{defaultMessage:"Not factually correct",id:"topE9Q6MGe"})}),(0,a.jsx)("option",{value:"flag/incomplete",children:(0,a.jsx)(x.A,{defaultMessage:"Incomplete response",id:"ZNEcy7OM5r"})}),U&&(0,a.jsx)("option",{value:"flag/thoughts",children:(0,a.jsx)(x.A,{defaultMessage:"Issue with thought process",id:"zOab+24EWo"})}),F,(0,a.jsx)("option",{value:"flag/other",children:(0,a.jsx)(x.A,{defaultMessage:"Other",id:"/VnDMl81rh"})})]}),(0,a.jsx)("label",{htmlFor:T,className:"text-text-400 mb-2 text-sm",children:(0,a.jsx)(x.A,{defaultMessage:"Please provide details: (optional)",id:"og1W/bIZdx"})}),(0,a.jsx)(l.fs,{id:T,className:"text-sm",placeholder:(null==y?void 0:y.includes("flag"))?C.formatMessage({defaultMessage:"What was unsatisfying about this response?",id:"+DB/t6WTki"}):C.formatMessage({defaultMessage:"What was satisfying about this response?",id:"yJFWG3mK1I"}),value:A,onChange:e=>{S(e.target.value)}})]}),(0,a.jsx)("p",{className:"text-text-500 mt-3 italic leading-tight",children:(0,a.jsx)("small",{children:(0,a.jsx)(x.A,{defaultMessage:"Submitting this report will send the entire current conversation to Anthropic for future improvements to our models. <link>Learn More</link>",id:"laRJ009b4f",values:{link:e=>(0,a.jsx)(u(),{target:"_blank",rel:"noopener",href:L?"https://privacy.anthropic.com/en/articles/9957937-how-does-anthropic-use-submitted-feedback":"https://privacy.anthropic.com/en/articles/10023565-how-does-anthropic-use-submitted-feedback",className:"text-accent-secondary-100 font-medium hover:underline",children:e})}})})}),(0,a.jsxs)(o.vW,{children:[(0,a.jsx)(r.$,{onClick:()=>{y&&(R({type:y,reason:A||void 0}),k())},children:(0,a.jsx)(x.A,{defaultMessage:"Submit",id:"wSZR47Y5kj"})}),(0,a.jsx)(r.$,{variant:"secondary",onClick:k,children:(0,a.jsx)(x.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})}},20298:(e,t,s)=>{s.d(t,{n:()=>y,M:()=>b});var a=s(7726),n=s(97527),i=s(33200);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s]}var r=s(27062),o=s(37428),d=s(7620),c=s(99965),u=s(92947),m=s(56147),f=s(61125),x=s(75632);async function h(e,t){let s;try{s=await t.callback(e)}catch(t){let e=t instanceof Error?t.message:String(t);throw Error("Error executing code: ".concat(e))}return{is_error:s.isError,content:s.content.map(e=>{switch(e.type){case"text":return{type:"text",text:e.text};case"image":return g({mimeType:e.mimeType,base64Data:e.data});case"resource":{let t=e.resource;if("text"in t)return{type:"text",text:t.text};if("blob"in t){if(!t.mimeType)throw Error("Missing MIME type for embedded resource");return g({mimeType:t.mimeType,base64Data:t.blob})}}}throw Error("Unsupported content type: ".concat(e.type))})}}function g(e){let{mimeType:t,base64Data:s}=e;if(!f._F[t])throw Error("Unsupported image type: ".concat(t));let a=f._F[t];return{type:"image",file_name:"".concat((0,x.N)(),".").concat(a),source:{media_type:t,type:"base64",data:s}}}var p=s(21155);async function v(e,t){let s=p.zN.safeParse(e);if(s.success)try{let e=await t(s.data.code);return{content:[{type:"text",text:JSON.stringify(e)}]}}catch(t){let e=t instanceof Error?t.message:String(t);throw Error("Error executing code: ".concat(e))}throw Error("Error parsing input: ".concat(s.error.message))}var j=s(28871);function b(){let{mutateAsync:e}=(0,a.Pt)(),t=function(){let{executeReplCode:e}=(0,n.q)(),{mcpTools:t}=(0,u.gt)();return(0,d.useCallback)(async(s,a)=>{let n=(0,j.p)(a);if("repl"===s)return await v(n,e);{let e=s.includes(":"),a=null==t?void 0:t.find(t=>(e?"".concat(t.serverName,":").concat(t.name):t.name)===s);if(a)return await h(n,a)}},[e,t])}();return(0,d.useCallback)(async function(s,a,n,i){let{overriddenResult:r}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};l("Tools: Using tool ".concat(a," with input ").concat(i));try{let o=null!=r?r:await t(a,i);if(void 0===o)return void l("Tools: Unable to find tool with name ".concat(a));l("Tools: Result for tool ".concat(a,": ").concat(o)),await e({conversation_uuid:s,type:"tool_result",tool_use_id:n,...o})}catch(i){let t=i instanceof Error?i.message:String(i);l("Tools: Error for tool ".concat(a,": ").concat(t)),await e({conversation_uuid:s,type:"tool_result",tool_use_id:n,content:[{type:"text",text:t}]})}},[t,e])}let y=(e,t)=>{let s=(0,o.wc)(),{servers:a}=(0,u.gt)(),{value:n}=(0,i.N)(null!=e?e:{}),{value:l}=(0,r.fS)("tool_use_artifacts_ga"),{value:f}=(0,r.fS)("namespace_mcp_tools"),x=(0,c.p9)(),h=(0,m.Pb)(t);return(0,d.useCallback)(()=>{let t=[];for(let s of a)for(let a of s.tools){var i,r;if((null==e||null==(i=e.enabled_mcp_tools)?void 0:i[a.enabledKey])!==!1){if(x&&"remote"===s.type)continue;t.push({name:a.name,description:null!=(r=a.description)?r:a.name,input_schema:a.inputSchema,...f?{integration_name:s.name}:{},...(null==s?void 0:s.type)==="remote"&&{mcp_server_uuid:s.uuid,integration_icon_url:s.url}})}}let d=null==s?void 0:s[o.U3];return d&&t.push({type:(null==s?void 0:s[o.$6])||"",name:d}),(l||n)&&t.push({type:"artifacts_v0",name:"artifacts"}),n&&t.push({type:"repl_v0",name:"repl"}),h&&t.push({type:"project_knowledge_search",name:"project_knowledge_search"}),t},[a,null==e?void 0:e.enabled_mcp_tools,n,s,l,h,f,x])}},22134:(e,t,s)=>{s.d(t,{K:()=>g,r:()=>v});var a=s(54568),n=s(8027),i=s(11515),l=s(33395),r=s(43195),o=s(34059),d=s(77101),c=s(32987),u=s(37463),m=s(46760),f=s(55563),x=s(94748),h=s(67532);function g(e){var t,s,n;let i,{integrationName:l,icon:r,integrationIcon:o,message:d,result:c,isStreaming:u,isError:f,isExpandingDisabled:g,isFirstBlockOfMessage:p,isLastBlockOfMessage:w,wrapperClassName:_,contentClassName:k,defaultExpanded:N=!1,toolName:M,renderMode:C,groupItemKey:A,isFirstItemInGroup:S,isLastItemInGroup:z}=e,E=(0,m.A)(),{isExpanded:I,setIsExpanded:R}=(0,h.a)(N,A),T=!!c&&!g&&!u&&("rich_content"!==c.type||(null==(t=c.content)?void 0:t.length)>0);return i=c?"rich_content"===c.type?E.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",id:"s88ium+h8p"},{count:null!=(n=null==(s=c.content)?void 0:s.length)?n:0}):"JSON":void 0,(0,a.jsx)(x.sH,{isError:f,isExpandingDisabled:!T,isExpanded:I,setIsExpanded:R,isStreaming:!!u,text:null!=d?d:u?E.formatMessage({defaultMessage:"Searching",id:"IfE0if3ytt"}):E.formatMessage({defaultMessage:"Searched",id:"0ZuuhwjU4n"}),secondaryText:u?void 0:i,icon:r||(0,a.jsx)(v,{integrationName:l,iconUrl:o,canShowLetterIcon:!0}),isFirstBlockOfMessage:p,isLastBlockOfMessage:w,wrapperClassName:_,renderMode:C,isFirstItemInGroup:S,isLastItemInGroup:z,children:(0,a.jsxs)(x.NG,{isExpanded:I,snappyTransition:!0,isScrollable:!0,className:k,children:[T&&(null==c?void 0:c.type)==="rich_content"&&(0,a.jsx)(j,{disabled:!I||u,result:c,integrationName:l,toolName:M}),T&&(null==c?void 0:c.type)==="table"&&(0,a.jsx)(b,{result:c}),T&&(null==c?void 0:c.type)==="json_block"&&(0,a.jsx)(y,{result:c})]})})}let p=["Google Calendar","Gmail","Google Drive","Search Project Knowledge","Search Past Conversations"],v=e=>{let{canShowLetterIcon:t,integrationName:s,toolName:l,iconUrl:c,size:u=16}=e;switch(s){case"Google Drive":return(0,a.jsx)(o.A9,{type:d.v8.GDRIVE,size:u});case"Google Calendar":return(0,a.jsx)(o.A9,{type:d.v8.GCAL,size:u});case"Gmail":return(0,a.jsx)(o.A9,{type:d.v8.GMAIL,size:u});case"Search Project Knowledge":return(0,a.jsx)(r.JtL,{vectorSizeOverride:u});case"Search Past Conversations":return(0,a.jsx)(r.ce8,{vectorSizeOverride:u})}return(0,a.jsx)(i.d,{fadeInOnLoad:!0,url:c,size:u,fallbackSvg:(s||l)&&t?(0,a.jsx)(n.B,{size:u,letter:s||l}):(0,a.jsx)(r.qzq,{vectorSizeOverride:u,className:"text-text-500"})})},j=e=>{let{disabled:t,integrationName:s,result:n,toolName:i}=e,r=i?i.split("").reduce((e,t)=>e+t.charCodeAt(0),0):0,o=!!s&&p.includes(s)&&2039!==r&&2010!==r;return(0,a.jsx)(u.P.div,{variants:{initial:{opacity:0},animate:{opacity:1,transition:{staggerChildren:.05}}},initial:"initial",animate:"animate",className:"flex flex-col flex-nowrap p-2 pt-0",children:n.content.map((e,n)=>{let{title:i,subtitles:r,url:d,resource_type:c,icon_url:u}=e;return(0,a.jsx)(l.$,{disabled:t,icon:o?void 0:(0,a.jsx)(v,{integrationName:s,iconUrl:u}),title:i,subtitles:r,url:d,tag:c},n)})})},b=e=>{let{result:t}=e;return(0,a.jsx)(w,{table:t.table})},y=e=>{let{result:t}=e,s=(0,m.A)();return(0,a.jsx)("div",{className:"flex flex-col gap-3 p-3 pt-1",children:(0,a.jsx)(f.z,{title:s.formatMessage({defaultMessage:"Response",id:"MgdnPiJHcj"}),code:t.json_block})})},w=e=>{let{table:t}=e;return(0,a.jsx)("div",{className:"grid p-2 pt-0",style:{gridTemplateColumns:"1fr 2fr"},children:t.map((e,s)=>{let[n,i]=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,c.A)("flex items-center p-2",s<t.length-1&&"border-b-0.5 border-border-300"),children:(0,a.jsx)("p",{className:"font-medium text-text-300 text-xs",children:n})}),(0,a.jsx)("div",{className:(0,c.A)("flex items-center p-2",s<t.length-1&&"border-b-0.5 border-border-300"),children:(0,a.jsx)("p",{className:"text-text-500 text-xs",children:i})})]})})})}},22522:(e,t,s)=>{s.d(t,{g:()=>tR,v:()=>tI});var a=s(42977),n=s(54568),i=s(7726),l=s(97527),r=s(8974),o=s(57067),d=s(70011),c=s(85644),u=s(45483),m=s(96784),f=s(1761),x=s(2341),h=s(55554),g=s(90510),p=s(22529),v=s(61547),j=s(29242),b=s(54890),y=s(84062),w=s(27062),_=s(85544),k=s(32987),N=s(37463),M=s(70272),C=s.n(M),A=s(68864),S=s(64155),z=s(27261),E=s.n(z),I=s(62942),R=s(7620),T=s(46760),U=s(62971),L=s(75006),F=s(22336),D=s(81527),O=s(56147),P=s(80731),B=s(67257),W=s(35106),G=s(84137),J=s(39741);s(9537),s(43195);var H=s(41417);s(77101),s(33703),s(85717),s(92947),s(91768),s(74211),s(66860),s(61125),s(82200),s(71473);var V=s(41932);s(61527);var Y=s(29722);s(59401),s(9946);var q=s(77186);async function K(e,t,s){return[]}function X(e,t,s){let[a,n]=(0,R.useState)([]),[i,l]=(0,R.useState)(!1),[r,o]=(0,R.useState)(null),{activeOrganization:d}=(0,f.YL)(),{value:c}=(0,w.fS)("trials_and_tribulations_of_high_school_football"),u=c&&!1,m=(0,R.useCallback)(async()=>{if(u&&e&&(null==d?void 0:d.uuid)){l(!0),o(null);try{let t=(await K(d.uuid,e,"outputs")).map(e=>{let t=e.split("/").pop()||e;return{path:e,name:t}});n(t)}catch(e){o("Failed to load files")}finally{l(!1)}}},[u,e,null==d?void 0:d.uuid]);return(0,R.useEffect)(()=>{u&&m()},[u,m]),{files:a,isLoading:i,error:r,refetch:m}}s(97509),s(42067),s(37076);var Z=s(70067);function Q(e){var t;return!!$(e)&&!!(null==(t=e.content)?void 0:t.some(e=>"tool_result"===e.type&&"artifacts"===e.name))}function $(e){var t;return null==(t=e.content)?void 0:t.find(e=>"tool_result"===e.type&&"launch_extended_search_task"===e.name)}var ee=s(1524);s(25328);var et=s(31417),es=s(85330),ea=s(88346),en=s(56273),ei=s(11515),el=s(37711),er=s(9786),eo=s(98769),ed=s(69307),ec=s(61437),eu=s(76761),em=s(29638),ef=s(99272),ex=s(58911),eh=s(49645),eg=s(89256),ep=s.n(eg),ev=s(94748),ej=s(22134);let eb=e=>{let{onClose:t,onBack:s,onDebug:a,title:i,isHidden:l,className:r}=e;return(0,n.jsxs)("div",{className:"shrink-0 flex items-center justify-between gap-4 w-full min-w-0 px-5 h-[3.25rem]",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 min-w-0",children:[!!s&&(0,n.jsx)(H.$,{variant:"ghost",size:"icon_sm",onClick:s,className:"-ml-1",disabled:l,children:(0,n.jsx)(ed.Z,{size:16})}),(0,n.jsx)("h2",{className:(0,k.A)("text-text-200 truncate text-sm min-w-0 text-ellipsis break-words text-nowrap",r),children:i}),!!a&&(0,n.jsx)(H.$,{variant:"ghost",size:"icon_sm",onClick:a,disabled:l,children:(0,n.jsx)(ec.z,{size:16})})]}),(0,n.jsx)(H.$,{variant:"ghost",size:"icon_sm",onClick:t,className:"-mr-1",disabled:l,children:(0,n.jsx)(eu.X,{size:16})})]})};function ey(e){let{compassStatus:t,onOpenSources:s}=e;if(!t.total_sources)return null;let a=(e=>{let t=new Map,s=new Map;for(let a of e)for(let e of a.annotated_snippets)for(let a of e.tool_calls)if("web_search"===a.tool_name||"web_fetch"===a.tool_name){let e=[];if("web_search"===a.tool_name){if(!a.output||"rich_content"!==a.output.type||!a.output.content)continue;e=a.output.content.map(e=>{let{url:t}=e;return t}).filter(Boolean)}if("web_fetch"===a.tool_name){if(!a.output||"rich_link"!==a.output.type||!a.output.link.url)continue;e=[a.output.link.url]}for(let t of e)if("string"==typeof t)try{let e=new URL(t),a="https://".concat(e.hostname),i=e.hostname.replace(/^www\./,""),l=s.get(i);s.set(i,{count:((null==l?void 0:l.count)||0)+1,icon:(null==l?void 0:l.icon)||(0,n.jsx)(ei.d,{url:a,size:14})})}catch(e){}}else if(a.output){let e=a.integration_name||a.tool_name,s="rich_content"===a.output.type?a.output.content.length:1,i=t.get(e);t.set(e,{count:((null==i?void 0:i.count)||0)+s,icon:(null==i?void 0:i.icon)||(0,n.jsx)(ej.r,{canShowLetterIcon:!0,size:14,iconUrl:a.server_icon_url||void 0,integrationName:a.integration_name||void 0,toolName:a.tool_name})})}let a=Array.from(t.entries()).sort((e,t)=>t[1].count-e[1].count).slice(0,4),i=Array.from(s.entries()).sort((e,t)=>t[1].count-e[1].count).slice(0,4);return a.concat(i).slice(0,4-a.length)})(t.agents),i=a.length>0?a[0][1].count:0,l=t.total_sources-a.reduce((e,t)=>t[1].count+e,0);return 0===a.length?null:(0,n.jsx)("button",{className:"transition-all w-full flex flex-col gap-3 px-4 py-3.5 border-0.5 border-border-300 rounded-xl hover:border-border-100  max-w-[456px]",onClick:s,children:(0,n.jsxs)("div",{className:"flex flex-col gap-2.5 my-1 w-full",children:[a.map((e,t)=>{let[s,{count:a,icon:l}]=e;return(0,n.jsxs)("div",{className:"flex items-center text-xs",children:[(0,n.jsx)("div",{className:"h-4 w-4 flex items-center justify-center mr-2",children:l}),(0,n.jsx)("p",{className:"text-left font-medium w-32 truncate text-text-100 pr-2",title:s,children:s}),(0,n.jsx)("p",{className:"w-24 text-right text-xs text-text-300 pr-2",children:(0,n.jsx)(U.A,{id:"WrpI57Uej/",defaultMessage:"{count, plural, one {# source} other {# sources}}",values:{count:a}})}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(N.P.div,{className:"h-2 rounded-full bg-bg-400",initial:{width:0},animate:{width:"".concat(a/i*100,"%")},transition:{delay:.1*t,duration:.5}})})]},s)}),l>0&&(0,n.jsxs)("div",{className:"flex items-center text-xs text-text-300",children:[(0,n.jsx)(em.H,{size:16,className:"text-text-300 mr-2"}),(0,n.jsx)("p",{children:(0,n.jsx)(U.A,{id:"QX3cxMJ9Tc",defaultMessage:"{totalSources, plural, one {# other source} other {# other sources}}",values:{totalSources:l}})})]})]})})}let ew=e=>{let{title:t,complete:s,className:a}=e;return(0,n.jsx)(N.P.h3,{className:(0,k.A)("text-base text-text-100 font-claude-response",a),initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:s?t:(0,n.jsx)(el.N,{children:t})},t)};function e_(e){let{title:t,description:s,numSources:a,onClick:i,complete:l}=e;return(0,n.jsxs)(N.P.button,{variants:{initial:{opacity:0},animate:{opacity:1}},className:"text-left flex flex-col gap-1.5 transition-all duration-500 group/snippet cursor-pointer",onClick:i,children:[(0,n.jsx)(ew,{title:null!=s?s:t,complete:l}),(0,n.jsx)("div",{className:"transition-all flex flex-row items-center gap-1 text-xs text-text-500 group-hover/snippet:text-text-200",children:0===a?(0,n.jsx)(U.A,{id:"NmCRHK7Fm4",defaultMessage:"No sources yet"}):(0,n.jsx)(U.A,{id:"8NMeuJNj8z",defaultMessage:"{totalSources, plural, one {# source} other {# sources}}",values:{totalSources:a}})})]})}function ek(e){let{status:t,allSnippets:s,onOpenSources:a}=e,[i,l]=(0,R.useState)([]);return(0,R.useEffect)(()=>{!(t.agents.length<1)&&(i.length>=3||l((0,G.mk)({agents:t.agents,n:3})))},[null==t?void 0:t.agents,i.length,l]),(0,n.jsxs)("div",{className:"flex flex-col pt-4 pb-6 gap-4 w-full h-full text-sm text-text-200",children:[(0,n.jsx)(ey,{compassStatus:t,onOpenSources:()=>a(!0)}),s&&s.length>0&&(0,n.jsx)("div",{className:"flex flex-col gap-3",children:(0,n.jsx)(N.P.div,{variants:{initial:{},animate:{transition:{staggerChildren:.08,delayChildren:.05}}},initial:"initial",animate:"animate",className:"flex flex-col gap-4 w-full",children:s.map((e,t)=>(0,n.jsx)(e_,{...e,onClick:()=>a(!0,e.globalAgentIndex)},t))})})]})}function eN(e){let{data:t,onClose:s}=e,[a,i]=(0,R.useState)(!1),[l,r]=(0,R.useState)({sourcesOpen:!1}),{conversationUUID:o,organizationUUID:d,isShared:c,taskId:u}=t,{compassStatus:m}=(0,G.CH)({organizationUUID:d,conversationUUID:o,taskId:u,isShared:c});if(!m)return null;let f=(e,t)=>{r({sourcesOpen:e,index:t})},x=void 0,h=l.sourcesOpen||a;return(0,n.jsxs)("div",{className:"relative h-full w-full bg-bg-000",children:[(0,n.jsx)(N.P.div,{className:"w-full h-full",animate:h?"minimized":"full",variants:{minimized:{scale:.95},full:{scale:1}},children:(0,n.jsx)(eM,{compassStatus:m,onClose:s,onDebug:x,handleOpenSources:f})}),(0,n.jsx)("div",{className:(0,k.A)("absolute top-0 left-0 right-0 bottom-0 h-full w-full pointer-events-none bg-always-black/[5%]",h?"opacity-100":"opacity-0")}),(0,n.jsx)(N.P.div,{animate:h?"visible":"hidden",variants:{visible:{opacity:1,translateX:0},hidden:{opacity:0,translateX:"100%"}},transition:{ease:eo.A.snappyOut},className:(0,k.A)("absolute top-0 left-0 right-0 bottom-0"),children:(0,n.jsx)(eS,{isHidden:!h,compassStatus:m,onBack:a?()=>i(!1):()=>f(!1),onClose:s,onDebug:x,isDebug:a,agentIndex:l.index})})]})}function eM(e){let{compassStatus:t,onClose:s,onDebug:a,handleOpenSources:i}=e,l=(0,T.A)(),r=(0,G.OQ)(t),o=t.status,d=(0,G.Nw)(t),c=t.total_sources||0,u=t.agents.slice(1).flatMap((e,t)=>e.annotated_snippets.flat().filter(e=>e.tool_calls.length>0).map(s=>({...s,total_sources:e.total_sources,description:e.description||e.name,complete:!!(s.complete||e.completed_at),globalAgentIndex:t+1,numSources:e.total_sources}))),m=_.P5.indexOf(o),f=[{title:o===_.zu.Starting||o===_.zu.Planning?l.formatMessage({defaultMessage:"Creating my research plan...",id:"4eRg5buC9J"}):l.formatMessage({defaultMessage:"Research plan created",id:"MIzjwRDSc0"}),children:d?(0,n.jsx)(G.GT,{thought:d,className:"pt-4 pb-6"}):void 0,shown:!0,expandable:!!d},{title:o===_.zu.InitiatingAgents||o===_.zu.Searching?0===c?l.formatMessage({defaultMessage:"Searching for sources...",id:"+4r/aaeR9v"}):l.formatMessage({defaultMessage:"Gathering {count, plural, one {# source} other {# sources}} and counting...",id:"kQHn/iXQmy"},{count:c}):l.formatMessage({defaultMessage:"Gathered {count, plural, one {# source} other {# sources}}",id:"DU/dbPu5mV"},{count:c}),titleIcons:(0,n.jsx)(G.mq,{hrefs:(0,G.mk)({agents:t.agents,n:3})}),children:(0,n.jsx)(ek,{allSnippets:u,status:t,onOpenSources:i}),shown:m>=2||t.agents.length>1,expandable:u.length>0},{title:o===_.zu.Completed?l.formatMessage({defaultMessage:"Boom! Research report is ready",id:"8CCPGtuLnt"}):l.formatMessage({defaultMessage:"Writing and citing report...",id:"2b/CKxnAiJ"}),shown:m>=4,expandable:!1}],x=f.filter(e=>e.expandable).length,h=f.findLastIndex(e=>!!e.expandable),g=(0,R.useRef)(h),[p,v]=(0,R.useState)(h),[j,b]=(0,R.useState)(!0),y=(0,R.useCallback)((e,t,s)=>{b(s),t?v(e):v(+(0===e))},[b,v]);(0,R.useEffect)(()=>{h!==g.current&&y(h,!0,!1)},[y,h]);let w=[_.zu.Cancelled,_.zu.Failed,_.zu.TimedOut].includes(t.status),k=f.filter(e=>e.shown).length;return(0,n.jsxs)("div",{className:"flex flex-col h-full bg-bg-000 overflow-hidden",children:[(0,n.jsx)(eb,{onClose:s,onDebug:a,title:r,className:"font-medium"}),(0,n.jsxs)("div",{className:"flex flex-col overflow-y-auto px-5 pb-5 pt-1 -mt-1",children:[f.map((e,s)=>{let{expandable:a,shown:i,title:l,titleIcons:r,children:o}=e,d=w||s<k-1||t.status===_.zu.Completed;return(0,n.jsx)(eC,{title:l,titleIcons:r,noShimmer:d||w,complete:d,isExpanded:a&&p===s,snappyTransition:j,showLine:s<k-1||w||p===s,handleExpand:e=>y(s,e,!0),expandable:a,collapsible:x>1,shown:i,children:o},s)}),w&&(0,n.jsx)(eC,{title:t.status===_.zu.Cancelled?l.formatMessage({defaultMessage:"Interrupted",id:"rJQDmlVOoX"}):l.formatMessage({defaultMessage:"Something went wrong",id:"JqiqNj0Ooi"}),snappyTransition:!0,noShimmer:!0,isError:!0,handleExpand:ep(),shown:w})]})]})}function eC(e){let{title:t,titleIcons:s,complete:a,expandable:i,collapsible:l,shown:r,isExpanded:o,handleExpand:d,snappyTransition:c,noShimmer:u,isError:m,showLine:f,children:x}=e;return!!r&&(0,n.jsxs)("div",{className:"flex flex-row gap-3 min-h-[2.125rem] shrink-0",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center mt-[5px]",children:[(0,n.jsx)("div",{className:(0,k.A)("transition-all w-2.5 h-2.5 rounded-full shrink-0",m?"bg-danger-200":a?"bg-text-500":"bg-accent-main-200")}),f&&(0,n.jsx)("div",{className:(0,k.A)("transition-all h-full -mb-1 w-[1px]",a?"bg-border-300":"bg-gradient-to-b from-accent-main-200/50 to-accent-main-200/0")})]}),(0,n.jsxs)("div",{className:"w-full flex flex-col",children:[(0,n.jsx)("button",{className:"inline-flex items-center gap-1",onClick:()=>d(!o),disabled:!i||o&&!l,children:(0,n.jsxs)("h4",{className:(0,k.A)("flex flex-row items-center gap-2 transition-colors text-start text-text-100 hover:text-text-000 text-sm h-5 user-select-none",m&&"!text-danger-200"),children:[u?t:(0,n.jsx)(el.N,{children:t}),(0,n.jsx)(eh.N,{children:!!s&&!o&&(0,n.jsx)(N.P.div,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},children:s})}),!!i&&l&&(0,n.jsx)(ef.a,{className:(0,k.A)("bottom-[0.5px] transform transition-transform duration-400 ease-snappy-out text-text-300",o?"rotate-0":"-rotate-90"),size:12})]})}),(0,n.jsx)(ev.NG,{isExpanded:!!i&&!!o,isScrollable:!1,snappyTransition:c,className:"!max-h-none w-full",setIsExpanded:d,children:x})]})]})}function eA(e){var t,s;let{toolCall:a,isHidden:i}=e;if("web_fetch"===a.tool_name&&(null==(t=a.output)?void 0:t.type)==="rich_link"&&a.output.link.url){let{url:e,icon_url:t,title:s,subtitles:l}=a.output.link;return(0,n.jsx)(ev.aX,{isDisabled:i,isStreaming:!1,icon:(0,n.jsx)(ei.d,{fadeInOnLoad:!0,url:t,size:16}),text:(0,n.jsx)(U.A,{defaultMessage:"Fetched <b>{title}</b>",id:"BWNvvK6PhH",values:{title:s,b:e=>(0,n.jsx)("span",{className:"text-text-400",children:e})}}),handleClick:()=>{window.open(e,"_blank")},secondaryText:null==l?void 0:l[0],secondaryIcon:(0,n.jsx)(ex.B,{size:16,className:"text-text-300"}),isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,wrapperClassName:"!my-0"})}return a.output?(0,n.jsx)(ej.K,{integrationName:a.integration_name||void 0,integrationIcon:a.server_icon_url||void 0,message:a.message,isExpandingDisabled:i,result:a.output,isStreaming:!1,isError:a.is_error,isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,wrapperClassName:"!my-0",contentClassName:(null==(s=a.output)?void 0:s.type)==="json_block"?"":"!max-h-none",defaultExpanded:!0}):null}function eS(e){var t;let{isHidden:s,compassStatus:a,onClose:i,onDebug:l,onBack:r,isDebug:o,agentIndex:d}=e,c=(0,R.useRef)(null),u=(0,T.A)(),m=d?!!(null==(t=a.agents[d])?void 0:t.completed_at):a.status===_.zu.Completed,f=void 0===d?null:a.agents[d].description||a.agents[d].name,x=function(e,t){let s=[];for(let a of t?[e.agents[t]]:e.agents)for(let e of a.annotated_snippets)for(let t of e.tool_calls)t.output&&s.push({toolCall:t,timestamp:e.complete&&a.completed_at||a.started_at});return s.sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime()),s.map(e=>{let{toolCall:t}=e;return t})}(a,d),h=void 0===d?a.total_sources:a.agents[d].total_sources;return(0,n.jsxs)("div",{className:(0,k.A)("text-sm bg-bg-000 h-full overflow-hidden flex flex-col",s&&"pointer-events-none user-select-none"),children:[(0,n.jsx)(eb,{onDebug:o?void 0:l,isHidden:s,title:o?"Ant only debug panel":u.formatMessage({defaultMessage:"{totalSources, plural, one {# source} other {# sources}} {status}",id:"8cAP0ZJRie"},{totalSources:h,status:m?"":(0,n.jsx)(U.A,{id:"um9oac7M9y",defaultMessage:"and counting..."})}),onClose:i,onBack:()=>{setTimeout(()=>{c.current&&(c.current.scrollTop=0)},500),r()}}),(0,n.jsxs)("div",{ref:c,className:"relative flex-1 overflow-auto px-5 pt-1 pb-5",children:[!!f&&(0,n.jsx)(ew,{title:f,complete:m,className:"pt-1 pb-5"}),x.length>0?(0,n.jsx)("div",{className:"flex flex-col gap-4",children:x.map((e,t)=>(0,n.jsx)(eA,{toolCall:e,isHidden:s},t))}):(0,n.jsx)("div",{className:"text-text-500 text-center px-8 py-16",children:(0,n.jsx)(U.A,{id:"yWSiuEkfbY",defaultMessage:"No sources found"})})]})]})}var ez=s(30453),eE=s(7386),eI=s(21777),eR=s(23661),eT=s(18179),eU=s(9122),eL=s(7582),eF=s(34933),eD=s(52584);let eO=e=>{let{type:t,size:s,className:a,isLoading:i=!1}=e;return(0,n.jsx)("div",{className:(0,k.A)("bg-bg-100 text-text-500 flex items-center justify-center rounded-l-[inherit]","default"===s&&"w-14","sm"===s&&"w-11",a),children:i?(0,n.jsx)(eT.Loading,{size:"sm"}):(0,n.jsx)(()=>{switch(t){case b.vU.Markdown:return(0,n.jsx)(eU.O,{size:24});case b.vU.Svg:return(0,n.jsx)(eL.D,{size:24});case b.vU.Html:return(0,n.jsx)(eF.q,{size:24});case b.vU.Code:case b.vU.Text:default:return(0,n.jsx)(eD.C,{size:24})}},{})})};var eP=s(66849);let eB=e=>{let{artifact:t,onClick:s,size:a="default"}=e,i=(0,eP.Q)(),l=(0,n.jsx)(U.A,{defaultMessage:"Click to open {artifactType} • {versionCount, plural, one {# version} other {# versions}}",id:"fBoEKmAB/j",values:{artifactType:i[t.type],versionCount:t.versions.length}});return(0,n.jsx)(eW,{previewContent:(0,n.jsx)(eO,{type:t.type,size:a}),title:t.title||(0,n.jsx)(U.A,{defaultMessage:"Untitled",id:"3kbIhS7KZS"}),metaContent:l,onClick:s,size:a,index:0})},eW=e=>{let{previewContent:t,title:s,metaContent:a,size:i,onClick:l,onRemove:r,index:o}=e,d=(0,T.A)(),c=l?"button":"div";return(0,n.jsxs)("div",{className:(0,k.A)("relative","sm"===i&&"max-w-[16rem]"),children:[r&&(0,n.jsx)("button",{className:"bg-bg-000 hover:bg-bg-300 shadow-element absolute right-0 top-0 z-10 -translate-y-2 translate-x-2 cursor-pointer rounded-full p-1",onClick:e=>{e.stopPropagation(),r(o)},children:(0,n.jsx)(eu.X,{size:11,weight:"bold"})}),(0,n.jsxs)(c,{className:(0,k.A)("border-0.5 border-border-300 bg-bg-000 flex flex-1 items-stretch overflow-hidden rounded-lg text-left transition-all","default"===i&&"w-full",!r&&"hover:border-border-200 hover:drop-shadow-sm",!r&&l&&"active:scale-[0.9875]"),onClick:l,disabled:!l,"aria-label":d.formatMessage({defaultMessage:"Preview contents",id:"hmKJSoIQ4a"}),children:[t,(0,n.jsxs)("div",{className:(0,k.A)("padding min-w-0 flex-1 pl-3 pr-2","default"===i&&"py-3","sm"===i&&"py-2"),children:[(0,n.jsx)("div",{className:(0,k.A)("break-words text-sm font-medium leading-tight","default"===i&&"line-clamp-2 font-medium","sm"===i&&"line-clamp-1"),children:s}),a&&(0,n.jsx)("div",{className:"text-text-400 line-clamp-1 text-xs",children:a})]})]})]})};var eG=s(49077),eJ=s(74744),eH=s(52450),eV=s(89436);let eY=e=>{let{projectUuid:t}=e,{data:s}=(0,D.fo)(t);return s?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("h3",{className:"text-text-300 mb-2 mt-4 text-sm font-medium",children:(0,n.jsx)(U.A,{defaultMessage:"Project content",id:"/IJPT7JRFn"})}),(0,n.jsxs)("div",{className:"border-border-400 rounded-lg border px-3 py-4",children:[(0,n.jsxs)(E(),{href:"/project/".concat(t),className:"hover:text-text-000 flex items-center gap-1.5 hover:underline",children:[(0,n.jsx)(eL.D,{size:16,className:"text-text-300 shrink-0"}),(0,n.jsx)("div",{className:"font-claude-response text-text-200 leading-tight tracking-tight",children:s.name})]}),(0,n.jsx)("div",{children:(0,n.jsx)(eV.t,{project:s,className:"text-text-400 text-xs"})}),(0,n.jsx)("ul",{className:"mt-2 flex flex-col",children:(0,n.jsx)(Y.b,{isEditable:!1,project:s,maxItems:3,onViewAll:()=>{window.location.href="/project/".concat(t)}})})]})]})}):null};function eq(e){let{conversationUUID:t,onClose:s,projectUuid:a,wiggleFiles:i=[],onRefreshFiles:l}=e,{allModelOptions:r}=(0,c.A9)(),{chatResourceState:{artifacts:o,attachments:u,files:m,syncSources:f},dispatchChatResource:x}=(0,en.i)(),h=(0,d.Z3)(t),g=r.find(e=>e.model===h),{modelConfig:p}=(0,c.fC)(h),v=p.image_in,{imageFiles:j,sanitizedDocumentFiles:b,blobFiles:y,wiggleVMFiles:_}=(0,R.useMemo)(()=>m.reduce((e,t)=>{switch(t.file_kind){case eR.M.Image:e.imageFiles.push(t);break;case eR.M.Blob:e.blobFiles.push(t);break;case eR.M.SanitizedDocument:e.sanitizedDocumentFiles.push(t);break;case eR.M.WiggleVM:e.wiggleVMFiles.push(t)}return e},{imageFiles:[],blobFiles:[],sanitizedDocumentFiles:[],wiggleVMFiles:[]}),[m]),k=Object.values(o),{value:N}=(0,w.fS)("conversation_export"),M=(0,n.jsxs)("div",{className:"border-border-400 rounded-lg border px-3 py-5 text-center",children:[(0,n.jsx)("div",{className:"font-claude-response mb-1",children:(0,n.jsx)(U.A,{defaultMessage:"No content added yet",id:"KWvxczfvCc"})}),(0,n.jsx)("div",{className:"text-text-300 mb-1 text-xs",children:v?(0,n.jsx)(U.A,{defaultMessage:"Add images, PDFs, docs, spreadsheets, and more to summarize, analyze, and query content with Claude.",id:"HJx5jgEsVM"}):(0,n.jsx)(U.A,{defaultMessage:"Add PDFs, docs, spreadsheets, and more to summarize, analyze, and query content with Claude.",id:"J0WpDuvvlE"})})]});return(0,n.jsx)("div",{className:"h-full flex flex-col",children:(0,n.jsx)(eI.E,{children:(0,n.jsxs)("div",{className:"px-5 pb-4 pt-2",children:[(0,n.jsxs)("div",{className:"flex items-center draggable pl-7 md:pl-1 pr-0.5",children:[(0,n.jsx)("h2",{className:"font-ui flex-1 text-lg font-medium tracking-tight",children:(0,n.jsx)(U.A,{defaultMessage:"Chat controls",id:"nBvhDBTi6q"})}),(0,n.jsx)(H.$,{variant:"ghost",size:"icon",className:"-mr-2",onClick:s,children:(0,n.jsx)(eu.X,{size:20})})]}),g&&(0,n.jsxs)("div",{className:"my-2",children:[(0,n.jsx)("div",{className:"text-text-200 text-lg",children:(0,n.jsx)(eG.V,{model:g})}),(0,n.jsxs)("p",{className:"text-text-300 text-sm",children:[g.description,"\xa0",(0,n.jsx)("a",{className:"hover:text-text-000 underline",href:"https://www.anthropic.com/product",target:"_blank",rel:"noopener",children:(0,n.jsx)(U.A,{defaultMessage:"Learn more",id:"TdTXXf940t"})})]})]}),k.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"text-text-300 mb-2 mt-4 text-sm font-medium",children:(0,n.jsx)(U.A,{defaultMessage:"Artifacts",id:"eW5eoWkxy3"})}),(0,n.jsx)("ul",{className:"mt-2 flex flex-col gap-2",children:k.map((e,t)=>(0,n.jsx)("li",{children:(0,n.jsx)(eB,{artifact:e,onClick:()=>x({type:"SELECT_ARTIFACT",id:e.id})})},"artifact-".concat(t)))})]}),a&&(0,n.jsx)(eY,{projectUuid:a,dispatchChatResource:x}),"",(0,n.jsx)("h3",{className:"text-text-300 mb-2 mt-4 text-sm font-medium",children:(0,n.jsx)(U.A,{defaultMessage:"Content",id:"Jq3FDzj0/T"})}),j.length+y.length+b.length+_.length+u.length+f.length>0?(0,n.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(120px,1fr))] gap-3",children:[[...j,...y,...b,..._].map((e,t)=>(0,n.jsx)(eE.NM,{size:"stretch",file:e},"".concat(e.file_kind,"-").concat(t))),u.map((e,t)=>(0,n.jsx)(eE.NM,{size:"stretch",file:e,handleClick:()=>x({type:"SELECT_ATTACHMENT",attachment:e})},"attachment-".concat(t))),f.map(e=>(0,n.jsx)(eJ.br,{size:"stretch",syncSource:e,isEditable:!1,location:"chat"},e.uuid))]}):M,N&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"text-text-300 mb-2 mt-5 text-sm font-medium",children:(0,n.jsx)(U.A,{defaultMessage:"Export conversation",id:"GZQU9SwGHT"})}),(0,n.jsx)(eH.aS,{conversationUUID:t})]})]})})})}let eK=e=>{let{docUuid:t,projectUuid:s,goBack:a,onClose:i}=e,{data:l}=(0,V.Rn)({projectUuid:s,docUuid:t});if(!l)return null;let r={file_name:l.file_name,file_size:l.content.length,file_type:"text/plain",extracted_content:l.content,origin:eR.R.UserUpload};return(0,n.jsx)(ez.f,{attachment:r,goBack:a,onClose:i})};s(56370),s(24934),s(61773),s(49146),s(53029),s(19544),s(56340),s(89697),s(9234);let eX=(0,R.memo)(function(e){let{conversationUUID:t,onClose:s,isStreaming:a,projectUuid:i,sendMessage:l,isOpen:r,messages:o,isTemporary:d=!1}=e,{activeOrganization:c}=(0,f.YL)(),{chatResourceState:{selectedItem:u,artifacts:m,activeMessageUUID:x,attachments:h,files:g},dispatchChatResource:p}=(0,en.i)(),v=null==c?void 0:c.uuid,{files:j,refetch:b}=X(t,r,d),y=(0,es.f)(),w=(0,et.y)(h,g,v,i),_=(0,R.useMemo)(()=>({claudeComplete:y,getFile:w}),[y,w]),k=(0,R.useCallback)(e=>{(null==u?void 0:u.type)==="artifact"&&p({type:"SELECT_ARTIFACT",id:u.id,versionUUID:e})},[u,p]),N=(0,R.useCallback)(e=>p({type:"SELECT_DOC",id:e}),[p]),M=(0,R.useCallback)(()=>p({type:"CLEAR_SELECTED"}),[p]);return(0,n.jsxs)(n.Fragment,{children:[(null==u?void 0:u.type)==="artifact"&&m[u.id]&&(0,n.jsxs)("div",{className:"relative h-full",children:["",(0,n.jsx)(ea.CV,{isStreaming:a,artifact:m[u.id],selectedArtifactMessageUUID:x,selectedArtifactVersionUUID:u.versionUUID,setSelectedArtifactVersionUUID:k,onClose:s,projectUuid:i,selectDoc:N,sendMessage:l,richSandboxCapabilities:_,isOpen:r,isTemporary:d})]}),(null==u?void 0:u.type)==="artifact"&&!m[u.id]&&(0,n.jsx)(ea.CV,{isStreaming:a,artifact:void 0,selectedArtifactMessageUUID:x,selectedArtifactVersionUUID:(null==u?void 0:u.type)==="artifact"?u.versionUUID:void 0,setSelectedArtifactVersionUUID:k,onClose:s,projectUuid:i,selectDoc:N,sendMessage:l,richSandboxCapabilities:_,isOpen:r,isTemporary:d}),(null==u?void 0:u.type)==="attachment"?(0,n.jsx)(ez.f,{goBack:()=>p({type:"CLEAR_SELECTED"}),attachment:u.attachment,onClose:s}):(null==u?void 0:u.type)==="compass"?(0,n.jsx)(eN,{data:u.data,onClose:s,goBack:M}):i&&(null==u?void 0:u.type)==="doc"?(0,n.jsx)(eK,{docUuid:u.id,projectUuid:i,onClose:s,goBack:()=>p({type:"CLEAR_SELECTED"})}):(null==u||u.type,(null==u?void 0:u.type)==="artifact"&&m[u.id]?null:(0,n.jsx)(eq,{conversationUUID:t,onClose:s,projectUuid:i,wiggleFiles:j,onRefreshFiles:b}))]})});var eZ=s(51121),eQ=s(18395);function e$(e){let{conversationUuid:t,message:s}=e,a=(0,I.useRouter)(),i=(0,eZ.Y)(),[l,r]=(0,R.useState)(!1);return(0,n.jsxs)("div",{className:" flex flex-col gap-1.5 border-0.5 border-border-300 bg-bg-100 rounded-t-xl text-text-300 font-ui tracking-tight z-10 p-6 ",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row items-center sm:justify-between font-medium",children:[(0,n.jsx)("div",{className:"text-lg",children:(0,n.jsx)(U.A,{defaultMessage:"Chat ended by Claude",id:"dHdfbAOK+j"})}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(H.$,{onClick:()=>a.push("/new"),children:(0,n.jsx)(U.A,{defaultMessage:"Start new chat",id:"KcA+xo4hhh"})}),(0,n.jsx)(H.$,{variant:"secondary",onClick:()=>r(!0),children:(0,n.jsx)(U.A,{defaultMessage:"Give feedback",id:"bCmvTYWKoj"})})]})]}),(0,n.jsx)(eQ.B,{conversationUuid:t,message:s,requestedFeedbackType:"chat_ended",setRequestedFeedbackType:()=>{},isOpen:l,onClose:()=>{r(!1)},onSuccess:()=>i.addSuccess("Feedback submitted successfully"),showOptions:!1})]})}var e0=s(57383),e1=s(74039),e2=s(53248),e3=s(50824),e5=s(56326),e6=s(98518),e4=s(10158),e7=s(46612),e9=s(92075);function e8(){let e=(0,a._)(["\n  w-full\n  flex\n  gap-2\n  bg-warning-orange\n  px-3\n  py-2\n  ","\n"]);return e8=function(){return e},e}let te=["consumer_restricted_mode","consumer_second_warning","consumer_first_warning","recent_election_discussion"],tt=e=>{let{long:t}=e;return(0,n.jsx)("a",{className:"underline",href:e7.Z1,target:"_blank",rel:"noreferrer",children:t?(0,n.jsx)(U.A,{defaultMessage:"Learn more about the types of prompts to avoid {arrow}",id:"6DZ92vAY0j",values:{arrow:"\xbb"}}):(0,n.jsx)(U.A,{defaultMessage:"Learn more {arrow}",id:"ZeACTbo6DM",values:{arrow:"\xbb"}})})},ts={consumer_restricted_mode:[{isDismissible:!1,content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U.A,{defaultMessage:"Because a large number of your prompts have violated our Acceptable Use Policy, we have temporarily applied enhanced safety filters to your chats.",id:"PzePYdPNe4"})," ",(0,n.jsx)(tt,{})]})}],consumer_second_warning:[{isDismissible:!0,content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U.A,{defaultMessage:"It appears your recent prompts continue to violate our Acceptable Use Policy. If we continue seeing this pattern, we’ll apply enhanced safety filters to your chats.",id:"BjivfV2YY6"})," ",(0,n.jsx)(tt,{})]})}],consumer_first_warning:[{isDismissible:!0,content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U.A,{defaultMessage:"It looks like a few of your recent prompts don’t meet our Usage Policy.",id:"Aup/Kzn3Eq"})," ",(0,n.jsx)(tt,{long:!0})]})}],recent_election_discussion:[{isDismissible:!0,content:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(U.A,{defaultMessage:"Claude may not be able to provide accurate, real time information on elections. Please visit <link>TurboVote</link> or check the Secretary of State site for your state to get reliable, up-to-date, non partisan guidance on how and where to vote in elections across the US.",id:"X4J/f3yO08",values:{link:e=>(0,n.jsx)("a",{className:"underline",href:"http://claude.turbovote.org",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"US"},{isDismissible:!0,content:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(U.A,{defaultMessage:"The United Kingdom’s general elections will be held on 4 July, 2024. Please visit the <link>UK Election Commission’s website</link> to get reliable, up-to-date, impartial guidance on how and where to vote in the United Kingdom’s general elections.",id:"VUvO/yD1Iw",values:{link:e=>(0,n.jsx)("a",{className:"underline",href:"https://www.electoralcommission.org.uk/",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"GB"},{isDismissible:!0,content:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(U.A,{defaultMessage:"The French legislative elections will be held in two rounds of voting on June 30 and July 7, 2024. Please consult <link>the French Public Administration website</link> for reliable and up-to-date guidance on where and how to vote in the legislative elections in France.",id:"ZzEMOJWfNz",values:{link:e=>(0,n.jsx)("a",{className:"underline",href:"https://www.service-public.fr/particuliers/vosdroits/N47",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"FR"}]};function ta(e){let{isClaudeDot:t,content:s,isDismissible:a,handleDismiss:i}=e;return(0,n.jsx)("div",{className:t?"fixed top-8 z-10 p-4":"",children:(0,n.jsx)(ti,{$isFloating:t,children:(0,n.jsxs)("div",{className:"items-top flex justify-between",children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:s}),a&&i&&(0,n.jsx)("button",{className:"h-5 cursor-pointer",onClick:()=>void i(),children:(0,n.jsx)(eu.X,{size:24})})]})})})}function tn(e){let{conversationUuid:t}=e,s=(0,e6.st)(),a=(0,e4.fZ)(),{account:i,activeOrganization:l}=(0,f.YL)(),r=null==i?void 0:i.uuid,o=null==l?void 0:l.uuid,{mutateAsync:d}=(0,e9.iD)(),{data:c}=(0,e9.Nj)(null==l?void 0:l.uuid),u=(0,e4._r)().ipCountry,m=(null==c?void 0:c.active_flags)&&(null==c?void 0:c.active_flags.map(e=>e.type)),{shownFlagType:x,shownFlagDetails:h}=function(e,t){let s=te.findIndex(e=>null==t?void 0:t.includes(e)),a=te[s];if(!a)return{shownFlagType:null,shownFlagDetails:null};let n=ts[a].filter(t=>!t.applicable_country||t.applicable_country===e);return 0===n.length?{shownFlagType:null,shownFlagDetails:null}:{shownFlagType:a,shownFlagDetails:n[0]}}(u,m);if((0,R.useEffect)(()=>{r&&o&&x&&s.track({event_key:"ts.banner.shown",flag_type:x,conversation_uuid:t,account_uuid:r,organization_uuid:o,ipCountry:null!=u?u:"unknown"})},[s,x,t,r,o,u]),!x||!h)return;let{isDismissible:g,content:p}=h,v=async()=>{if(!g)return;let e=[x];"consumer_second_warning"===x&&(null==m?void 0:m.includes("consumer_first_warning"))&&e.push("consumer_first_warning"),await Promise.all(e.map(e=>d({flagType:e})))};return(0,n.jsx)(ta,{isClaudeDot:a,content:p,isDismissible:g,handleDismiss:v})}let ti=g.J.div(e8(),e=>e.$isFloating&&"max-w-3xl\n    mx-auto\n    rounded-md\n    shadow-element\n    z-toast");var tl=s(68020),tr=s(47211),to=s(21599),td=s(26237),tc=s(79900),tu=s(99318),tm=s(8884);let tf=["apps_and_websites","documents_and_templates","games","productivity_tools","creative_projects","quiz_or_survey","start_from_scratch"],tx=e=>{var t;let{selectedLabel:s,disabled:a}=e,i=(0,T.A)(),{track:l}=(0,e6.st)(),r=new Map([["apps_and_websites",i.formatMessage({defaultMessage:"Apps and websites",id:"HC16Tj5QBT"})],["documents_and_templates",i.formatMessage({defaultMessage:"Documents and templates",id:"mLy6zrc3XL"})],["games",i.formatMessage({defaultMessage:"Games",id:"DUyJmj7sj9"})],["productivity_tools",i.formatMessage({defaultMessage:"Productivity tools",id:"t/RMra2cqp"})],["creative_projects",i.formatMessage({defaultMessage:"Creative projects",id:"gZSnjM59XP"})],["quiz_or_survey",i.formatMessage({defaultMessage:"Quiz or survey",id:"yyPDfhkUT7"})],["start_from_scratch",i.formatMessage({defaultMessage:"Start from scratch",id:"fGhwMpK3XG"})]]),o=new Map(Array.from(r,e=>e.reverse())),d=new Map([["apps_and_websites",tl.E],["documents_and_templates",tr.i],["games",to.H],["productivity_tools",td.l],["creative_projects",tc.e],["quiz_or_survey",tu.S],["start_from_scratch",tm.f]]),{sendTransparentMessage:c}=(0,e0.o)(),u=null!=(t=o.get(null!=s?s:""))?t:"default",m=async e=>{r.has(e)&&(l({event_key:"artifact.studio.create_mode_selected",create_mode:e}),await c(r.get(e)))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"font-claude-response-body pl-2 mt-1",children:(0,n.jsx)(U.A,{defaultMessage:"Let’s get cooking! Pick an artifact category or start building your idea from scratch.",id:"HKJSK13xqN"})}),(0,n.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 max-w-xl justify-center items-stretch w-full",children:tf.map(e=>{let t=d.get(e);return(0,n.jsx)("div",{className:(0,k.A)("relative w-full h-full min-h-[3.5rem] sm:h-28 p-3 sm:p-3.5 font-base bg-bg-000 rounded-lg transition-colors group",u===e&&"border-0.5 text-text-100 bg-bg-000 shadow-sm",("default"!==u&&u!==e||"default"===u&&a)&&"text-text-500 bg-bg-000/50 border-0.5 border-border-300","default"===u&&!a&&"border-0.5 border-border-300 text-text-300 hover:border-text-200 hover:bg-bg-000 hover:text-text-100 cursor-pointer shadow-sm"),onClick:async()=>{"default"!==u||a||await m(e)},children:(0,n.jsxs)("div",{className:"flex flex-row sm:flex-col items-center sm:items-start justify-center sm:justify-start h-full w-full gap-3 sm:gap-0",children:[t&&(0,n.jsx)(t,{size:20,weight:"light",className:(0,k.A)("transition-transform duration-300 ease-out shrink-0 sm:absolute sm:bottom-4 sm:right-4","default"===u&&!a&&"group-hover:-rotate-2 sm:group-hover:rotate-2 group-hover:scale-105")}),(0,n.jsx)("span",{className:"flex-1 text-left",children:r.get(e)})]})},e)})})]})};var th=s(95675);let tg=e=>{var t,s,a,i;let{scrollRefs:l,newMessageSent:r,setNewMessageSent:o,scrollContainerRef:d,invalidator:c}=e,[u,m]=(0,R.useState)(0),f=(0,R.useCallback)(()=>{var e,t,s,a;let n=(null==(e=l.lastAssistantMessage.current)?void 0:e.clientHeight)||0,i=(null==(t=l.lastHumanMessage.current)?void 0:t.clientHeight)||0,r=(null==(s=l.chatInput.current)?void 0:s.clientHeight)||0,o=(null==(a=l.extras.current)?void 0:a.clientHeight)||0,d=Math.max(window.innerHeight-i-n-o-r-110,0);d!==u&&m(d)},[l,u]);return(0,R.useLayoutEffect)(()=>{f()},[c,f,null==(t=l.lastAssistantMessage.current)?void 0:t.clientHeight,null==(s=l.lastHumanMessage.current)?void 0:s.clientHeight,null==(a=l.extras.current)?void 0:a.clientHeight,null==(i=l.chatInput.current)?void 0:i.clientHeight]),(0,R.useLayoutEffect)(()=>(window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)),[f]),(0,R.useLayoutEffect)(()=>{r&&(setTimeout(()=>{var e;null==(e=d.current)||e.scrollToBottomIfPinned("smooth")},0),o(!1))},[r,o,d]),(0,R.useEffect)(()=>{var e;null==(e=d.current)||e.scrollToBottomIfPinned("instant")},[d]),(0,n.jsx)("div",{ref:l.extraSpace,style:{height:"".concat(u,"px")},"aria-hidden":"true"})};function tp(){return(0,n.jsx)(N.P.figure,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-text-100 absolute inset-0 grid h-full place-content-center gap-8 text-center","data-testid":"empty-chat-screen",children:(0,n.jsxs)("h2",{className:"font-title flex flex-col items-center justify-center gap-2 sm:flex-row",children:[(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)(v.a,{state:"waiting"})}),(0,n.jsx)(U.A,{defaultMessage:"What can I help you with today?",id:"1PnN/uP0zv"})]})})}var tv=s(71710);let tj="/Spark/",tb=[19,17,16,15,14,13,12,11,1,11,12,13,14,15,16,17,19],ty="".concat(tj,"/Check.svg"),tw=L.z.object({changeTitle:L.z.boolean().optional(),titleDelayMs:L.z.number().optional(),changeFavicon:L.z.boolean().optional(),faviconDelayMs:L.z.number().optional(),playSound:L.z.boolean().optional()}),t_={};var tk=s(98878),tN=s(77763),tM=s(11062);function tC(e){let{chatId:t,chatName:s,onSend:a}=e,{activeOrganization:n}=(0,f.YL)(),i=(0,q.mn)(),l=(0,R.useRef)(!1);return(0,tk._v)(tN.A.ChatInfo,{getCurrentChatInfo:()=>Promise.resolve({chatId:t,chatName:s}),sendToChatWithPayload:e=>e.chatId===t&&!l.current&&!!n&&(l.current=!0,(async()=>{try{let t=[];if(e.imageBase64&&e.imageMimeType)try{t.push(...await (0,tM.bl)(e.imageBase64,e.imageMimeType,n.uuid,i))}catch(e){}return await a({prompt:e.text,files:t}),!0}catch(e){return!1}finally{l.current=!1}})(),!0)},[t,s,n,i,a]),null}var tA=s(58565),tS=s(77336);function tz(){let e=(0,a._)(["\n  flex-1\n  flex\n  flex-col\n  gap-3\n  px-4\n  max-w-3xl\n  mx-auto\n  w-full\n"]);return tz=function(){return e},e}let tE=()=>{let[e,t]=(0,R.useState)(""),s=(0,T.A)(),a=(0,R.useMemo)(()=>[s.formatMessage({defaultMessage:"Gathering my thoughts, be right there...",id:"C6UYRcZHCt"}),s.formatMessage({defaultMessage:"Contemplating, stand by...",id:"r6P7kLapjf"}),s.formatMessage({defaultMessage:"Pondering, stand by...",id:"l0/dX2gLlN"}),s.formatMessage({defaultMessage:"Ruminating on it, stand by...",id:"wt2OTGsj0k"}),s.formatMessage({defaultMessage:"Pondering, stand by...",id:"l0/dX2gLlN"})],[s]),i=(0,R.useMemo)(()=>s.formatMessage({defaultMessage:"Still working on it, stand by...",id:"R9hnARYgER"}),[s]),l=(0,R.useMemo)(()=>s.formatMessage({defaultMessage:"A bit longer, thanks for your patience...",id:"MCt5e8xpx8"}),[s]);return(0,R.useEffect)(()=>{let e=setTimeout(()=>{t(a[Math.floor(Math.random()*a.length)])},5e3);return()=>clearTimeout(e)},[a]),(0,R.useEffect)(()=>{let e=setTimeout(()=>{t(i)},15e3);return()=>clearTimeout(e)},[i]),(0,R.useEffect)(()=>{let e=setTimeout(()=>{t(l)},3e4);return()=>clearTimeout(e)},[l]),(0,n.jsx)(N.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},className:"font-claude-response text-text-300 ml-2 pb-1.5 text-sm italic",children:e})};function tI(e){var t,s,a,g,N,M,z,H,V,Y,K,et,es,ea,ei,el;let{changeDisplayedConversationPath:er,conversationTitle:eo,conversationUUID:ed,editMessage:ec,isStreaming:eu,isTemporary:em=!1,isLoading:ef,messages:ex,name:eh,onRetry:eg,onSend:ep,customFileUploadHandler:ev,projectUuid:ej,setPersonalizedStyleCallback:eb,onToolAllow:ey}=e,{account:ew,activeOrganization:e_}=(0,f.YL)(),{selectedTier:ek}=(0,h.t)(),eN=(0,x.B)(),eM=(0,T.A)(),{value:eC}=(0,w.fS)("new_scroll_behavior"),{value:eA}=(0,w.fS)("claudeai_beam"),eS=(0,R.useRef)(null),ez=(0,R.useRef)(null);ez.current=null==(t=ex[ex.length-1])?void 0:t.uuid;let{chatResourceState:eE,dispatchChatResource:eI}=(0,en.i)(),{serverLastChatMessageWarningProps:eR,updateServerLastChatMessageWarningPropsForNewMessage:eT}=function(e,t){let[s,a]=(0,R.useState)(null),n=function(e){let{activeOrganization:t}=(0,f.YL)(),s="/api/organizations/".concat((null==t?void 0:t.uuid)||"","/chat_conversations/").concat(e,"/chat_message_warning"),{mutateAsync:a}=(0,q.L2)(s,"POST",{meta:{noToast:!0}});return(0,R.useCallback)(async e=>{let t=await a(e);return t.warning_props?{contentMarkdown:t.warning_props.content_markdown,style:t.warning_props.style}:null},[a])}(e),i=(0,R.useCallback)(e=>{async function t(){try{a(await n(e))}catch(e){}}a(null),t()},[n]),l=(0,R.useCallback)(e=>{let{messageText:t,parentMessageUuid:s}=e;i({message_text:t,analytics_data:{type:"message_send",prev_message_uuid:s&&s!==o.gF?s:null}})},[i]);return function(e){let{chatMessages:t,onLastMessageLoaded:s}=e,a=(0,R.useRef)(t.filter(e=>"human"===e.sender).pop());(0,R.useEffect)(()=>{if(!a.current)return;let e=(0,e2.C)(a.current);e&&s({uuid:a.current.uuid,messageText:e})},[s])}({chatMessages:t,onLastMessageLoaded:(0,R.useCallback)(e=>{let{uuid:t,messageText:s}=e;i({message_text:s,analytics_data:{type:"conversation_load",message_uuid:t}})},[i])}),{serverLastChatMessageWarningProps:s,updateServerLastChatMessageWarningPropsForNewMessage:l}}(ed,ex),{setSandboxState:eU}=(0,l.q)(),eL=(0,I.useSearchParams)(),[eF,eD]=(0,R.useState)(!1),[eO,eP]=(0,R.useState)(null),eB={lastAssistantMessage:(0,R.useRef)(null),lastHumanMessage:(0,R.useRef)(null),chatInput:(0,R.useRef)(null),extras:(0,R.useRef)(null),extraSpace:(0,R.useRef)(null)},eW=(0,R.useCallback)(()=>{let e=eB.lastAssistantMessage.current;if(!e)return!0;let t=e.getBoundingClientRect(),s=window.innerHeight;return t.bottom<s+50},[eB.lastAssistantMessage]);(0,R.useEffect)(()=>{if(y.o.scrollAwareSmootherOptimization)return eu?r.Z.setVisibilityCheck(eW):r.Z.clearVisibilityCheck(),()=>{r.Z.clearVisibilityCheck()}},[eu,eW]);let eG=(0,ee.u)(),eJ=null==ew||null==(s=ew.settings)?void 0:s.enabled_monkeys_in_a_barrel,eH=(0,R.useMemo)(()=>{},[eG,null==e_?void 0:e_.uuid,ed,eJ]),eV=(0,R.useRef)(null),eY=(0,R.useCallback)(async e=>{let{prompt:t,attachments:s,files:a,syncSources:n,personalized_style:i,compass_mode:l}=e;if(eu)return;eI({type:"SET_ACTIVE_MESSAGE_UUID",uuid:void 0}),eT({messageText:t,parentMessageUuid:ez.current}),eU(ed,{conversationFiles:[...eE.files,...a],allAttachments:[...eE.attachments,...s],projectUuid:ej});let r={prompt:t,attachments:s,files:a,syncSources:n,rethrowErrors:!0,parent_message_uuid:ez.current||o.gF,personalized_style:i,org_type_override:null!=ek?ek:void 0,compass_mode:l};eD(!0),await ep(r)},[eu,eI,eT,eU,ed,eE.files,eE.attachments,ep,ej,ek]),eq=(0,R.useCallback)((e,t)=>{eI({type:"SET_ACTIVE_MESSAGE_UUID",uuid:void 0}),eU(ed,{conversationFiles:eE.files,allAttachments:eE.attachments,projectUuid:ej}),eg(e,t)},[eI,eU,ed,eE.files,eE.attachments,eg,ej]),eK=(0,R.useCallback)(async()=>{if(eu)return;let e=eM.formatMessage({defaultMessage:"Continue",id:"acrOozm08x"});await ep({prompt:e,attachments:[],files:[],syncSources:[],rethrowErrors:!0,parent_message_uuid:ez.current||o.gF})},[eM,eu,ez,ep]),eZ=(0,R.useCallback)((e,t)=>{if(ec){var s;eI({type:"CLEAR_SELECTED"}),ec(e,t),eT({messageText:t,parentMessageUuid:null!=(s=e.parent_message_uuid)?s:null})}},[eI,ec,eT]),eQ=(0,R.useMemo)(()=>(0,S.A)(),[]);(0,R.useEffect)(()=>(eQ.on("retry",e=>{let{parent_message_uuid:t,paprika_mode:s}=e;eq(t,s)}),eQ.on("edit",e=>{let{message:t,text:s}=e;eZ(t,s)}),()=>{eQ.off("retry"),eQ.off("edit")}),[eQ,eq,eZ]);let[e6,e4]=(0,R.useState)("");(0,R.useEffect)(()=>{eu||e4(ex.map(e=>(0,i.Rs)(e)).join(" "))},[ex,eu]);let e7=(0,m.F)(e6),{files:e9,attachments:e8,artifacts:te}=eE,{isDrawerExpanded:tt,setIsDrawerExpanded:ts}=(0,th.x)(),ta=(0,R.useCallback)(()=>{eI({type:"CLEAR_SELECTED"}),ts(!0)},[eI,ts]),ti=(0,R.useCallback)(()=>{ts(!1)},[ts]),tl=(0,tS.V)(ex);(0,R.useEffect)(()=>{eI({type:"UPDATE_FILES",files:tl})},[tl,eI]),(0,R.useEffect)(()=>{eI({type:"UPDATE_ATTACHMENTS",attachments:ex.flatMap(e=>e.attachments)})},[eI,ex]),(0,R.useEffect)(()=>{eI({type:"UPDATE_SYNC_SOURCES",syncSources:ex.flatMap(e=>e.sync_sources)})},[eI,ex]);let tr=(0,R.useCallback)(e=>{ta(),eI({type:"SELECT_ATTACHMENT",attachment:e})},[eI,ta]),to=(0,R.useMemo)(()=>!!((null==eN?void 0:eN.preview_feature_uses_artifacts)||ex.some(e=>Q(e))),[eN,ex]),td=(0,R.useCallback)((e,t,s)=>{ta(),eI({type:"SELECT_ARTIFACT",id:e,versionUUID:s}),eI({type:"SET_ACTIVE_MESSAGE_UUID",uuid:t||""})},[eI,ta]),tc=ex[ex.length-1];(0,R.useEffect)(()=>{if(!to)return;let e={};ex.forEach(t=>{(0,b.Xz)(t).forEach(t=>{var s,a,n;let{id:i,currentVersion:l,type:r,title:o,language:d}=t,c=(0,b.zI)(l,null==(n=e[i])||null==(a=n.versions)||null==(s=a.slice(-1)[0])?void 0:s.resultState),u={...l,resultState:c};e[i]?e[i].versions.push(u):e[i]={id:i,type:r||"document",title:o||"Untitled",language:d||void 0,versions:[u]}})}),eI({type:"UPDATE_ARTIFACTS",artifacts:e})},[ex,to,tc,eI]);let tu=tc?(0,b.Xz)(tc):[],tm=null!=(ea=C()(tu))?ea:null,tf=null!=(ei=null==tm?void 0:tm.id)?ei:null,{files:tk,refetch:tN}=X(ed,tt,em);(0,R.useEffect)(()=>{ex.length},[ex,tN,em]);let tM=(0,R.useRef)({lastOpenedArtifactId:null});(0,R.useEffect)(()=>{let e=tM.current.lastOpenedArtifactId===tf;eu&&tf&&!e&&(tM.current.lastOpenedArtifactId=tf,td(tf))},[eu,tf,td]),(0,R.useEffect)(()=>{let e=eL.get("artifactId");e&&(ta(),eI({type:"SELECT_ARTIFACT",id:e}))},[]);let tz=eu&&tc&&tc.content?tc.content[tc.content.length-1]:void 0,tI=eu&&(!tc||!(null==(a=tc.content)?void 0:a[0])&&0===tc.attachments.length&&0===tc.files.length&&0===tc.files_v2.length),tT=tz&&("tool_use"===tz.type||"tool_result"===tz.type),tU=(0,R.useMemo)(()=>{if(tc){let e=$(tc);if(!e)return;let t=e.content.map(e=>e&&"text"in e?e.text:"").join("\n"),{data:s}=Z.z7.safeParse(t);return null==s?void 0:s.task_id}},[tc]),tL=!eu&&void 0!==tU,{compassStatus:tF}=(0,G.CH)({organizationUUID:null==e_?void 0:e_.uuid,conversationUUID:ed,taskId:tU,isShared:!1,enabled:tL}),tD=(0,R.useMemo)(()=>{if(!tc)return!1;let e=$(tc);return!!(e&&!e.is_error&&(0,_.i3)(null==tF?void 0:tF.status)&&!Q(tc))},[tc,tF]),tO=(0,J.Wo)(),tP=(0,J.hG)(),{value:tB}=(0,w.fS)("compass_enable_notifications_web"),tW=(0,R.useMemo)(()=>tI?"thinking":tT||tD?"shimmer":eu?"writing":"static",[tI,tT,eu,tD]);((e,t,s)=>{let a=(0,w.T9)("claude_ai_tabbed_out_notifications","features",t_,tw),n="visible"===(0,tv.f)(),{setThinkingTitle:i,setReceivedTitle:l,resetTitle:r}=((e,t,s)=>{let a=(0,R.useRef)(null),n=(0,R.useCallback)(()=>{a.current&&(clearInterval(a.current),a.current=null),document.title="Working on it..."},[]),i=(0,R.useCallback)(()=>{if(a.current)return;let t=0;a.current=setInterval(()=>{document.title=e[t],t=(t+1)%e.length},s)},[s,e]),l=(0,R.useCallback)(()=>{a.current&&(clearInterval(a.current),a.current=null),document.title=t},[t]);return(0,R.useMemo)(()=>({setThinkingTitle:n,setReceivedTitle:i,resetTitle:l}),[n,i,l])})(["Ready to chat",e],e,a.titleDelayMs||1600),{setWritingFavicon:o,setCompleteFavicon:d,resetFavicon:c}=(e=>{let t=(0,R.useRef)(null),s=(0,R.useCallback)(e=>{let t=document.querySelector("link[rel~='icon']")||document.createElement("link");t.rel="icon",t.href=e,document.head.appendChild(t)},[]),a=(0,R.useCallback)(()=>{t.current&&clearInterval(t.current),t.current=null,s("/favicon.ico")},[s]),n=(0,R.useCallback)(()=>{if(t.current)return;let a=0;t.current=setInterval(()=>{s("".concat(tj,"/").concat(tb[a],".svg")),a=(a+1)%tb.length},e)},[e,s]),i=(0,R.useCallback)(()=>{a(),s(ty)},[s,a]);return(0,R.useMemo)(()=>({setWritingFavicon:n,setCompleteFavicon:i,resetFavicon:a}),[n,i,a])})(a.faviconDelayMs||100),{playSound:u,resetSound:m}=(()=>{let e=(0,R.useRef)(null),t=(0,R.useRef)(!1);(0,R.useEffect)(()=>{try{e.current=new Audio("/click.mp3")}catch(e){}},[]);let s=(0,R.useCallback)(()=>{if(!t.current){t.current=!0;try{e.current||(e.current=new Audio("/click.mp3"))}finally{var s;null==(s=e.current)||s.play()}}},[]),a=(0,R.useCallback)(()=>{t.current=!1},[]);return(0,R.useMemo)(()=>({playSound:s,resetSound:a}),[s,a])})(),f=(0,R.useRef)(!1);(0,R.useEffect)(()=>{let e=t&&s,x=!t&&s,h=!t&&!s;e&&!f.current&&(f.current=!0);let g=h&&f.current;if(g&&(f.current=!1),n){a.changeTitle&&r(),a.changeFavicon&&c();return}a.changeTitle&&(e||x?i():g&&l()),a.changeFavicon&&(x?o():g&&(d(),f.current=!1)),a.playSound&&(e?m():g&&u())},[a,t,s,n,i,l,r,o,d,c,u,m])})(eo,tI,eu);let{getCreateParamsForConvo:tG}=(0,u.I)();(0,R.useEffect)(()=>{if(ef)return;let e=tG(ed);e&&void 0!==e.prompt&&(e.prompt.length>0||e.files.length>0||e.attachments.length>0||e.syncSources.length>0)&&eY(e)},[ed,eY,tG,ef]);let{data:tJ}=(0,D.fo)(ej),tH=(0,P.K)(),tV=(0,O.ED)(ej),{publishedArtifactsByMessageUuid:tY}=(0,F.rC)({includeDeletedArtifacts:!0}),{mutate:tq,isPending:tK}=(0,i.aC)(ed),tX=(0,u.E)(),tZ=(0,R.useCallback)((e,t)=>{eI({type:"CLEAR_SELECTED"}),null==er||er(e,t)},[er,eI]),tQ=(0,d.Z3)(ed);(0,e1.hq)(ed);let t$=null==tc||null==(g=tc.content)?void 0:g.some(e=>"tool_use"===e.type&&"end_conversation"===e.name),{activeModelOptions:t0}=(0,c.A9)(),t1=L.z.array(L.z.string()),t2=(0,w.T9)("invite_contest_name","model_prefixes",[],t1),{data:t3}=(0,i.Fn)();(0,R.useEffect)(()=>{var e,t;if(!eu&&2===ex.length&&(null==(e=ex[0])?void 0:e.sender)==="human"&&(null==(t=ex[1])?void 0:t.sender)==="assistant"&&t2.some(e=>null==tQ?void 0:tQ.startsWith(e))&&t3&&t3.count>=2){let e=new CustomEvent("firstClaudeMessage",{detail:{conversationUUID:ed,model:tQ}});window.dispatchEvent(e)}},[eu,ex,tQ,ed,t2,t3]);let t5=(0,R.useMemo)(()=>{let e=eM.formatMessage({defaultMessage:"Learn about Claude’s responses ↗",id:"dD0oo8Rjtz"}),t=t0.find(e=>e.model===tQ);if(!t||!t.knowledgeCutoff)return e;let s=A.c9.fromFormat(t.knowledgeCutoff,"LLLL yyyy",{locale:"en-US"});if(!s.isValid)return eM.formatMessage({defaultMessage:"Knowledge limited past {cutoff}. Learn more ↗",id:"fozOi7zOey"},{cutoff:t.knowledgeCutoff});{let e=s.toLocaleString({year:"numeric",month:"long"},{locale:eM.locale});return eM.formatMessage({defaultMessage:"Knowledge limited past {cutoff}. Learn more ↗",id:"fozOi7zOey"},{cutoff:e})}},[tQ,t0,eM]),t6=(0,R.useMemo)(()=>te,[!eu&&te]),t4=tt&&eE.selectedItem?eE.selectedItem:void 0,t7=(0,R.useCallback)(e=>(0,n.jsx)(tA.A,{...e,conversationUUID:ed,artifacts:t6,onOpenArtifact:to?td:void 0,onAllow:e.isLastMessage&&!e.toolResult?ey:void 0,selectedDrawerItem:t4}),[ed,t6,to,td,ey,t4]),t9=(0,R.useCallback)(()=>{eP({})},[]),t8=(0,R.useMemo)(()=>({id:ed,messagesSoFar:ex.length,tokensSoFar:e7,files:e9,attachmentsSoFar:e8.length,isSampling:eu,isStoppingSampling:tK,model:tQ,projectKnowledgebaseTokens:null!=tV?tV:0,conversationSettings:eN}),[e8.length,eN,e7,ed,e9,tK,eu,ex.length,tQ,tV]),se=(0,R.useMemo)(()=>tc&&"assistant"===tc.sender&&tc.content&&tc.content.some(e=>"tool_result"===e.type&&"web_search"===e.name),[tc]),st=(0,R.useCallback)(()=>{tq()},[tq]),ss=(0,R.useCallback)(async e=>{await eY({prompt:e.prompt,attachments:[],files:e.files,syncSources:[]})},[eY]);return ew?(0,n.jsx)(e3.b,{autoscrollDisabled:eC||0===ex.length,autoscrollRef:eS,leftSidebarElement:void 0,mainElement:(0,n.jsxs)(e0._,{conversation:t8,projectUuid:ej,onSend:eY,onCreate:tX,onStopSampling:st,setPersonalizedStyleCallback:eb,customFileUploadHandler:eH||ev,children:[(0,n.jsx)(tC,{chatId:ed,chatName:eh,onSend:ss}),(0,n.jsxs)("div",{className:"relative mx-auto flex h-full w-full max-w-3xl flex-1 flex-col md:px-2",children:[(0,n.jsx)(tn,{conversationUuid:ed}),ef?(0,n.jsx)(tR,{className:"pt-2",children:(0,n.jsx)(W.d,{})}):0===ex.length?(0,n.jsx)(n.Fragment,{children:(null==t8||null==(N=t8.conversationSettings)?void 0:N.create_mode)?(0,n.jsx)(tR,{className:"pt-1",children:(0,n.jsx)(tx,{})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tp,{}),(0,n.jsx)(tR,{})]})}):(0,n.jsxs)(tR,{className:"pt-1",children:[(null==t8||null==(M=t8.conversationSettings)?void 0:M.create_mode)&&(0,n.jsx)(tx,{selectedLabel:(null==ex||null==(V=ex[0])||null==(H=V.content)||null==(z=H[0])?void 0:z.type)==="text"?null==ex||null==(et=ex[0])||null==(K=et.content)||null==(Y=K[0])?void 0:Y.text:void 0,disabled:ex.length>0}),(0,n.jsx)(e5.$,{renderToolUseCell:t7,children:ex.map((e,t)=>(0,n.jsx)(W.c,{lastHumanMessageRef:eB.lastHumanMessage,lastAssistantMessageRef:eB.lastAssistantMessage,previousMessage:t>0?ex[t-1]:void 0,message:e,conversationUUID:ed,conversationSettings:eN,isStreaming:eu,isLastMessage:t===ex.length-1,isLastHumanMessage:t===ex.length-2,isFirstAssistantMessage:1===t&&"assistant"===e.sender,messageWarningProps:t===ex.length-1&&eR||void 0,onOpenArtifact:to?td:void 0,selectAttachment:tr,changeDisplayedConversationPath:tZ,editable:!0,publishedArtifacts:null==tY?void 0:tY[e.uuid],onResize:t9,actionEmitter:eQ,onSendContinue:eK,isResearchPending:tD,isTemporary:em},t))}),(0,n.jsx)("div",{ref:eB.extras,children:(0,n.jsxs)("div",{className:(0,k.A)("ml-1 mt-0.5 flex items-center transition-transform duration-300 ease-out",eu&&"-translate-y-2.5"),children:[(0,n.jsx)("div",{className:"p-1 -translate-x-px",children:(0,n.jsx)(v.a,{state:tW,className:(0,k.A)(em&&"!text-text-100")})}),2===ex.length&&eu&&(null==(es=ex[1])?void 0:es.content)&&0===ex[1].content.length?(0,n.jsx)(tE,{}):null,(0,n.jsx)("div",{className:(0,k.A)("text-text-400 pt-5 flex-1 text-right text-[0.65rem] leading-[0.85rem] tracking-tighter sm:text-[0.75rem]",eu&&"pointer-events-none"),children:em?(0,n.jsxs)("div",{className:(0,k.A)("inline-block select-none transition-opacity",!eu&&"opacity-100 duration-700",eu&&"opacity-0 duration-0"),children:[(0,n.jsx)(p.YX,{id:"heroic_sandwich_butterfly"}),(0,n.jsx)(U.A,{defaultMessage:" <a>Learn more</a> about how your data is used.",id:"YLXLse2hpe",values:{a:e=>(0,n.jsx)("a",{href:"https://support.anthropic.com/en/articles/11817273-how-does-claude-s-memory-work",target:"_blank",className:"underline",children:e})}})]}):tD&&tB?(0,n.jsx)("div",{className:"inline-block select-none",children:"default"===tO?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:(0,n.jsx)(U.A,{defaultMessage:"Research takes time. Claude can let you know when it’s done.",id:"sPgKzf0LZ9"})}),(0,n.jsx)("button",{onClick:tP,className:"text-text-300 hover:text-text-200 underline",children:(0,n.jsx)(U.A,{defaultMessage:"Enable notifications",id:"AIUVfaT9og"})})]}):(0,n.jsx)(U.A,{defaultMessage:"Claude is off doing its research. Check back in later or start a new chat while you wait.",id:"Q/VRaHS8PD"})}):(0,n.jsx)(j.m,{tooltipContent:t5,side:"bottom",disableHoverableContent:!0,className:"max-w-96",children:(0,n.jsx)(E(),{href:"https://support.anthropic.com/en/articles/8525154-claude-is-providing-incorrect-or-misleading-responses-what-s-going-on",target:"_blank",className:(0,k.A)("inline-block underline-offset-2 transition-opacity hover:underline select-none",!eu&&"opacity-100 duration-700",eu&&"opacity-0 duration-0"),children:se?(0,n.jsx)(U.A,{defaultMessage:"Claude can make mistakes. {lineBreak}Please double-check cited sources.",id:"Al7GtlU74g",values:{lineBreak:(0,n.jsx)("br",{className:"block sm:hidden"})}}):(0,n.jsx)(U.A,{defaultMessage:"Claude can make mistakes. {lineBreak}Please double-check responses.",id:"EY1nHGV6e9",values:{lineBreak:(0,n.jsx)("br",{className:"block sm:hidden"})}})})})})]})}),eC&&(0,n.jsx)(tg,{newMessageSent:eF,setNewMessageSent:eD,scrollRefs:eB,scrollContainerRef:eS,invalidator:eO})]}),(null==t8||null==(el=t8.conversationSettings)?void 0:el.create_mode)&&0===ex.length?null:t$?(0,n.jsx)("div",{ref:eB.chatInput,className:"sticky bottom-0 mx-auto w-full pt-6 z-[5]",children:(0,n.jsx)(e$,{conversationUuid:ed,message:tc})}):(0,n.jsx)("div",{ref:eB.chatInput,className:"sticky bottom-0 mx-auto w-full pt-6 z-[5]",children:(0,n.jsx)(B.V,{ref:eV,placement:"bottom",disabled:ef})})]})]}),drawerElement:(0,n.jsx)(eX,{conversationUUID:ed,isOpen:tt,onClose:ti,isStreaming:eu,projectUuid:ej,sendMessage:eY,messages:ex,isTemporary:em}),isDrawerOpen:tt,headerProps:{conversationUUID:ed,name:eh,project:tH?tJ:void 0,controlsSidebarIsOpen:tt,closeControlsSidebar:ti,openControlsSidebar:ta,isStreaming:eu,wiggleFilesCount:0}}):null}let tR=g.J.div(tz())},24934:(e,t,s)=>{s.d(t,{g:()=>u});var a=s(42977),n=s(54568),i=s(90510),l=s(43195),r=s(32987),o=s(26631);function d(){let e=(0,a._)(["\n  z-dropdown\n  bg-bg-100\n  border-0.5\n  border-border-300\n  backdrop-blur-xl\n  rounded-lg\n  min-w-[8rem]\n  overflow-hidden\n  p-1\n  text-text-200\n  shadow-element\n"]);return d=function(){return e},e}function c(e,t){if(!t)return e;if("string"==typeof t)return t;let{add:s="",remove:a=""}=t,n=a.split(" ").filter(Boolean),i=e.split(" ").filter(Boolean).filter(e=>!n.includes(e));return(0,r.A)(i,s)}function u(e){var t;let{children:s,open:a,defaultButtonLabel:i,onClickDefaultButton:d,onOpenChange:u,buttonClassName:f,triggerButtonClassName:x,wrapperClassName:h,...g}=e,p=(0,r.A)("py-1 px-2 border-r border-border-300 hover:bg-bg-200",a&&"bg-bg-200");return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(o.bL,{open:a,onOpenChange:u,children:[(0,n.jsxs)("div",{className:c("flex font-medium rounded-lg overflow-hidden border border-border-300 h-8 rounded-md whitespace-nowrap",h),children:[(0,n.jsx)("button",{className:c(p,f),onClick:d,children:i}),(0,n.jsx)(o.l9,{asChild:!0,children:(0,n.jsx)("button",{className:c("py-1 px-1 hover:bg-bg-200",x),children:(0,n.jsx)(l.biH,{size:16})})})]}),(0,n.jsx)(o.ZL,{children:(0,n.jsx)(m,{sideOffset:null!=(t=g.sideOffset)?t:4,...g,children:s})})]})})}s(7620);let m=(0,i.J)(o.UC)(d())},25243:(e,t,s)=>{s.d(t,{W:()=>n});var a=s(7620);function n(e,t,s){let n=(0,a.useRef)(void 0),i=(0,a.useCallback)(e,t),l=(0,a.useCallback)(()=>{n.current&&window.clearTimeout(n.current),n.current=window.setTimeout(i,s)},[i,s]);return(0,a.useEffect)(()=>{l()},[...t,i,s]),l}},28871:(e,t,s)=>{s.d(t,{p:()=>a});function a(e){let t;try{t=JSON.parse(e)}catch(e){}return t}},30453:(e,t,s)=>{s.d(t,{f:()=>c});var a=s(54568),n=s(36906),i=s(34098),l=s(41417),r=s(43989),o=s(76761),d=s(7620);let c=e=>{let{attachment:t,goBack:s,onClose:c}=e,u=(0,d.useMemo)(()=>(0,i.E)(t),[t]);return(0,a.jsxs)("div",{className:"flex h-full flex-col pb-1 pl-5 pt-3",children:[(0,a.jsxs)("div",{className:"sticky flex items-center gap-1 pr-5",children:[s&&(0,a.jsx)(l.$,{onClick:s,variant:"ghost",size:"icon",className:"-ml-2 shrink-0",children:(0,a.jsx)(r.n,{size:20})}),(0,a.jsx)("h2",{className:"font-ui tracking-tight flex-1 truncate text-lg font-medium",children:u.title}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",className:"-mr-2",onClick:c,"data-testid":"close-file-preview",children:(0,a.jsx)(o.X,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-1 flex flex-col pb-3 pr-5 min-h-0 flex-1",children:[(0,a.jsx)(n.G,{metaData:u.metaData}),(0,a.jsx)("div",{className:"-m-1 mt-0 min-h-0 flex-1 whitespace-pre-wrap break-all text-xs p-4 bg-bg-000 rounded-lg border-0.5 border-border-300  overflow-y-auto font-mono shadow-sm",children:t.extracted_content})]})]})}},31417:(e,t,s)=>{s.d(t,{w:()=>o,y:()=>d});var a=s(77186),n=s(23661),i=s(7620);function l(e,t){let s=new Map;return t.forEach(e=>{var t;let a=null!=(t=s.get(e.file_name))?t:[];a.push(e),s.set(e.file_name,a)}),s.get(e)}function r(e,t){let s=l(e,t);if(!s||0===s.length)return null;let a=s.filter(e=>e.file_kind===n.M.Blob);return 0===a.length?null:a[a.length-1]}function o(){let e=function(){let e=(0,a.mn)();return(0,i.useCallback)(async(t,s,a,n,i)=>{let l=r(t,s);if(!l&&n){let s=await e("/api/organizations/".concat(a,"/projects/").concat(n,"/docs")),i=(await s.json()).find(e=>e.file_name===t);if(i)return new TextEncoder().encode(i.content);let o=await e("/api/organizations/".concat(a,"/projects/").concat(n,"/files"));l=r(t,await o.json())}if(!l)return null;try{let e=i?"/api/organizations/".concat(a,"/shared_artifact/").concat(i,"/files/").concat(l.file_uuid,"/contents"):"/api/organizations/".concat(a,"/files/").concat(l.file_uuid,"/contents"),t=await fetch(e);if(!t.ok)return null;let s=await t.arrayBuffer();if(s.byteLength>0x80000000-1)return null;return new Uint8Array(s)}catch(e){return null}},[e])}();return(0,i.useCallback)(async(t,s,a,n,i,r)=>{if(!n)return null;let o=function(e,t){let s=l(e,t);if(!s||0===s.length)return null;let a=s[s.length-1];if(a){let e=a.extracted_content;return new TextEncoder().encode(e)}return null}(t,s);return o||await e(t,a,n,i,r)},[e])}function d(e,t,s,a,n){let l=o();return(0,i.useCallback)(async i=>l(i,e,t,s,a,n),[e,t,s,a,l,n])}},33792:(e,t,s)=>{s.d(t,{l:()=>a});var a=function(e){return e.Standard="Standard",e.TimelineGroup="TimelineGroup",e}({})},35106:(e,t,s)=>{s.d(t,{c:()=>tc,d:()=>tu});var a=s(42977),n=s(54568),i=s(7620),l=s(50787),r=s(57322);r.A.blockRegex;let o=r.A.defaultRules,d=r.A.parserFor;r.A.defaultBlockParse;let c=r.A.outputFor,u=e=>{if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(u);if(i.isValidElement(e)){if(e.props&&"object"==typeof e.props&&"children"in e.props){let t=e.props.children,s=u(t);if(s!==t)return i.cloneElement(e,void 0,s)}return e}if((e=>"object"==typeof e&&null!==e&&"$$typeof"in e&&"type"in e&&"props"in e)(e)){let{type:t,props:s,key:a}=e,n={};return s&&"object"==typeof s&&(Object.assign(n,s),"children"in s&&(n.children=u(s.children))),null!=a&&(n.key=a),i.createElement(t,n)}return e};var m=s(56340);let f={...{fence:{...o.fence,parse:(e,t,s)=>({lang:e[2]||void 0,content:e[3]}),react:e=>(0,n.jsx)(m.I.pre,{flagShowCodeHeader:!1,children:e.content})},blockQuote:{...o.blockQuote,react:(e,t,s)=>(0,n.jsx)(m.I.blockQuote,{children:t(e.content,s)})},list:{...o.list,react:(e,t,s)=>{let a=e.ordered?m.I.ol:m.I.ul;return(0,n.jsx)(a,{children:e.items.map((e,a)=>(0,n.jsx)(m.I.li,{children:t(e,s)},a))},s.key)}},newline:o.newline,paragraph:{...o.paragraph,react:(e,t,s)=>(0,n.jsx)(m.I.p,{children:t(e.content,s)},s.key)},u:o.u,del:o.del,inlineCode:{...o.inlineCode,react:e=>{let t=e.content;if(t&&l.yT.test(t)){var s;if((null==(s=t.match(l.yT))?void 0:s[0])===t)return(0,n.jsxs)(m.I.code,{children:[(0,n.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",position:"relative",top:"-0.15em"},children:(0,n.jsx)(l.qU,{color:t})}),t]})}return(0,n.jsx)(m.I.code,{children:t})}},text:{...o.text,react:e=>(0,l.fz)(e.content)}},url:o.url,link:{...o.link,match:(e,t)=>null,react:e=>{let t=e.target;return(0,n.jsx)("a",{href:t,target:"_blank",className:"underline",children:t})}},em:o.em,strong:o.strong},x=(0,i.memo)(e=>{let{text:t}=e,s=d(f)(t,{inline:!1});return((e,t,s)=>{let a=c(e,t,s),n=(e,t)=>u(a(e,t));return n.displayName="OutputFor_".concat(String(t)),n})(f,"react")(s)});x.displayName="AnthropicMarkDown";var h=s(7409),g=s(33200),p=s(90510),v=s(41417),j=s(27062),b=s(4705),y=s(82015),w=s(38583),_=s(46760),k=s(62971),N=s(70497);function M(){let e=(0,a._)(["\n  flex flex-row gap-1 rounded-md p-2 text-xs select-none -mx-1 mb-1 mt-4 outline outline-1 text-text-100\n"]);return M=function(){return e},e}function C(){let e=(0,a._)(["\n  bg-bg-300/80 text-text-300 outline-bg-400/80\n"]);return C=function(){return e},e}function A(){let e=(0,a._)(["\n  bg-accent-secondary-200/20 outline-accent-secondary-200/30\n"]);return A=function(){return e},e}function S(){let e=(0,a._)(["\n  cursor-pointer items-center bg-danger-900/50 hover:bg-danger-900/75 transition group/banner outline-danger-000/25 hover:outline-danger-000/50\n"]);return S=function(){return e},e}let z=p.J.div(M()),E=(0,p.J)(z)(C()),I=(0,p.J)(z)(A()),R=(0,p.J)(z)(S()),T=(0,i.memo)(function(e){let{message:t,messageWarningPropsFromParent:s,hasLink:a,hasCode:l,hasDriveDocWithImages:r,onRetry:o,onSendContinue:d,conversationSettings:c,isLastMessage:u}=e,m=(0,_.A)(),{value:f}=(0,g.N)(null!=c?c:{}),x=null==c?void 0:c.enabled_web_search,{value:h}=(0,j.fS)("claudeai_web_search"),p=(0,i.useMemo)(()=>({a:e=>{let{node:t,...s}=e;return(0,n.jsx)("a",{...s,className:"underline"})}}),[]);if((null==s?void 0:s.style)==="prominent")return(0,n.jsxs)(I,{"data-testid":"message-warning",children:[(0,n.jsx)(b.N,{className:"shrink-0",size:16}),(0,n.jsx)(N.o,{components:p,children:s.contentMarkdown})]});let M="human"===t.sender;if(!M&&"error"===t.stop_reason&&o)return(0,n.jsxs)(R,{"data-testid":"message-warning",onClick:()=>o(t.parent_message_uuid),children:[(0,n.jsxs)("div",{className:"relative h-4 w-4 shrink-0 text-danger-000",children:[(0,n.jsx)(b.N,{className:"absolute inset-0 group-hover/banner:opacity-0 group-hover/banner:scale-75  opacity-50 transition",size:16}),(0,n.jsx)(y.o,{className:"absolute inset-0 group-hover/banner:opacity-75 group-hover/banner:rotate-0 rotate-[20deg] opacity-0 transition",size:16})]}),(0,n.jsx)("div",{className:"flex flex-grow text-danger-000",children:(0,n.jsx)(k.A,{defaultMessage:"This response didn’t load. Try again by chatting to Claude.",id:"g0FIIo0clM"})})]});if(!M&&u&&"max_tokens"===t.stop_reason&&d)return(0,n.jsx)(E,{"data-testid":"message-warning",children:(0,n.jsxs)("div",{className:"flex max-sm:flex-col gap-2 w-full",children:[(0,n.jsxs)("div",{className:"flex items-start gap-2",children:[(0,n.jsx)(w.R,{className:"shrink-0",size:16}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(k.A,{defaultMessage:"This response paused because Claude reached its max length for a message. Hit continue to nudge Claude along.",id:"oje9UAHUmL"})})]}),(0,n.jsx)("div",{className:"ml-6",children:(0,n.jsx)(v.$,{variant:"secondary",size:"sm",className:"block flex-shrink-0",onClick:()=>null==d?void 0:d(),"aria-label":m.formatMessage({defaultMessage:"Continue",id:"acrOozm08x"}),children:(0,n.jsx)(k.A,{defaultMessage:"Continue",id:"acrOozm08x"})})})]})});let C=[];return(M?(a&&!x&&(h?C.push(m.formatMessage({defaultMessage:"Claude does not have internet access enabled. Enable web search to get up to date info from web links.",id:"fPI2JySdII"})):C.push(m.formatMessage({defaultMessage:"Claude does not have internet access and cannot get up to date info from web links.",id:"SXpasVsDUZ"}))),r&&C.push(m.formatMessage({defaultMessage:"Claude cannot yet access images from Google Docs.",id:"8Wb1yCJBBv"}))):(a&&!x&&(h?C.push(m.formatMessage({defaultMessage:"Claude does not have internet access enabled. Enable web search for up to date and accurate links.",id:"sN35Yf2Rzl"})):C.push(m.formatMessage({defaultMessage:"Claude does not have internet access. Links provided may not be accurate or up to date.",id:"c8NyKXBwfo"}))),l&&!f&&C.push(m.formatMessage({defaultMessage:"Claude does not have the ability to run the code it generates yet.",id:"dSVZQBKb/U"})),t.stop_reason,"conversation_length_limit"===t.stop_reason&&C.push(m.formatMessage({defaultMessage:"Claude hit the maximum length for this conversation. Please start a new conversation to continue chatting with Claude.",id:"jujWu4WTLz"})),s&&C.push(s.contentMarkdown)),0===C.length)?null:(0,n.jsxs)(E,{"data-testid":"message-warning",children:[(0,n.jsx)(w.R,{className:"shrink-0",size:16}),(0,n.jsx)(N.o,{components:p,children:C.reverse().join(" ")})]})});var U=s(32987),L=s(9946);class F{isInsideStructure(){return this.inCodeBlock||this.inList||this.inTable||this.inBlockquote}processLine(e){let t=e.trim(),s=this.isInsideStructure();(t.startsWith("```")||t.startsWith("~~~"))&&(this.inCodeBlock?t.startsWith(this.codeBlockDelimiter)&&(this.inCodeBlock=!1,this.codeBlockDelimiter=""):(this.inCodeBlock=!0,this.codeBlockDelimiter=t.substring(0,3))),/^[-*+]|\d+\./.test(t)&&!this.inCodeBlock?this.inList=!0:this.inList&&""===t&&(this.inList=!1),t.includes("|")&&!this.inCodeBlock?this.inTable=!0:this.inTable&&""===t&&(this.inTable=!1);let a=t.startsWith(">");a&&!this.inCodeBlock?this.inBlockquote=!0:this.inBlockquote&&""===t&&!a&&(this.inBlockquote=!1);let n=this.lastLineWasEmpty;this.lastLineWasEmpty=""===t;let i=s&&!this.isInsideStructure();return{insideStructure:this.isInsideStructure(),structureJustClosed:i,previousLineWasEmpty:n}}reset(){this.inCodeBlock=!1,this.codeBlockDelimiter="",this.inList=!1,this.inTable=!1,this.inBlockquote=!1,this.lastLineWasEmpty=!0}constructor(){this.inCodeBlock=!1,this.codeBlockDelimiter="",this.inList=!1,this.inTable=!1,this.inBlockquote=!1,this.lastLineWasEmpty=!0}}let D=(0,i.memo)(e=>{let{text:t,blockCitations:s=[],hasLinkRef:a,hasCodeRef:i,className:l,linkTarget:r="_blank",flagShowCodeHeader:o,unsafeAllowNavigationWithoutConfirmation:d,onOpenArtifact:c,isLastMessage:u,publishedArtifacts:m,useInHouseLatexPlugin:f,messageUuid:x,onLinkClick:h}=e;return(0,n.jsx)(L.fP,{text:t,blockCitations:s,hasLinkRef:a,hasCodeRef:i,className:l,linkTarget:r,isStreaming:!1,flagShowCodeHeader:o,unsafeAllowNavigationWithoutConfirmation:d,onOpenArtifact:c,isLastMessage:u,publishedArtifacts:m,useInHouseLatexPlugin:f,messageUuid:x,onLinkClick:h})},(e,t)=>e.text===t.text);D.displayName="MemoizedMarkdownChunk",(0,i.memo)(e=>{let{text:t,blockCitations:s=[],hasLinkRef:a,hasCodeRef:l,className:r,linkTarget:o="_blank",isStreaming:d=!1,flagShowCodeHeader:c,unsafeAllowNavigationWithoutConfirmation:u,onOpenArtifact:m,isLastMessage:f,publishedArtifacts:x,useInHouseLatexPlugin:h,messageUuid:g,onLinkClick:p}=e,{completedChunks:v,streamingChunk:j}=((e,t)=>{let[s,a]=(0,i.useState)([]),[n,l]=(0,i.useState)(""),r=(0,i.useRef)(new F);return(0,i.useEffect)(()=>{if(!e){a([]),l("");return}if(!t){a([e]),l(""),r.current.reset();return}let s=e.split("\n"),n=[],i=[],o=-1;r.current.reset();for(let e=0;e<s.length;e++){let t=s[e],{insideStructure:a,structureJustClosed:l,previousLineWasEmpty:d}=r.current.processLine(t);if(i.push(t),l||!a&&""===t.trim()&&i.length>1&&!d){for(;i.length>0&&""===i[i.length-1].trim();)i.pop();i.length>0&&(n.push(i.join("\n")),o=e,i=[])}}let d=s.slice(o+1).join("\n");a(n),l(d)},[e,t]),{completedChunks:s,streamingChunk:n}})(t,d);return(0,n.jsxs)("div",{className:(0,U.A)("grid-cols-1 grid gap-2.5 [&_>_*]:min-w-0",r),children:[v.map((e,t)=>(0,n.jsx)(D,{text:t>0?"\n\n"+e:e,blockCitations:s,hasLinkRef:a,hasCodeRef:l,className:"",linkTarget:o,flagShowCodeHeader:c,unsafeAllowNavigationWithoutConfirmation:u,onOpenArtifact:m,isLastMessage:f,publishedArtifacts:x,useInHouseLatexPlugin:h,messageUuid:g,onLinkClick:p},t)),j&&(0,n.jsx)(L.fP,{text:v.length>0?"\n\n"+j:j,blockCitations:s,hasLinkRef:a,hasCodeRef:l,className:"",linkTarget:o,isStreaming:!0,flagShowCodeHeader:c,unsafeAllowNavigationWithoutConfirmation:u,onOpenArtifact:m,isLastMessage:f,publishedArtifacts:x,useInHouseLatexPlugin:h,messageUuid:g,onLinkClick:p})]})}).displayName="ProgressiveStandardMarkDown";var O=s(74610),P=s(1761),B=s(93877),W=s(9537),G=s(54890),J=s(92007),H=s(77101),V=s(12655),Y=s(21036),q=s(37463),K=s(85717),X=s(47546),Z=s(85644),Q=s(2341),$=s(43195),ee=s(9786),et=s(53248),es=s(49645),ea=s(75006),en=s(92075),ei=s(45078),el=s(57383),er=s(77186),eo=s(89697),ed=s(70011),ec=s(56370),eu=s(18179),em=s(37076),ef=s(29638),ex=s(92479),eh=s(20298);function eg(e){let{isOpen:t,onClose:s,conversationUUID:a,messageUUID:i,text:l}=e;return(0,n.jsx)(em.aF,{isOpen:t,onClose:s,modalSize:"xl",hasCloseButton:!0,children:(0,n.jsx)(ep,{conversationUUID:a,messageUUID:i,text:l})})}function ep(e){let{conversationUUID:t,messageUUID:s,text:a}=e,{data:l,isPending:r,mutateAsync:o}=((e,t)=>{let{activeOrganization:s}=(0,P.YL)(),a=null==s?void 0:s.uuid;return(0,er.L2)("/api/organizations/".concat(a,"/chat_conversations/").concat(e,"/chat_messages/").concat(t,"/debug"),"POST")})(t,s),{model:d}=(0,el.o)(),c=(0,ei.vP)("paprika_mode"),u=(0,Q.B)(),m=(0,eh.n)(u||{}),{codeStyle:f}=(0,eo.V)(),x=l?JSON.stringify(function(e){for(let[t,s]of Object.entries(e.logs.api_usage))if("string"==typeof s)try{let a=JSON.parse(s);e.logs.api_usage[t]=a}catch(e){}return e}(l),null,2):"",h=(0,ed.Z3)(t);(0,i.useEffect)(()=>{(async()=>{await o({prompt:"",model:d||h,tools:m(),personalized_styles:[],paprika_mode:c})})()},[o,d,m,c,h]);let{didCopy:g,copyToClipboard:p}=(0,ee.C)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(em.vW,{layout:"left",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsxs)("h2",{className:"font-ui tracking-tight text-accent-pro-000 text-xl font-medium",children:[(0,n.jsx)(k.A,{defaultMessage:"Debug information",id:"NqgO+Si31g"}),"\xa0",(0,n.jsx)("span",{className:"ml-1 text-sm font-medium text-danger-000",children:(0,n.jsx)(k.A,{defaultMessage:"FOR INTERNAL USE ONLY",id:"ISVSjyq5f9"})})]})}),(0,n.jsxs)(v.$,{variant:"ghost",onClick:()=>{p(x)},disabled:r,children:[(0,n.jsx)(ee.u,{didCopy:g,size:16,className:"mr-2"}),(0,n.jsx)(k.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})]}),(0,n.jsx)(ev,{text:a})]}),r?(0,n.jsx)("div",{className:"my-2 flex h-full w-full items-center justify-center",children:(0,n.jsx)(eu.Loading,{})}):(0,n.jsx)(ex.A,{customStyle:{maxHeight:"32rem",fontSize:".875rem"},language:"json",PreTag:"div",style:f,children:x})]})}let ev=e=>{let{text:t}=e,{copyToClipboard:s}=(0,ee.C)(),a=(0,_.A)();return(0,n.jsx)(ec.ms,{onCloseAutoFocus:e=>{e.preventDefault()},trigger:(0,n.jsx)(v.$,{variant:"ghost",size:"icon","aria-label":a.formatMessage({defaultMessage:"More options",id:"IzCVhGdYVc"}),children:(0,n.jsx)(ef.H,{size:20})}),children:(0,n.jsx)(ec.tJ,{className:"text-md",onSelect:()=>{s(t)},children:(0,n.jsx)("div",{className:"flex items-center justify-between gap-1",children:(0,n.jsx)("div",{className:"flex grow items-center",children:(0,n.jsx)(k.A,{defaultMessage:"Copy unmodified message",id:"+yNntDpG9W"})})})})})};var ej=s(18395);function eb(e){var t,s;let{conversationUuid:a,message:l}=e,[r,o]=(0,i.useState)(void 0),[d,c]=(0,i.useState)(!1),u=e=>{"flag"===e?(null==r?void 0:r.startsWith("flag"))||o("flag"):"upvote"!==r&&o("upvote"),c(!0)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(X.k,{className:(0,U.A)((null==(t=l.chat_feedback)?void 0:t.type.includes("upvote"))&&"bg-bg-200 !text-accent-secondary-100"),Icon:(0,n.jsx)($.twC,{size:16}),tooltipContent:(0,n.jsx)(k.A,{defaultMessage:"Give positive feedback",id:"FGCv00cdfW"}),onClick:()=>u("upvote")}),(0,n.jsx)(X.k,{className:(0,U.A)((null==(s=l.chat_feedback)?void 0:s.type.includes("flag"))&&"bg-bg-200 !text-danger-100"),Icon:(0,n.jsx)($.SuN,{size:16}),tooltipContent:(0,n.jsx)(k.A,{defaultMessage:"Give negative feedback",id:"ngzzQUJCXB"}),onClick:()=>u("flag")}),(0,n.jsx)(ej.B,{conversationUuid:a,message:l,requestedFeedbackType:r,setRequestedFeedbackType:o,isOpen:d,onClose:()=>c(!1)})]})}var ey=s(22529),ew=s(35368),e_=s(99272);function ek(e){let{paprikaMode:t,supportedPaprikaModes:s,onRetry:a,parentMessageUUID:l,setPaprikaModeState:r}=e,[o,d]=(0,i.useState)(!1),c=(0,ew.Wi)().filter(e=>e.paprika_mode_value&&e.paprika_mode_value!==t&&s.includes(e.paprika_mode_value)),u=(0,i.useCallback)((e,t)=>{a(e,t),r(t)},[a,r]);return(0,n.jsxs)(ec.ms,{align:"start",unstyledTrigger:!0,onCloseAutoFocus:e=>e.preventDefault(),open:o,onOpenChange:d,trigger:(0,n.jsxs)(v.$,{variant:"unstyled",size:"unset",className:"flex flex-row items-center gap-1 rounded-md p-2 py-1.5 text-sm transition-opacity delay-100 hover:bg-bg-300 select-none",children:[(0,n.jsx)(k.A,{defaultMessage:"Retry",id:"62nsdyMyIO"}),(0,n.jsx)(e_.a,{size:12,className:"text-text-500 shrink-0"})]}),children:[(0,n.jsx)(ec.tJ,{className:"text-sm",onClick:()=>a(l),children:(0,n.jsx)(k.A,{defaultMessage:"With no changes",id:"h3WdKJh51e"})}),c.map(e=>(0,n.jsx)(ec.tJ,{className:"text-sm",onClick:()=>u(l,e.paprika_mode_value),children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"flex flex-col",children:"extended"===e.id?(0,n.jsx)(k.A,{defaultMessage:"With extended thinking",id:"/zFAxhC9JS",description:"Lets the user try again using a different thinking mode"}):"With ".concat(e.title.toLowerCase()," thinking")}),(0,n.jsx)("div",{className:"text-text-500 text-xs",children:e.description_key?(0,n.jsx)(ey.X5,{id:e.description_key}):e.description})]})},e.id))]})}var eN=s(65755);let eM={default:{allowed:"never"}},eC=ea.z.record(ea.z.object({allowed:ea.z.enum(["never","first_turn","always"])}));function eA(e){var t,s,a,l,r,o,d,c;let{message:u,conversationUUID:m,isStreaming:f,isTemporary:x=!1,onRetry:h,isLastMessage:g,isLastHumanMessage:p=!1,isInteractive:v=!0,changeDisplayedConversationPath:b,editMessage:y,isFirstAssistantMessage:w,isResearchPending:_}=e,[N,M]=(0,i.useState)(!1),C=null!=(r=null==(t=(0,Q.B)())?void 0:t.preview_feature_uses_artifacts)&&r,A="human"===u.sender,S="assistant"===u.sender,z=f&&g,{value:E}=(0,j.fS)("anthropic_internal_only_expose_chat_debug"),I=!f&&(null!=(o=u.nOptions)?o:0)>1&&b,R=!f&&!_&&y&&u.parent_message_uuid&&v,T=null==u||null==(s=u.content)?void 0:s.some(e=>"tool_use"===e.type&&"end_conversation"===e.name),U=!f&&!_&&v&&!T,L=(0,et.C)(u),{didCopy:F,copyToClipboard:D}=(0,ee.C)(),O=async()=>{let e=(C?(0,G.it)(L):L).trim();try{let t=(0,eN.u)(e);await D({text:e,html:t})}catch(t){await D(e)}},P=(0,en.QY)(),{toggleConversationSetting:B}=(0,ei.rX)(),W=(0,ei.vP)("paprika_mode"),{model:J}=(0,el.o)(),{allModelOptions:H}=(0,Z.A9)(),V=(0,j.iW)("claude_ai_paprika_retry",eM,eC),Y=null!=(c=null!=(d=J&&(null==(a=V[J])?void 0:a.allowed))?d:null==(l=V.default)?void 0:l.allowed)?c:"never";if(A&&!R&&!I)return null;let q=H.find(e=>e.model===J),K=null==q?void 0:q.paprika_modes,es=K&&K.length>0&&!W&&("always"===Y||"first_turn"===Y&&w);return(0,n.jsx)(eS,{isStreaming:z,isLastMessage:g||p,isInteractive:v,isAssistant:S,children:(0,n.jsxs)("div",{className:"text-text-300 flex items-stretch justify-between",children:[S&&E&&(0,n.jsx)(X.k,{Icon:(0,n.jsx)($.IFY,{size:16}),tooltipContent:(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsx)(k.A,{defaultMessage:"Debug",id:"z3UjXRZwzQ"}),(0,n.jsx)("div",{className:"px-1 py-px -mr-0.5 text-xs bg-always-white/20 rounded",children:(0,n.jsx)(k.A,{defaultMessage:"Internal",id:"2KtWqT5Nl+"})})]}),onClick:()=>M(!0),isAssistant:S}),S&&E&&(0,n.jsx)(eg,{isOpen:N,onClose:()=>M(!1),messageUUID:u.uuid,text:L,conversationUUID:m}),A&&R&&(0,n.jsx)(X.k,{onClick:()=>y(u,"test edit message"),isAssistant:S,children:(0,n.jsx)(k.A,{defaultMessage:"Edit",id:"wEQDC6Wv3/"})}),S&&(0,n.jsx)(X.k,{tooltipContent:(0,n.jsx)(k.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"}),onClick:O,isAssistant:S,"data-testid":"action-bar-copy",children:(0,n.jsx)("div",{children:(0,n.jsx)(ee.u,{size:16,didCopy:F})})}),S&&!z&&!_&&v&&"error"!==u.stop_reason&&P&&!x&&(0,n.jsx)(eb,{conversationUuid:m,message:u}),(0,n.jsxs)("div",{className:"flex items-center gap-0.5",children:[I&&(0,n.jsx)(ez,{message:u,changeDisplayedConversationPath:b,isAssistant:S}),S&&U&&(es?(0,n.jsx)(ek,{paprikaMode:W,supportedPaprikaModes:K,onRetry:h,parentMessageUUID:u.parent_message_uuid,setPaprikaModeState:e=>{B("paprika_mode",null!=e?e:null)}}):(0,n.jsx)(X.k,{onClick:()=>h(u.parent_message_uuid),isAssistant:S,children:(0,n.jsx)(k.A,{defaultMessage:"Retry",id:"62nsdyMyIO"})}))]})]})})}let eS=e=>{let{isStreaming:t,isLastMessage:s,isInteractive:a,isAssistant:i,children:l}=e;return(0,n.jsx)(es.N,{children:!t&&(0,n.jsx)(q.P.div,{className:"absolute bottom-0 right-2 pointer-events-none",initial:{scale:.95},animate:{scale:1},transition:{type:"spring",damping:30,stiffness:400},children:(0,n.jsx)("div",{className:(0,U.A)("rounded-lg transition min-w-max pointer-events-auto",!i&&"translate-y-4 bg-bg-300/90 backdrop-blur-sm translate-x-1 group-hover:translate-x-0.5 border-0.5 border-border-300 p-0.5 shadow-sm",i&&"translate-x-2",s?"translate-y-full pt-2":"opacity-0 group-hover:opacity-100"),children:l})})})};function ez(e){var t;let{message:s,changeDisplayedConversationPath:a,isAssistant:i}=e,l=(null!=(t=s.selectedOption)?t:0)+1,r=l===s.nOptions;return(0,n.jsxs)("div",{className:"flex text-xs",children:[(0,n.jsx)(X.k,{className:(0,U.A)("px-0.5 mr-1",1===l&&"opacity-50 pointer-events-none"),onClick:()=>a(s,-1),isAssistant:i,children:(0,n.jsx)($.ZK0,{})}),(0,n.jsx)("span",{className:"self-center shrink-0 select-none",children:(0,n.jsx)(k.A,{defaultMessage:"{selectedOption} / {totalOptions}",id:"0zCqdBEnn7",values:{selectedOption:l,totalOptions:s.nOptions}})}),(0,n.jsx)(X.k,{className:(0,U.A)("px-0.5 ml-1",r&&"opacity-50 pointer-events-none"),onClick:()=>a(s,1),isAssistant:i,children:(0,n.jsx)($.K3R,{})})]})}var eE=s(98518),eI=s(34059),eR=s(83848);let eT=()=>{let e=(0,eE.st)(),{initDriveAuth:t}=(0,K.cI)({});return(0,i.useEffect)(()=>{e.track({event_key:"claudeai.in_chat_upsell.connect_gdrive.displayed"})},[e]),(0,n.jsx)(eU,{title:(0,n.jsx)(k.A,{defaultMessage:"Add context from all your docs more easily",id:"gHPka72Ai9"}),icon:(0,n.jsx)(eR.g,{size:18}),cta:(0,n.jsxs)(v.$,{className:"bg-bg-100 border-border-300",size:"sm",variant:"outline",onClick:()=>{e.track({event_key:"claudeai.in_chat_upsell.connect_gdrive.start"}),t()},children:[(0,n.jsx)(eI.ft,{size:16,className:"mr-1"}),(0,n.jsx)(k.A,{defaultMessage:"Connect Drive",id:"XzTB2bvNw1"})]})})},eU=e=>{let{title:t,icon:s,cta:a}=e;return(0,n.jsx)(q.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"mt-3",children:(0,n.jsx)("div",{className:"overflow-hidden rounded-lg border-0.5 border-border-300 bg-bg-100 shadow-sm",children:(0,n.jsx)("div",{className:"px-2.5 py-2.5",children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("div",{className:"rounded-lg bg-primary-100 p-1",children:s}),(0,n.jsx)("h3",{className:"text-sm text-text-100",children:t})]}),a]})})})})},eL=e=>{let{previousMessage:t}=e,s=(0,K.LP)(),{isDriveAuthenticated:a}=(0,K.cI)({}),l=(0,i.useMemo)(()=>!!t&&t.attachments.some(e=>"docx"===e.file_type),[t]),{value:r}=(0,j.fS)("pumpernickel_enabled"),o=(0,Y.useLayer)("trials_freemium").get("free_integrations",!1);return(r||o)&&s&&!a&&l?(0,n.jsx)(eT,{}):null},eF=e=>{let{title:t,text:s}=e,a=(0,_.A)();t=t||a.formatMessage({defaultMessage:"Untitled note",id:"fkEfiUjl/t"}),s=s||"";let{didCopy:i,copyToClipboard:l}=(0,ee.C)(),r=async()=>{let e=t+"\n"+s;try{let t=(0,eN.u)(e);await l({text:e,html:t})}catch(t){await l(e)}};return(0,n.jsxs)("div",{className:"group relative mt-4 mb-1 rounded-2xl border-border-300/25 border font-claude-message",children:[(0,n.jsxs)("div",{className:"pt-1 pb-1 px-3 border-b-0.5 border-border-300/25 font-semibold flex justify-between items-center",children:[(0,n.jsx)("span",{className:"flex-1",children:t}),(0,n.jsx)(v.$,{variant:"ghost",size:"icon_sm",onClick:r,children:(0,n.jsx)(ee.u,{didCopy:i,size:16})})]}),(0,n.jsx)(N.o,{className:"px-4 pt-2 pb-4",children:s})]})};var eD=s(38715),eO=s(57067),eP=s(25243),eB=s(60045);let eW=["year","month","day","hour","minute","second","millisecond"],eG=e=>{let{value:t,...s}=e;return function(e,t){let{listStyle:s,...a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=eB.dw.fromDurationLike(t);return e.formatList(eW.filter(e=>0!==n["".concat(e,"s")]).map(t=>e.formatNumber(n["".concat(t,"s")],{...a,style:"unit",unit:t})),{...a,style:s})}((0,_.A)(),t,s)};var eJ=s(68864),eH=s(27261),eV=s.n(eH),eY=s(33792),eq=s(94748),eK=s(67532);function eX(){let e=(0,a._)(["\nbg-bg-100 text-text-300 border-0.5 border-border-300 flex flex-row gap-1.5 rounded-md p-2 mx-4 mb-4 font-small"]);return eX=function(){return e},e}function eZ(e,t){if(!e)return;let s=(t?eJ.c9.fromISO(t):eJ.c9.now()).diff(eJ.c9.fromISO(e),["hours","minutes","seconds"]);return 0>s.toMillis()?eJ.dw.fromMillis(0):s}let eQ=p.J.div(eX()),e$=()=>(0,n.jsxs)(eQ,{"data-testid":"message-warning",children:[(0,n.jsx)($.R2D,{className:"shrink-0",size:16}),(0,n.jsx)(k.A,{defaultMessage:"The rest of the <link>thought process</link> is not available for this response.",id:"G/67Pe5XhQ",values:{link:e=>(0,n.jsx)(eV(),{href:"https://support.anthropic.com/en/articles/10574485-using-extended-thinking-on-claude-3-7-sonnet",className:"underline",target:"_blank",children:e})}})]}),e0=e=>{let{text:t,cutOff:s}=e,{value:a}=(0,j.fS)("use_in_house_latex_transformer");return(0,n.jsxs)("div",{className:"text-text-300 text-sm font-normal gap-0.5 relative font-claude-response",children:[(0,n.jsx)(L.fP,{className:"p-3 pt-0 pr-8",text:t,useInHouseLatexPlugin:a}),!0!==s?null:(0,n.jsx)(e$,{})]})},e1=e=>{let t,{index:s,text:a,cutOff:l=!1,startTimestamp:r,stopTimestamp:o,isStreaming:d,mostRecentSummary:c,onToggle:u,messageUuid:m,isFirstBlockOfMessage:f,isLastBlockOfMessage:x,renderMode:h=eY.l.Standard,isFirstItemInGroup:g,isLastItemInGroup:p}=e,v=(0,Y.useDynamicConfig)("claudeai_isp_thinking_ux"),j=v.get("enabled",!1),b=(0,_.A)(),y=b.formatMessage({defaultMessage:"Thinking",id:"AHQWDTo4+e"}),w=b.formatMessage({defaultMessage:"Thinking...",id:"QrZMdiKa7h"}),k=b.formatMessage({defaultMessage:"Thought process",id:"zl6fNbo7RW"}),{isExpanded:N,setIsExpanded:M,snappyTransition:C}=(0,eK.a)(!j&&d,String(s)),A=(0,eE.st)(),[S,z]=(0,i.useState)(()=>eZ(r,o)),E=(0,i.useRef)(void 0),I=(0,i.useRef)(!1),[R,T]=(0,i.useState)(null),L=(0,i.useRef)([]);(0,i.useEffect)(()=>{(0,eO.GN)(m)&&L.current.length>0&&(L.current.forEach(e=>{A.track({event_key:"claudeai.thinking_cell.clicked",is_opening:e.isOpening,is_streaming:e.wasStreamingWhenClicked,chat_message_uuid:m,timestamp:e.timestamp})}),L.current=[])},[m,A]),(0,i.useEffect)(()=>{d&&(I.current=!0)},[d]);let F=d||I.current?v.get("fallback_summary_debounce_ms",2e3):0;(0,eP.W)(()=>{!d&&a.length>0&&T(e2(a,v))},[a,d],F),(0,i.useEffect)(()=>{let e=()=>{let e=eZ(r,void 0);E.current=e,z(e)};if(d){e();let t=setInterval(e,1e3);return()=>clearInterval(t)}!E.current&&o&&z(eZ(r,o))},[r,o,d]);let D=null==c?void 0:c.summary;if(j)if(d)t=null!=D?D:w;else{var O;t=null!=(O=null!=D?D:R)?O:w}else t=null!=D?D:d?y:k;return(0,n.jsx)(eq.sH,{isStreaming:d,isExpanded:N,setIsExpanded:()=>{let e=new Date().toISOString();(0,eO.GN)(m)?A.track({event_key:"claudeai.thinking_cell.clicked",is_opening:!N,is_streaming:d,chat_message_uuid:m,timestamp:e}):L.current.push({isOpening:!N,wasStreamingWhenClicked:d,timestamp:e}),M(!N)},isFirstBlockOfMessage:f,isLastBlockOfMessage:x,text:N?k:d||E.current?(0,n.jsx)(es.N,{mode:"wait",children:(0,n.jsx)(q.P.span,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.3,ease:"easeIn"},className:j?"text-text-300":"text-left relative text-sm font-claude-response leading-6 whitespace-nowrap text-text-300 text-ellipsis overflow-hidden basis-0 grow min-w-0",children:t},t)}):(0,n.jsx)("span",{className:j?"text-text-300":"text-left relative text-sm font-claude-response leading-6 whitespace-nowrap text-text-300 text-ellipsis overflow-hidden basis-0 grow min-w-0",children:t}),secondaryText:S?(0,n.jsxs)("span",{className:"flex items-center gap-1 transition-opacity",children:[(0,n.jsx)($.Sw4,{className:(0,U.A)("text-text-300 transition-all duration-300 ease-in-out opacity-50",d?"!opacity-0 scale-50":"scale-100 opacity-100"),size:12}),(0,n.jsx)("span",{className:"tabular-nums",children:(0,n.jsx)(eG,{value:S,listStyle:"narrow",unitDisplay:"narrow",maximumFractionDigits:0})})]}):void 0,renderMode:h,isFirstItemInGroup:g,isLastItemInGroup:p,children:(0,n.jsx)(eq.NG,{isExpanded:N,snappyTransition:C,onTransitionEnd:u,isScrollable:!0,children:(0,n.jsx)(e0,{text:a,cutOff:l})})})},e2=(e,t)=>{let s=t.get("fallback_summary_min_len",50),a=t.get("fallback_summary_max_len",100),n=new RegExp(t.get("fallback_summary_regex",".*(\\n|\\.(\\s|$)|。)")),i=e.substring(0,a),l=n.exec(i);if(l)return l[0];for(let e=i.length-1;e>=s;e--)if(/\s/.test(i[e]))return i.substring(0,e+1);return i};var e3=s(56326),e5=s(95675),e6=s(56273),e4=s(11480),e7=s(99965),e9=s(92947),e8=s(28871);function te(){let e=(0,a._)(["\n  group\n  relative\n  inline-flex\n  gap-2\n  bg-bg-300\n  rounded-xl\n  pl-2.5\n  py-2.5\n  break-words\n  text-text-100\n  transition-all\n  max-w-[75ch]\n  flex-col\n"]);return te=function(){return e},e}function tt(){let e=(0,a._)(["\n  group\n  relative\n  -tracking-[0.015em]\n"]);return tt=function(){return e},e}function ts(){let e=(0,a._)(["\n  font-claude-message\n  relative\n  leading-[1.65rem]\n  [&_pre>div]:bg-bg-000/50\n  [&_pre>div]:border-0.5\n  [&_pre>div]:border-border-400\n  [&_.ignore-pre-bg>div]:bg-transparent\n  [&>div>div>:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2\n  [&>div>div>:is(p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8\n"]);return ts=function(){return e},e}let ta={initial:!1,animate:{y:0,opacity:1}},tn={initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",damping:10,stiffness:100}},ti={initial:{scale:1.02,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3,ease:"easeOut"}},tl={initial:{height:"0px",opacity:0},animate:{height:"auto",opacity:1},transition:{ease:"linear",duration:.1}},tr=[],to=e=>{var t,s,a;let{conversationUuid:l,block:r,message:o,updatedMessage:d,index:c,isShared:u,isStreaming:m,isLastMessage:f,publishedArtifacts:x,isFirstBlockOfMessage:h,isLastBlockOfMessage:g,renderMode:p,isFirstItemInGroup:v,isLastItemInGroup:j}=e,{renderToolUseCell:b}=(0,e3.Q)(),y=(0,V.Y)(r),w=r.name,_=r.id,k=r.context,N=null==(t=d.content)?void 0:t[c+1],M=(null==N?void 0:N.type)==="tool_result"?N:void 0,C=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{name:a,id:n,approval_options:l,approval_key:r,partial_json:o}=t,{servers:d}=(0,e9.gt)(),c=(0,eh.M)(),{track:u}=(0,eE.st)(),m=(0,e7.p9)(),f=(0,e9.HJ)(),{mutate:x}=(0,e7.p4)(e),{getApprovalSetting:h}=(0,e9.BN)(),{toggleMcpToolAlwaysApproved:g}=(0,e9.es)(),{account:p}=(0,P.YL)(),v=(0,i.useMemo)(()=>{var e;return Object.entries(null!=(e=null==p?void 0:p.settings.enabled_mcp_tools)?e:{}).filter(e=>{let[t,s]=e;return!!s}).map(e=>{let[t]=e;return t})},[null==p?void 0:p.settings.enabled_mcp_tools]),j=(0,i.useRef)(!1),b=null,y=null;for(let e of d){let t=e.tools.find(t=>a===t.name||a==="".concat(e.name,":").concat(t.name));if(t){b=t,y=e;break}}let w=m&&(null==y?void 0:y.type)!=="local",{approvalSetting:_,alwaysAllowEnabled:k}=h(null==b?void 0:b.serverName,b),N=l?l.includes("always"):k,M=f&&!!t.id&&!!b,C=j.current||s,A=M&&(m?!!l&&!!r:!("never"===_||v.includes(b.alwaysApprovedKey))),S=JSON.stringify((0,V.Y)(t)),z=!!o&&S===o,E=(0,i.useCallback)(t=>{if(M&&b&&!C){if("always"!==t||r||g(b.alwaysApprovedKey,!0),"deny"===t)if(w)x({tool_use_id:n,is_approved:!1,approval_key:r});else{var s;c(e,a,n,S,{overriddenResult:{content:[{type:"text",text:"The user has chosen to disallow the tool call."}],is_error:!0}}),u({event_key:"mcp.tools.called",result:"disallowed",argument_count:Object.keys(null!=(s=(0,e8.p)(S))?s:{}).length})}else w?x({tool_use_id:n,is_approved:!0,approval_key:r,approval_option:t}):c(e,a,n,S);j.current=!0}},[M,C,b,r,g,w,x,c,e,a,n,S,u]);return!M||A||C||w||!z||(c(e,a,n,S),j.current=!0),{approvalRequired:A,disabled:!z,approved:C,submitToolApproval:E,showAlwaysAllowed:N}}(l,r,!!M),A={integrationName:r.integration_name,integrationIcon:r.integration_icon_url,message:(null==M?void 0:M.message)||r.message,input:r.display_content,result:null==M?void 0:M.display_content},S=!!d.content&&d.content.length<=c+1&&m,z=((e,t,s)=>{var a,n,i,l;let r,o,d,c=(null==t?void 0:t.type)==="tool_use"&&(null==t?void 0:t.name)==="artifacts",u=(null==e?void 0:e.type)==="tool_use"&&(null==e?void 0:e.name)==="artifacts";s.partial_json?s.partial_json.includes('"command":"create"')&&(r=(e=>{let t=e.match(/"id"\s*:\s*"([^"]*)"/);return t?t[1]:void 0})(s.partial_json)):r=null==(n=s.input)?void 0:n.id,u&&(o=null==e||null==(i=e.input)?void 0:i.id),!c||(null==t?void 0:t.partial_json)||(d=null==t||null==(l=t.input)?void 0:l.id);let m=r===o,f=r===d,x="individual_cell_create",h=null==(a=s.input)?void 0:a.command;if(h&&(x=({create:"individual_cell_create",update:"individual_cell_update",rewrite:"individual_cell_rewrite"})[h]),!c&&!u)return x;if(c&&u)if(!m&&!f)return x;else if(m&&!f)return"multi_edit_last";else return"multi_edit_not_last";if(c&&!u)if(!f)return x;else return"multi_edit_not_last";if(!c&&u&&m)return"multi_edit_last";return x})(null==(s=d.content)?void 0:s[c-2],null==(a=d.content)?void 0:a[c+2],r);if(!b)throw Error("renderToolUseCell() is not provided, missing ChatMessageContext?");let E=b({toolUseId:_,input:y,isLastMessage:f,message:o,publishedArtifacts:x,isStreaming:S,toolName:w,toolResult:M,displayData:A,approvalData:C,artifactCellType:z,isFirstBlockOfMessage:h,isLastBlockOfMessage:g,isShared:u,context:k,renderMode:p,groupItemKey:String(c),isFirstItemInGroup:v,isLastItemInGroup:j});return(0,n.jsx)(i.Fragment,{children:E})},td=e=>{var t,s,a;let{isStreaming:l,currentEdit:r,setCurrentEdit:o,textAreaRef:d,finishEdit:c,cancelEdit:u,author:m,loggedInAccount:f,message:x,selectAttachment:g,showSharedImageMissing:p=!1,showSharedFileMissing:j=!1}=e;(0,i.useEffect)(()=>{let e=e=>{if("Enter"!==e.key||e.shiftKey||(e.preventDefault(),c()),"Escape"===e.key&&(e.preventDefault(),u()),"a"===e.key&&(e.metaKey||e.ctrlKey)&&document.activeElement===d.current){var t;null==(t=d.current)||t.select()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[c,u,d]);let b=null!=(a=x.files_v2)?a:x.files,y=p||j||x.attachments.length+b.length+((null==x||null==(t=x.sync_sources)?void 0:t.length)||0)>0;return(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c()},children:[y&&(0,n.jsxs)("div",{className:"mx-0.5 mb-3 flex flex-wrap gap-0.5",children:[b.map((e,t)=>(0,n.jsx)(h.NM,{size:"lg",file:e},t)),x.attachments.map((e,t)=>(0,n.jsx)(h.NM,{size:"lg",file:e,onClick:()=>null==g?void 0:g(e)},t)),null==x||null==(s=x.sync_sources)?void 0:s.map(e=>(0,n.jsx)(eD.V,{uuid:e.uuid,syncSource:e},e.uuid)),p&&(0,n.jsx)(h.sv,{}),j&&!p&&(0,n.jsx)(h.lD,{})]}),(0,n.jsx)(tm,{...l?ti:ta,className:"w-full",children:(0,n.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,n.jsx)("div",{className:"flex shrink-0 items-center",children:(0,n.jsx)(B.e,{name:m||(null==f?void 0:f.full_name)||"",size:"sm"})}),(0,n.jsxs)("div",{className:"font-user-message mr-3 grid w-full grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6",children:[(0,n.jsx)(W.fs,{value:r,onChange:e=>o(e.target.value),autoFocus:!0,className:"w-full",ref:d}),(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsxs)("div",{className:"text-text-300 flex flex-row items-center gap-2 text-xs",children:[(0,n.jsx)(w.R,{"aria-hidden":"true",className:"shrink-0"}),(0,n.jsx)("div",{children:(0,n.jsx)(k.A,{defaultMessage:"Editing this message will create a new conversation branch. You can switch between branches using the arrow navigation buttons.",id:"zqkUZeVH+L"})})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(v.$,{onClick:u,variant:"secondary",children:(0,n.jsx)(k.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,n.jsx)(v.$,{type:"submit",disabled:0===r.length,children:(0,n.jsx)(k.A,{defaultMessage:"Save",id:"jvo0vs3nF0"})})]})]})]})]})})]})},tc=(0,i.memo)(function(e){var t,s,a,l,r,o,d;let{lastHumanMessageRef:c,lastAssistantMessageRef:u,isLastMessage:m,isLastHumanMessage:f,selectAttachment:g,author:p,isInteractive:v=!0,onOpenArtifact:b,onResize:y,editable:w,conversationSettings:_,publishedArtifacts:k=tr,messageWarningProps:N,showSharedImageMissing:M=!1,showSharedFileMissing:C=!1,isFirstAssistantMessage:A,isShared:S,isTemporary:z=!1,actionEmitter:E,onSendContinue:I,isResearchPending:R=!1,...F}=e,{previousMessage:D,message:W,isStreaming:V,conversationUUID:X}=F,[Z,Q]=(0,i.useState)(!1),[$,ee]=(0,i.useState)(""),et=(0,i.useRef)(null),es=(0,i.useRef)(1);(0,i.useEffect)(()=>{m||(es.current+=1)});let ea=null!=(d=W.files_v2)?d:W.files,en=((e,t)=>{let s=(0,J.n)(),a=(0,i.useCallback)(e=>{if("text"!==e.type)return e;let a=e.text;return s&&e.citations&&e.citations.length>0&&(a=(0,O.k0)(e.citations,a)),a=t?(0,G.Tm)(a):(0,G.it)(a),{...e,text:a}},[t,s]);return(0,i.useMemo)(()=>{var t;let s=e.content,n=null==(t=e.content)?void 0:t[0];(null==n?void 0:n.type)==="text"&&""===n.text.trim()&&(s=null==s?void 0:s.slice(1));let i=(null==s?void 0:s.map(e=>a(e)))||[];return{...e,content:i}},[e,a])})(W,b),ei="",el=null==(t=en.content)?void 0:t.find(e=>"text"===e.type);el&&"text"in el&&(ei=el.text);let er=(0,i.useRef)(!1),eo=(0,i.useRef)(!1),{account:ed,activeOrganization:ec}=(0,P.YL)(),{value:eu}=(0,j.fS)("use_in_house_latex_transformer"),em=(0,i.useCallback)((e,t)=>{null==E||E.emit("retry",{parent_message_uuid:e,paprika_mode:t})},[E]),ef=w?()=>{ee(ei),Q(!0)}:void 0,ex=(0,i.useCallback)(()=>{0!==$.length&&E&&(E.emit("edit",{message:en,text:$}),Q(!1),ee(""))},[$,E,en]),eh=(0,i.useCallback)(e=>null==b?void 0:b(e,en.uuid),[b,en.uuid]),{dispatchChatResource:eg}=(0,e6.i)(),{setIsDrawerExpanded:ep}=(0,e5.x)(),ev=(0,i.useMemo)(()=>void 0,[null==ec?void 0:ec.uuid,X,eg,ep,en.uuid]),ej="human"===en.sender,eb="assistant"===en.sender,ey=null==(s=en.content)?void 0:s.some(e=>"text"===e.type&&""!==e.text),ew=m&&V,e_=M||C||en.attachments.length+ea.length+((null==en||null==(a=en.sync_sources)?void 0:a.length)||0)>0,ek=(0,i.useMemo)(()=>{var e,t;return null!=(t=null==(e=W.sync_sources)?void 0:e.filter(e=>e.type===H.v8.GDRIVE).map(e=>e.config.uri))?t:[]},[W.sync_sources]),eN=(0,K.qL)(ek),eM=(0,i.useMemo)(()=>eN.some(e=>{let{data:t}=e;return t&&/\[image\d*\]/.test(t.text)}),[eN]),eC="voice"===en.input_mode||"speech_input"===en.input_mode,eS=(0,Y.useDynamicConfig)("claudeai_isp_thinking_ux");if(Z)return(0,n.jsx)(td,{isStreaming:V,currentEdit:$,setCurrentEdit:ee,textAreaRef:et,finishEdit:ex,cancelEdit:()=>{Q(!1),ee("")},author:p,loggedInAccount:ed,message:en,selectAttachment:g,showSharedImageMissing:M,showSharedFileMissing:C});let ez=function(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:eY.l.Standard,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=s[t+1],d=(null==o?void 0:o.type)==="tool_result",c=0===t,u=!!s.length&&t===s.length-1-!!d;if("thinking"===e.type){var f;return(0,n.jsx)(e1,{index:t,text:e.thinking,cutOff:e.cut_off,startTimestamp:e.start_timestamp,stopTimestamp:e.stop_timestamp,isStreaming:ew&&!e.stop_timestamp,mostRecentSummary:null==(f=e.summaries)?void 0:f.at(-1),messageUuid:en.uuid,onToggle:()=>{y&&y()},isFirstBlockOfMessage:c,isLastBlockOfMessage:u,renderMode:a,isFirstItemInGroup:l,isLastItemInGroup:r},t)}if("tool_use"===e.type)return(0,n.jsx)(to,{conversationUuid:X,block:e,message:W,updatedMessage:en,index:t,isShared:S,isStreaming:V,isLastMessage:m,publishedArtifacts:k,isFirstBlockOfMessage:c,isLastBlockOfMessage:u,renderMode:a,isFirstItemInGroup:l,isLastItemInGroup:r},t);if("text"===e.type){if(0===t&&""===e.text)return;return(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)(L.fP,{text:e.text,blockCitations:e.citations,hasLinkRef:er,hasCodeRef:eo,isStreaming:V,onOpenArtifact:eh,isLastMessage:m,publishedArtifacts:k,useInHouseLatexPlugin:eu,onLinkClick:ev}),""]},"".concat(t,"-").concat(ew?"streaming":"static"))}};return(0,n.jsxs)("div",{ref:f?c:m?u:null,"data-test-render-count":es.current,children:[ej&&(0,n.jsxs)("div",{className:"mb-1 mt-1",children:[e_&&(0,n.jsxs)("div",{className:"gap-2 mx-0.5 mb-3 flex flex-wrap",children:[ea.map((e,t)=>(0,n.jsx)(h.NM,{size:"lg",file:e},t)),en.attachments.map((e,t)=>(0,n.jsx)(h.NM,{size:"lg",file:e,onClick:()=>null==g?void 0:g(e)},t)),null==en||null==(l=en.sync_sources)?void 0:l.map(e=>(0,n.jsx)(eD.V,{uuid:e.uuid,syncSource:e},e.uuid)),M&&(0,n.jsx)(h.sv,{}),C&&!M&&(0,n.jsx)(h.lD,{})]}),(0,n.jsxs)(tm,{className:ey?"pr-6":"pr-[2.5px]",...V?ti:ta,children:[(0,n.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,n.jsx)("div",{className:"shrink-0",children:(0,n.jsx)(B.e,{name:p||(null==ed?void 0:ed.full_name)||"",size:"sm"})}),(0,n.jsx)("div",{"data-testid":"user-message",className:(0,U.A)("font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6 tracking-tight",{italic:eC}),children:null==(r=en.content)?void 0:r.map((e,t)=>"text"!==e.type?null:(0,n.jsx)(x,{text:e.text},t))})]}),(0,n.jsx)(T,{message:W,isLastMessage:m,hasLink:er.current,hasDriveDocWithImages:eM,conversationSettings:_,messageWarningPropsFromParent:N}),(0,n.jsx)(eA,{isLastMessage:m,isInteractive:v,editMessage:ef,onRetry:em,isResearchPending:R,isTemporary:z,...F})]})]}),eb&&(0,n.jsx)(n.Fragment,{children:en.content&&en.content[0]&&(0,n.jsx)(q.P.div,{style:{height:"auto"},...V?tl:ta,children:(0,n.jsxs)(tf,{"data-is-streaming":ew,...V?tn:ta,className:m?"pb-3":"pb-8",children:[(0,n.jsx)(tx,{children:(()=>{let e=en.content,t=[],s=Array(e.length).fill(!1);for(let a=0;a<e.length;a++){let i,l=e[a],r=[],o=!1;if(eS.get("timeline_enabled",!1)&&(0,e4.Ih)(l,eS)){if(r.push([l,a,(0,e4.h4)(l)]),s[a])continue;for(let t=a+1;t<e.length;t++){let s=e[t];if(!(0,e4.Ih)(s,eS))break;r.push([s,t,(0,e4.h4)(s)]),t===e.length-1&&(o=!0)}}if(eS.get("timeline_artifacts_enabled",!1)){let e=r.findLastIndex(e=>{let[t]=e;return"tool_use"===t.type&&"artifacts"===t.name});if(e>=0){r=r.slice(0,e);for(let e=0;e<r.length;e++){let t=r[e],s=t[0];"tool_use"===s.type&&"artifacts"===s.name&&(t[2]=!1)}}}let d=0;for(let[,,e]of r)e&&d++;d>1?(r.forEach(e=>{let[,t]=e;s[t]=!0}),i=(0,n.jsx)(e4.DT,{isFirstBlockOfMessage:0===a,isLastBlockOfMessage:o,isStreaming:V,children:r.map((t,s)=>{let[a,n,i]=t;if(i)return ez(a,n,e,eY.l.TimelineGroup,0===s,s===r.length-1)})},"group-".concat(a))):i=ez(l,a,e),t.push(i)}return t})()}),null==(o=en.content)?void 0:o.map((e,t)=>{if("bell"===e.type||"voice_note"===e.type)return(0,n.jsx)(eF,{text:e.text,title:e.title},t)}),!V&&m&&(0,n.jsx)(eL,{previousMessage:D}),(0,n.jsx)(eA,{isLastMessage:m,isInteractive:v,isFirstAssistantMessage:A,onRetry:em,isResearchPending:R,isTemporary:z,...F}),(0,n.jsx)(T,{message:W,isLastMessage:m,messageWarningPropsFromParent:N,conversationSettings:_,hasLink:er.current,hasCode:eo.current,onRetry:em,onSendContinue:I})]})})})]})}),tu=()=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"animate-pulse flex flex-col gap-8 fade-out-bottom",children:[(0,n.jsx)(tm,{children:(0,n.jsx)("div",{className:(0,U.A)("rounded-full h-7 w-7 bg-text-200 opacity-40")})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-10/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-4/12"})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-10/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-9/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-4/12"})]})]})}),tm=(0,p.J)(q.P.div)(te()),tf=(0,p.J)(q.P.div)(tt()),tx=p.J.div(ts())},39741:(e,t,s)=>{s.d(t,{NotificationListener:()=>S,hG:()=>A,Wo:()=>M});var a=s(98518),n=s(1761),i=s(89598),l=s(70825),r=s(20996),o=s(9801),d=s(7620),c=s(42071),u=s(24478),m=s(27511),f=s(65988);let x=(0,u.w)("CiRhbnRocm9waWMvY2xhdWRlL3B1c2gvZW52ZWxvcGUucHJvdG8SFWFudGhyb3BpYy5jbGF1ZGUucHVzaCJfChVQdXNoT3BlcmF0aW9uRW52ZWxvcGUSDwoHc2VydmljZRgBIAEoCRIOCgZtZXRob2QYAiABKAkSJQoHcmVxdWVzdBgDIAEoCzIULmdvb2dsZS5wcm90b2J1Zi5BbnlC4wEKGWNvbS5hbnRocm9waWMuY2xhdWRlLnB1c2hCDUVudmVsb3BlUHJvdG9QAVpBZ2l0aHViLmNvbS9hbnRocm9waWNzL21vYmlsZS1hcHBzL2dvL3Byb3Rvcy9hbnRocm9waWMvY2xhdWRlL3B1c2iiAgNBQ1CqAhVBbnRocm9waWMuQ2xhdWRlLlB1c2jKAhVBbnRocm9waWNcQ2xhdWRlXFB1c2jiAiFBbnRocm9waWNcQ2xhdWRlXFB1c2hcR1BCTWV0YWRhdGHqAhdBbnRocm9waWM6OkNsYXVkZTo6UHVzaGIGcHJvdG8z",[f.f]),h=(0,m.Z)(x,0);var g=s(48021);let p=(0,u.w)("CiZhbnRocm9waWMvY2xhdWRlL3B1c2gvb3BlcmF0aW9ucy5wcm90bxIVYW50aHJvcGljLmNsYXVkZS5wdXNoIpEBCg9PcGVuQ2hhdFJlcXVlc3QSIgoMYWNjb3VudF91dWlkGAEgASgJUgxhY2NvdW50X3V1aWQSLAoRb3JnYW5pemF0aW9uX3V1aWQYAiABKAlSEW9yZ2FuaXphdGlvbl91dWlkEiwKEWNvbnZlcnNhdGlvbl91dWlkGAMgASgJUhFjb252ZXJzYXRpb25fdXVpZDJrCh1Mb2dnZWRJblB1c2hPcGVyYXRpb25zU2VydmljZRJKCghPcGVuQ2hhdBImLmFudGhyb3BpYy5jbGF1ZGUucHVzaC5PcGVuQ2hhdFJlcXVlc3QaFi5nb29nbGUucHJvdG9idWYuRW1wdHlC5QEKGWNvbS5hbnRocm9waWMuY2xhdWRlLnB1c2hCD09wZXJhdGlvbnNQcm90b1ABWkFnaXRodWIuY29tL2FudGhyb3BpY3MvbW9iaWxlLWFwcHMvZ28vcHJvdG9zL2FudGhyb3BpYy9jbGF1ZGUvcHVzaKICA0FDUKoCFUFudGhyb3BpYy5DbGF1ZGUuUHVzaMoCFUFudGhyb3BpY1xDbGF1ZGVcUHVzaOICIUFudGhyb3BpY1xDbGF1ZGVcUHVzaFxHUEJNZXRhZGF0YeoCF0FudGhyb3BpYzo6Q2xhdWRlOjpQdXNoYgZwcm90bzM",[g.t]),v=(0,m.Z)(p,0);var j=s(95084),b=s(49642),y=s(66612);let w=(0,j.Iq)(p);var _=s(40459);let k={apiKey:"AIzaSyDu88493oN_Xq4PNVr_x8GUZPZhe-byS4U",authDomain:"proj-scandium-production-5zhm.firebaseapp.com",projectId:"proj-scandium-production-5zhm",storageBucket:_.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET||"",messagingSenderId:"365066964946",appId:"1:365066964946:web:920eb01ec340c52cb8420b",measurementId:_.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID||""},N="BBn_zDr7ckBwzQe6Tdc1k6E0tSdrG64L2ddLR36jUkdaleKmAdfgt3ao93t-nib3n3oBaAtbd9KyoxHaUGJLEzU",M=()=>{let[e,t]=(0,d.useState)(()=>"Notification"in window?Notification.permission:"default");return(0,d.useEffect)(()=>{"Notification"in window&&t(Notification.permission)},[]),(0,i.M)("focus",()=>{"Notification"in window&&t(Notification.permission)}),e},C=async(e,t)=>{if(!("Notification"in window))return!1;try{let s=await Notification.requestPermission();if(t&&t({event_key:"claudeai.notification.permission.result",permission:s}),"granted"!==s)return t&&t({event_key:"claudeai.notification.permission.result",permission:s}),!1;{let t,s;if(t=0===(0,r.Dk)().length?(0,r.Wp)(k):(0,r.Sx)(),!await (0,o.TT)())return!1;try{s=(0,o.dG)(t)}catch(e){return!1}let a=(await navigator.serviceWorker.getRegistrations()).find(e=>{var t;return null==(t=e.active)?void 0:t.scriptURL.includes("firebase-messaging-sw.js")});if(!a&&1)try{a=await navigator.serviceWorker.register("/firebase-messaging-sw.js"),await navigator.serviceWorker.ready}catch(e){(0,l.Cp)(e,{tags:{action:"registerServiceWorker"}})}try{let t=await (0,o.gf)(s,{vapidKey:N,serviceWorkerRegistration:a});if(t)e(t);else throw(0,l.Cp)(Error("FCM token is null"),{tags:{action:"getToken"}}),Error("FCM token is null")}catch(e){throw(0,l.Cp)(e,{tags:{action:"getToken"}}),e}}return"granted"===s}catch(e){return(0,l.Cp)(e,{tags:{action:"requestPermission"}}),!1}},A=()=>{let{track:e}=(0,a.st)(),{mutate:t}=(0,c.E)();return(0,d.useCallback)(async()=>(e({event_key:"claudeai.notification.permission.request_started"}),await C(e=>{t({channel_type:c.zZ.FCM,registration_token:e,client_app_name:"claude-ai-web"})},e)),[t,e])},S=()=>{let e=(0,d.useRef)(null),{account:t}=(0,n.YL)(),{mutate:s}=(0,c.E)(),a=async()=>{let t;if(t=0===(0,r.Dk)().length?(0,r.Wp)(k):(0,r.Sx)(),!await (0,o.TT)())return{app:null,messaging:null};if(e.current)return{app:t,messaging:e.current};let s=(0,o.dG)(t);return e.current=s,{app:t,messaging:s}},i=async e=>{try{return await (0,o.gf)(e,{vapidKey:N})}catch(e){return(0,l.Cp)(e,{tags:{action:"getFCMToken"}}),null}},u=(0,d.useCallback)(e=>{s({channel_type:c.zZ.FCM,registration_token:e,client_app_name:"claude-ai-web"})},[s]);return(0,d.useEffect)(()=>{var e;let t=!0,s=null;(async()=>{if("Notification"in window&&"granted"===Notification.permission)try{let{messaging:e}=await a();if(!e||!t)return;let n=await i(e);n&&t&&u(n),s=(0,o.xD)(e,e=>{var t,s;let a=(null==(t=e.data)?void 0:t.title)||"Claude",n={body:null==(s=e.data)?void 0:s.body,icon:"/favicon.svg",badge:"/favicon.svg",data:e.data},i=new Notification(a,n);i.onclick=()=>{var t;if(window.focus(),i.close(),null==(t=e.data)?void 0:t.payload){let t=function(e){if(!e)return null;try{let t=(0,b.Rf)(h,JSON.parse(e),{registry:w});if(!t.request||!t.method)return null;if("OpenChat"===t.method){let e=(0,y.rW)(t.request,v);if(null==e?void 0:e.conversationUuid)return{method:"OpenChat",targetUrl:"/chat/".concat(e.conversationUuid)}}return null}catch(e){return null}}(e.data.payload);if(t){window.location.href=t.targetUrl;return}}window.location.href="/"}})}catch(e){(0,l.Cp)(e,{tags:{action:"setupNotifications"}})}})();let n=e=>{let t=e.data;(null==t?void 0:t.type)==="NOTIFICATION_CLICK_NAVIGATE"&&(null==t?void 0:t.targetUrl)&&(window.location.href=t.targetUrl)};return null==(e=navigator.serviceWorker)||e.addEventListener("message",n),()=>{var e;t=!1,s&&s(),null==(e=navigator.serviceWorker)||e.removeEventListener("message",n)}},[t,u]),null}},42071:(e,t,s)=>{s.d(t,{E:()=>c,Hg:()=>o,vn:()=>d,zZ:()=>r});var a=s(77186),n=s(1761),i=s(87606);let l="notificationPreferences";var r=function(e){return e.FCM="FCM",e.APNS="APNS",e}({});let o=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid;return(0,a.Sk)("/api/organizations/".concat(t,"/notification/preferences"),{queryKey:[l,{orgUUID:t}],enabled:!!t})},d=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,s=(0,i.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/notification/preferences"),"PATCH",{onSuccess:()=>{s.invalidateQueries({queryKey:[l,{orgUUID:t}]})}})},c=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,s=(0,i.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/notification/channels"),"POST",{onSuccess:()=>{s.invalidateQueries({queryKey:["notificationChannels",{orgUUID:t}]})},meta:{noToast:!0}})}},49146:(e,t,s)=>{s(54568)},50824:(e,t,s)=>{s.d(t,{b:()=>ee});var a=s(54568),n=s(9234),i=s(2019),l=s(94390),r=s(32987),o=s(7620),d=s(4966),c=s(7726),u=s(22529),m=s(43195),f=s(41417),x=s(64786),h=s(90119),g=s(57338),p=s(27261),v=s.n(p),j=s(62971),b=s(50582),y=s(9447),w=s(98518),_=s(29242),k=s(27062),N=s(46760),M=s(79746),C=s(56273),A=s(95675),S=s(70028),z=s(1761),E=s(51121),I=s(56370),R=s(18179),T=s(37076),U=s(9786),L=s(93681),F=s(38583),D=s(17937),O=s(83755),P=s(11582),B=s(57622),W=s(34933),G=s(11134),J=s(75032),H=s(99513),V=s(81527);function Y(e){let{conversationUUID:t,snapshot:s,closeShareModal:n,showShareModal:i,disabled:l,disabledReason:r}=e,d=(0,N.A)(),u=!!s,{addError:m}=(0,E.Y)(),{account:x,activeOrganization:h}=(0,z.YL)(),g=(0,z.mV)(),p=(0,c.mz)(t),v=null==p?void 0:p.project_uuid,{data:b}=(0,V.fo)(v),y=(null==s?void 0:s.uuid)?q(s.uuid):"",{copyToClipboard:_,didCopy:k}=(0,U.C)(),{mutateAsync:M,isPending:C}=(0,c.Du)(t),{mutate:A,isPending:I}=(0,c.gG)(t,null==s?void 0:s.uuid),P=(0,o.useCallback)(async()=>{try{await M({project_uuid:null==p?void 0:p.project_uuid})}catch(e){m(d.formatMessage({defaultMessage:"Something went wrong while sharing this conversation. Please refresh the page.",id:"bMqfGRVujK"}))}},[M,m,null==p?void 0:p.project_uuid,d]),{track:B}=(0,w.st)(),W=(0,o.useCallback)(()=>{u?(B({event_key:"chat.share.modal.unshare_button.clicked",conversation_uuid:t,snapshot_uuid:null==s?void 0:s.uuid}),A()):(B({event_key:"chat.share.modal.share_button.clicked",conversation_uuid:t}),P())},[u,A,P,B,t,null==s?void 0:s.uuid]);return(0,a.jsx)(T.aF,{title:u?d.formatMessage({defaultMessage:"Chat shared",id:"svB/EMJSZy"}):d.formatMessage({defaultMessage:"Share chat",id:"bXa+lJhlYV"}),isOpen:i,onClose:n,modalSize:"lg",hasCloseButton:!0,children:x?(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)("div",{children:(0,a.jsx)(Z,{upToDate:null==s?void 0:s.up_to_date,upsertSnapshot:P,isShared:!!u,disabled:l,disabledReason:r,isRaven:g})}),(0,a.jsx)(K,{isShared:u,project:b,orgName:null==h?void 0:h.name,toggleShare:W,isRaven:g}),u&&(0,a.jsxs)("button",{className:"w-full flex items-center justify-between bg-inherit h-auto text-text-300 border border-border-300 rounded-md px-3 py-2 cursor-pointer hover:bg-bg-300/50",onClick:()=>{B({event_key:"chat.share.open_link.clicked",conversation_uuid:t,snapshot_uuid:null==s?void 0:s.uuid}),window.open(q((null==s?void 0:s.uuid)||""),"_blank")},children:[(0,a.jsx)("span",{className:"truncate",children:q((null==s?void 0:s.uuid)||"")}),(0,a.jsx)(L.F,{size:16})]}),!g&&(0,a.jsxs)("div",{className:"flex flex-row gap-1.5 rounded-lg bg-bg-400 p-2 text-text-300 text-xs",children:[(0,a.jsx)(F.R,{size:16,className:"shrink-0"}),(0,a.jsx)("div",{children:(0,a.jsx)(j.A,{defaultMessage:"Don’t share personal information or third-party content without permission, and see our <usagePolicyLink>Usage Policy</usagePolicyLink>.",id:"RkAGrm1doc",values:{usagePolicyLink:e=>(0,a.jsx)(S.LegalLink,{type:"aup",className:"hover:text-text-100 underline",children:e})}})})]}),(0,a.jsx)("div",{className:"mt-2 flex w-full items-center gap-2",children:u?(0,a.jsx)(f.$,{size:"lg",variant:k?"outline":"primary",onClick:()=>{B({event_key:"chat.share.copy_link.clicked",conversation_uuid:t,snapshot_uuid:null==s?void 0:s.uuid}),_(y)},prepend:k?(0,a.jsx)(D.r,{size:16}):(0,a.jsx)(O.N,{size:16}),children:k?(0,a.jsx)(j.A,{defaultMessage:"Copied",id:"p556q3uvbn"}):(0,a.jsx)(j.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})}):(0,a.jsx)(f.$,{size:"lg",loading:C||I,onClick:W,children:(0,a.jsx)(j.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})})})]}):(0,a.jsx)("div",{className:"mb-4 mt-8 flex h-full w-full items-center justify-center",children:(0,a.jsx)(R.Loading,{})})})}let q=e=>new URL("/share/".concat(e),window.location.origin).toString();function K(e){let{isShared:t,orgName:s,project:n,toggleShare:i,isRaven:l}=e,o=(0,a.jsxs)("button",{className:(0,r.A)("border-border-300 relative flex flex-row items-center justify-between gap-2 w-full rounded-xl border text-left !py-2 !px-3",t?"!bg-bg-000 text-text-000 cursor-pointer":"text-text-300 cursor-default"),children:[(0,a.jsx)(X,{state:t?"shared":"private",orgName:s,project:n,isRaven:l}),t&&(0,a.jsx)(J.a,{size:14,className:"right-3.5 top-3.5 text-text-000"})]});return t?(0,a.jsxs)(I.ms,{align:"start",trigger:o,children:[(0,a.jsx)(I.tJ,{onSelect:i,className:"!gap-0",children:(0,a.jsx)(X,{state:"private",isCurrentState:!t,orgName:s,project:n,isRaven:l})}),(0,a.jsx)(I.tJ,{onSelect:i,className:"!gap-0",children:(0,a.jsx)(X,{state:"shared",isCurrentState:t,orgName:s,project:n,isRaven:l})})]}):(0,a.jsx)("div",{children:o})}function X(e){let{state:t,isCurrentState:s,orgName:n,project:i,isRaven:l}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("span",{className:"inline-flex flex-row items-center justify-between gap-3 max-w-full overflow-hidden",children:[(0,a.jsxs)("span",{className:"inline-flex flex-row items-center gap-1.5 max-w-full",children:[(0,a.jsxs)("span",{className:"text-text-300 shrink-0",children:["private"===t&&(0,a.jsx)(P.c,{size:18}),"shared"===t&&l&&(0,a.jsx)(B.m,{size:18}),"shared"===t&&!l&&(0,a.jsx)(W.q,{size:18})]}),(0,a.jsxs)("p",{className:(0,r.A)("text-ellipsis overflow-hidden",s&&"font-medium text-text-000"),children:["private"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{defaultMessage:"Private (only you have access)",id:"EsW/fizDS4"}),"\xa0",s&&"private"!==t&&(0,a.jsx)("span",{className:"text-text-300 text-sm font-normal",children:(0,a.jsx)(j.A,{defaultMessage:"(Unshare this chat)",id:"EZEp1AdoRv"})})]}),"shared"===t&&l&&(0,a.jsx)(j.A,{defaultMessage:"Shared (anyone in {scope} can view)",id:"mG1NQd3Jzv",values:{scope:(null==i?void 0:i.is_private)?i.name:n}}),"shared"===t&&!l&&(0,a.jsx)(j.A,{defaultMessage:"Public (anyone on the web can view)",id:"no0TFMuRD0"})]})]}),s&&(0,a.jsx)(H.J,{size:16,weight:"bold",className:"text-accent-secondary-100 shrink-0"})]})})}function Z(e){let{upToDate:t,isShared:s,upsertSnapshot:n,disabled:i,disabledReason:l="",isRaven:r}=e;return(0,a.jsx)("div",{className:"flex flex-col gap-1.5",children:(0,a.jsx)("div",{className:"text-text-300 flex flex-row items-center gap-1 text-sm",children:s?(0,a.jsx)(a.Fragment,{children:r&&(t?(0,a.jsx)(j.A,{defaultMessage:"Future messages aren’t included",id:"YiRN6e1JBr"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{defaultMessage:"New messages since last shared",id:"RnySEeXsUF"}),(0,a.jsx)(_.m,{tooltipContent:i?l:(0,a.jsx)(j.A,{defaultMessage:"Share the most recent chat content",id:"oAf7Y+LN9j"}),children:(0,a.jsx)(f.$,{variant:"underline",size:"unset",className:"ml-1 gap-1",onClick:n,prepend:(0,a.jsx)(G.P,{}),disabled:i,children:(0,a.jsx)(j.A,{defaultMessage:"Update",id:"BWpuKlRSA1"})})})]}))}):(0,a.jsx)(j.A,{defaultMessage:"Only messages up until now will be shared",id:"OUOkOQvr8p"})})})}function Q(e){let{controlsSidebarIsOpen:t,closeControlsSidebar:s,openControlsSidebar:n,conversationUUID:i,isStreaming:l,wiggleFilesCount:d=0,isTemporary:u}=e,g=(0,N.A)(),p=(0,k.fS)("claudeai_beam").value,v=(0,h.V)(x.E_),b=function(e){let{track:t}=(0,w.st)(),{data:s}=(0,c.O2)(e.conversationUUID),[a,n]=(0,o.useState)(!1),i=(0,o.useCallback)(()=>{t({event_key:"chat.share.button.clicked",conversation_uuid:e.conversationUUID}),n(!0)},[t,e.conversationUUID]),l=!!(null==s?void 0:s.snapshot),r=l||!!(null==s?void 0:s.shareable)||!!(null==s?void 0:s.disabled_reason),d=e.isStreaming||!l&&!(null==s?void 0:s.shareable);return{conversationUUID:e.conversationUUID,showShareModal:a,openShareModal:i,closeShareModal:()=>n(!1),isShared:l,showShareFlow:r,disabled:d,...s}}({conversationUUID:i,isStreaming:l}),{chatResourceState:{artifacts:y}}=(0,C.i)(),{setIsDrawerExpanded:S}=(0,A.x)(),z=!!n&&!!s&&!t;return(0,a.jsxs)("div",{className:(0,r.A)("flex items-center gap-1","transition-opacity duration-300",t?"md:opacity-0 pointer-events-none user-select-none":"md:opacity-100",!z&&"hidden"),children:[b.showShareFlow&&!u&&(0,a.jsx)(M.U,{variant:"ghost",className:"font-medium text-sm !text-text-100",onClick:b.openShareModal,disabled:b.disabled||!z,prepend:(0,a.jsx)(m.SYj,{size:16,className:"mx-0.5"}),disabledReason:b.disabled_reason,children:(0,a.jsx)(j.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})}),y&&Object.values(y).length>0||d>0?(0,a.jsx)(_.m,{tooltipContent:d>0?g.formatMessage({defaultMessage:"Open sidebar",id:"+G35mRWa75"}):y&&Object.values(y).length>0?g.formatMessage({defaultMessage:"Open artifacts",id:"qsF1KKbjFR"}):g.formatMessage({defaultMessage:"Open sidebar",id:"+G35mRWa75"}),delayDuration:500,side:"bottom",children:(0,a.jsx)(f.$,{variant:"ghost",size:v?"icon_sm":"icon",onClick:()=>{S(!0)},disabled:!z,children:p?(0,a.jsx)(m.EZs,{}):(0,a.jsx)(m.nkM,{})})}):null,v&&(0,a.jsx)(M.U,{href:"/new",prepend:(0,a.jsx)(m.OMN,{size:16}),variant:"flat",disabled:!z,className:"ml-1",children:(0,a.jsx)(j.A,{defaultMessage:"Start new chat",id:"KcA+xo4hhh"})}),b.showShareFlow&&(0,a.jsx)(Y,{...b})]})}let $=(0,o.memo)(function(e){let{conversationUUID:t,name:s,isInteractive:n=!0,sharedBy:i,project:l,controlsSidebarIsOpen:o,openControlsSidebar:d,closeControlsSidebar:p,isStreaming:w,isSharedChat:_,wiggleFilesCount:k=0}=e,{data:N}=(0,c.Bq)(t,{enabled:!_}),M=!!l&&!l.is_harmony_project,C=(0,h.V)(x.E_);return(0,a.jsxs)(y.z,{className:(0,r.A)("h-12",!C&&"-mb-6"),contentClassName:"gap-6 pr-2",sticky:!0,children:[(0,a.jsxs)("div",{className:"flex min-w-0 flex-1 shrink flex-col md:flex-row md:items-center",children:[M&&(0,a.jsx)(v(),{href:"/project/".concat(l.uuid),className:"text-text-300 hover:text-text-100 inline-flex min-w-0 shrink-[4] items-center max-md:pl-1 max-md:font-base font-large",children:(0,a.jsxs)("div",{className:"truncate",children:[l.name," ",(0,a.jsx)("span",{className:"opacity-50",children:"/"})]})}),(0,a.jsx)("div",{className:"flex min-w-0 shrink-1 items-center max-md:font-base font-large",children:n&&N?N.is_temporary?(0,a.jsxs)("div",{className:"flex flex-row items-center text-text-500",children:[(0,a.jsx)(g.F,{className:"mr-1.5",size:16}),(0,a.jsx)(u.YX,{id:"jasmine_sapphire_rocket"})]}):(0,a.jsx)(b.p,{conversation:N,initialName:s,trigger:(0,a.jsx)(f.$,{variant:"ghost",size:"default",className:"!text-text-000 !shrink gap-1 !px-1 !py-0 !scale-100 !h-7",append:(0,a.jsx)(m.biH,{size:16}),"data-testid":"chat-menu-trigger",children:(0,a.jsx)("div",{className:"min-w-0 flex-1",children:(0,a.jsx)("div",{className:"truncate",children:s.length>0?s:(0,a.jsx)(j.A,{defaultMessage:"Untitled",id:"3kbIhS7KZS"})})})})}):(0,a.jsx)("div",{className:"truncate",children:s.length>0?s:(0,a.jsx)(j.A,{defaultMessage:"Untitled",id:"3kbIhS7KZS"})})})]}),(0,a.jsxs)("div",{className:"right-3 flex gap-2",children:[i&&(0,a.jsx)("div",{className:"bg-bg-300 text-text-300 rounded-full px-3 py-1.5 font-base",children:(0,a.jsx)(j.A,{defaultMessage:"Shared by {sharedBy}",id:"UMLOHo6H9c",values:{sharedBy:i}})}),t&&!_&&(0,a.jsx)(Q,{conversationUUID:t,controlsSidebarIsOpen:o,openControlsSidebar:d,closeControlsSidebar:p,isStreaming:w,wiggleFilesCount:k,isTemporary:null==N?void 0:N.is_temporary})]})]})});function ee(e){let{headerProps:t,mainElement:s,drawerElement:c,auxilaryElement:u,isDrawerOpen:m,autoscrollRef:f,autoscrollDisabled:x,leftSidebarElement:h}=e,[g,p]=(0,o.useState)(!1),v=(0,o.useRef)(null),j=(0,o.useRef)(null),b=(0,o.useRef)(null),y=(0,o.useRef)({interacted:!1}),{setIsDrawerExpanded:w}=(0,A.x)(),_=(0,i.F)("md");(0,o.useEffect)(function(){let e=!0;if(!j.current||!v.current||!k.current||!b.current)return;let t=v.current,s=j.current,a=b.current;if(_){let e=m?window.innerWidth/2-d.r:s.getBoundingClientRect().width;a.style.width="".concat(e,"px")}let n=Date.now(),i=m?0:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=parseFloat(e);return isNaN(s)?t:s}(s.style.flexGrow,50);return m&&(requestAnimationFrame(function i(){if(!e)return;let l=(Date.now()-n)/220,r=50*l;if(l>=1||!_){t.style.flex=String(50),s.style.flex=String(50),a.style.width="auto";return}t.style.flex=String(100-r),s.style.flex=String(r),requestAnimationFrame(i)}),y.current.interacted=!0),!m&&y.current.interacted&&requestAnimationFrame(function l(){if(!e)return;let r=(Date.now()-n)/220,o=i-r*i;if(r>=1||!_){t.style.flex=String(100),s.style.flex=String(0),a.style.width="auto";return}t.style.flex=String(100-o),s.style.flex=String(o),requestAnimationFrame(l)}),()=>{e=!1}},[m]);let[k,N]=(0,l.w)();return(0,o.useEffect)(()=>{if(!j.current||!v.current||!k.current)return;let e=k.current.getBoundingClientRect(),t=v.current.getBoundingClientRect();if(window.innerWidth<768||t.width>420)return;let s=420/e.width*100;v.current.style.flex=String(s),j.current.style.flex=String(100-s)},[N.width,N.height,k]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:(0,r.A)("flex flex-1 h-screen w-full overflow-hidden relative",g&&"select-none"),ref:k,onMouseUp:function(){p(!1),document.body.style.removeProperty("cursor")},onMouseMove:e=>{var t;if(!g||!j.current||!v.current||!k.current)return;let s=k.current.getBoundingClientRect(),a=v.current.getBoundingClientRect(),n=(t=e.clientX-a.left,Math.min(Math.max(t,420),s.width-240)/s.width*100);v.current.style.flex=String(n),j.current.style.flex=String(100-n)},children:[h,(0,a.jsxs)("div",{ref:v,className:"h-screen flex flex-col overflow-hidden",style:{flex:"".concat(100," 0")},children:[(0,a.jsx)($,{...t}),(0,a.jsx)(n.Z,{ref:f,disabled:x,className:"relative h-full flex-1 flex overflow-x-hidden overflow-y-scroll pt-6",children:s})]}),(0,a.jsxs)("div",{className:(0,r.A)("max-md:hidden group w-2 relative h-full cursor-col-resize -mr-1 z-30 grid place-items-center",!m&&"hidden"),onMouseDown:function(){p(!0),document.body.style.setProperty("cursor","col-resize")},children:[(0,a.jsx)("div",{className:(0,r.A)("absolute top-0 bottom-0 right-1 w-[0.5px] bg-border-300","transition-all group-hover:delay-75 group-hover:bg-accent-secondary-100 group-hover:w-px group-hover:translate-x-[0.5px]",g&&"!bg-accent-secondary-000")}),(0,a.jsx)("div",{className:(0,r.A)("h-6 w-2 relative","rounded-full border-0.5 bg-bg-100 shadow border-border-300","transition duration-200 group-hover:delay-75 group-hover:border-accent-secondary-900 group-hover:bg-accent-secondary-900","cursor-col-resize",g&&"!bg-accent-secondary-000 !border-accent-secondary-000")})]}),(0,a.jsx)("div",{ref:j,className:(0,r.A)("max-md:absolute top-0 right-0 bottom-0 left-0 z-20","md:flex-grow-0 md:flex-shrink-0 md:basis-0","overflow-hidden h-screen",m?"max-md:flex-1":"max-md:hidden",g&&"pointer-events-none"),style:{flex:"0 0"},children:(0,a.jsxs)("div",{ref:b,className:"flex flex-col h-full overflow-hidden",children:[(0,a.jsx)("div",{className:"h-12 md:hidden bg-bg-500 bg-opacity-60",onClick:()=>{w(!1)}}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden h-full bg-bg-100",children:c})]})})]}),null!=u?u:null]})}},52450:(e,t,s)=>{s.d(t,{aS:()=>f,xW:()=>u});var a=s(42977),n=s(54568),i=s(7726),l=s(90510),r=s(41417),o=s(7620),d=s(62971);function c(){let e=(0,a._)(["\n  w-full\n  tabular-nums\n  text-left\n  text-base\n  disabled:pointer-events-none\n  disabled:shadow-none\n  disabled:drop-shadow-none"]);return c=function(){return e},e}let u=(0,o.forwardRef)((e,t)=>{let[s,a]=(0,o.useState)(!1),[l,r]=(0,o.useState)(null),{totalConversations:c,numExported:u,numFailed:f,startExporting:x}=(e=>{let[t,s]=(0,o.useState)([]),[a,n]=(0,o.useState)(null),{data:l}=(0,i.EV)({limit:i.dy,enabled:!!a}),[r,d]=(0,o.useState)([]),{data:c,error:u}=(0,i.Bq)(null!=a?a:"");return(0,o.useEffect)(()=>{if(!l)return;if(c&&c.uuid===a)t.some(e=>e.uuid===c.uuid)||s(e=>[...e,c]);else{if(!u)return;d(e=>[...e,a])}let i=l.find(e=>!t.some(t=>t.uuid===e.uuid)&&!r.includes(e.uuid));i?n(i.uuid):e(t)},[c,u,r,a,t,l,e]),{totalConversations:null==l?void 0:l.length,numExported:t.length,numFailed:r.length,startExporting:()=>{l&&l.length&&n(l[0].uuid)}}})(e=>{a(!1),r(JSON.stringify(e,null,2))});return s?(0,n.jsx)(m,{ref:t,disabled:!0,...e,children:f>0?(0,n.jsx)(d.A,{defaultMessage:"Exporting: {numExported} / {totalConversations} ({numFailed} failed)",id:"hKNwlNeKOf",values:{numExported:u,totalConversations:c,numFailed:f}}):(0,n.jsx)(d.A,{defaultMessage:"Exporting: {numExported} / {totalConversations}",id:"EAIBTT4RJD",values:{numExported:u,totalConversations:c}})}):l?(0,n.jsx)(m,{ref:t,...e,onClick:()=>{let e=new Blob([l],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="conversations.json",s.click()},children:(0,n.jsx)(d.A,{defaultMessage:"Download conversations",id:"BS3OuP1PiM"})}):(0,n.jsx)(m,{ref:t,...e,onClick:()=>{a(!0),x()},children:(0,n.jsx)(d.A,{defaultMessage:"Export conversations",id:"0GrSEx4ynQ"})})});u.displayName="ExportConversationsWidget";let m=l.J.button(c()),f=e=>{let{conversationUUID:t}=e,{data:s}=(0,i.$z)(t);return(0,n.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>{let e=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="conversation.json",a.click()},children:(0,n.jsx)(d.A,{defaultMessage:"Download conversation",id:"VBmA8/nsFU"})})}},55563:(e,t,s)=>{s.d(t,{z:()=>f});var a=s(54568),n=s(56340),i=s(89697),l=s(41417),r=s(29242),o=s(9786),d=s(32987),c=s(46760),u=s(62971),m=s(92479);let f=e=>{let{className:t,code:s,codeTagProps:l,language:r,title:c}=e,{codeStyle:u}=(0,i.V)(),{didCopy:f,copyToClipboard:h}=(0,o.C)();return(0,a.jsxs)("div",{className:(0,d.A)("flex flex-col gap-3 p-3 bg-bg-100 rounded-md",t),children:[(0,a.jsx)(x,{language:r,title:c,handleCopy:()=>{h(s)},didCopy:f}),(0,a.jsx)(m.A,{className:"code-block__code !my-0 !p-0 !rounded-none !text-sm !leading-relaxed",codeTagProps:l,language:r,PreTag:"div",style:u,renderer:n.G,wrapLongLines:!0,children:s})]})},x=e=>{let{handleCopy:t,didCopy:s,language:n,title:i}=e,m=(0,c.A)();return(0,a.jsxs)("div",{className:"flex justify-between items-center h-3",children:[(0,a.jsx)("p",{className:(0,d.A)("text-text-300 text-[0.6875rem]",i?"font-ui font-medium tracking-tight":"font-mono font-[450]"),children:i||n}),(0,a.jsx)(r.m,{side:"bottom",tooltipContent:(0,a.jsx)(u.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"}),children:(0,a.jsx)(l.$,{"aria-label":m.formatMessage({defaultMessage:"Copy to clipboard",id:"aCdAsIsVv0"}),size:"icon_sm",variant:"ghost",className:"!-mr-1 !w-6 !h-6",onClick:t,children:(0,a.jsx)(o.u,{didCopy:s,size:12,className:"text-text-500"})})})]})}},56326:(e,t,s)=>{s.d(t,{$:()=>r,Q:()=>l});var a=s(54568),n=s(7620);let i=n.createContext({renderToolUseCell:void 0}),l=()=>n.useContext(i),r=e=>{let{renderToolUseCell:t,children:s}=e,l=(0,n.useMemo)(()=>({renderToolUseCell:t}),[t]);return(0,a.jsx)(i.Provider,{value:l,children:s})}},58565:(e,t,s)=>{s.d(t,{A:()=>Z});var a=s(54568),n=s(27062),i=s(77101),l=s(7620),r=s(85717),o=s(43156),d=s(64039),c=s(62971);let u=()=>(0,a.jsxs)("div",{className:"items-top flex w-full bg-bg-200 mt-5 p-3 rounded-xl items-center text-text-300",children:[(0,a.jsx)(d.R,{size:24}),(0,a.jsx)("p",{className:"font-base ml-3",children:(0,a.jsx)(c.A,{defaultMessage:"Claude has ended this chat.",id:"xJ+abA4nue"})})]});var m=s(94649),f=s(11515),x=s(91961),h=s(85544),g=s(58911),p=s(75006),v=s(94748);let j=p.z.object({url:p.z.string()}),b=e=>{let t,{input:s,toolResult:n,isStreaming:i}=e,r=null==n?void 0:n.is_error,[o,d]=(0,l.useState)(!1),u=(0,l.useMemo)(()=>{if(r)return;let e=function(e){if(!e||!e.content)return null;if(e.content.some(e=>"knowledge"===e.type)){let t=[];for(let s of e.content)"knowledge"===s.type&&t.push(s);return t}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let s=JSON.parse(t.text);return Array.isArray(s)?s.map(e=>{let t=h.ey.safeParse(e);return t.success?t.data:null}).filter(e=>null!==e):[]}catch(e){return[]}}(n);return null==e?void 0:e[0]},[r,n]),p=(0,l.useMemo)(()=>{if(!r)return;let e=function(e){if(!e||!e.content)return null;if(e.content.some(e=>"text"===e.type)){let t=[];for(let s of e.content)if("text"===s.type){let e=h.kS.safeParse(JSON.parse(s.text));e.success&&t.push(e.data)}return t}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let s=JSON.parse(t.text);return Array.isArray(s)?s.map(e=>{let t=h.tD.safeParse(e);if(!t.success)return null;{let e=h.kS.safeParse(JSON.parse(t.data.text));return e.success?e.data:null}}).filter(e=>null!==e):[]}catch(e){return[]}}(n);return null==e?void 0:e[0]},[r,n]),b=function(e){switch(e){case"INVALID_URL":return(0,a.jsx)(c.A,{defaultMessage:"The URL provided is invalid",id:"EXjAXf5Pbi"});case"URL_NOT_FOUND":return(0,a.jsx)(c.A,{defaultMessage:"Could not find this URL",id:"stDgCXJO7F"});case"RATE_LIMIT_EXCEEDED":return(0,a.jsx)(c.A,{defaultMessage:"Access to this website has been restricted due to rate limits",id:"VhUxwIo+O2"});case"ROBOTS_DISALLOWED":return(0,a.jsx)(c.A,{defaultMessage:"This website has blocked Claude via robots.txt rules",id:"dHtmXRJ647"});case"URL_TOO_LONG":return(0,a.jsx)(c.A,{defaultMessage:"The URL provided is too long",id:"K2DBYJqbtF"});case"SITE_BLOCKED":return(0,a.jsx)(c.A,{defaultMessage:"Access to this website is blocked",id:"WI6DZStAoi"});case"PERMISSIONS_ERROR":return(0,a.jsx)(c.A,{defaultMessage:"The URL was not provided by the user nor was it contained in any web search/fetch results",id:"aXYLYDjU6L"});case"UNKNOWN_ERROR":case"SERVER_ERROR":case"CLIENT_ERROR":return(0,a.jsx)(c.A,{defaultMessage:"An unknown error occurred",id:"3VG8rbxa4v"});case void 0:return null}}(null==p?void 0:p.error_type),{data:y}=j.safeParse(s);if(!y)return;let w=y.url,_=(null==u?void 0:u.title)||w,k=(0,x.Nj)(w);return t=i?k?(0,a.jsx)(c.A,{defaultMessage:"Fetching from {hostname}",id:"5qKeNV67+8",values:{hostname:k}}):(0,a.jsx)(c.A,{defaultMessage:"Fetching from site",id:"TSZq9sKvY7"}):r?(0,a.jsx)(c.A,{defaultMessage:"Failed to fetch <b>{title}</b>",id:"8JHipUo6K+",values:{title:_,b:e=>(0,a.jsx)("span",{className:"text-text-400",children:e})}}):(0,a.jsx)(c.A,{defaultMessage:"Fetched <b>{title}</b>",id:"BWNvvK6PhH",values:{title:_,b:e=>(0,a.jsx)("span",{className:"text-text-400",children:e})}}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.aX,{isError:r,errorMessage:b,text:t,secondaryText:i?void 0:k,handleClick:()=>d(!0),icon:(0,a.jsx)(f.d,{fadeInOnLoad:!0,url:w,size:16}),secondaryIcon:(0,a.jsx)(g.B,{size:16,className:"text-text-300"}),...e}),(0,a.jsx)(m.v,{isOpen:o,url:w,onClose:()=>d(!1),onConfirm:()=>{window.open(w,"_blank"),d(!1)}})]})};var y=s(33395),w=s(34059),_=s(34933),k=s(37463),N=s(45376),M=s.n(N),C=s(46760),A=s(74744),S=s(67532);function z(e){return"webpage_metadata"===e.metadata.type?e.url||"":e.metadata.doc_uuid}let E=e=>{let{isExpanded:t,toolName:s,results:n}=e;return(null==n?void 0:n.length)?(0,a.jsx)("div",{className:"flex flex-nowrap p-2 pt-0 flex-col",tabIndex:-1,children:"web_search"===s?(0,a.jsx)(R,{results:n,isExpanded:t}):(0,a.jsx)(T,{results:n,isExpanded:t})}):null},I={initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1,transition:{type:"spring",stiffness:400,damping:30,mass:1}}},R=e=>{let{isExpanded:t,results:s}=e;return(0,a.jsx)(a.Fragment,{children:s.map(e=>{var s;return e.knowledge&&"webpage_metadata"===e.knowledge.metadata.type?(0,a.jsx)(k.P.div,{variants:I,children:(0,a.jsx)(y.$,{disabled:!t,icon:(0,a.jsx)(f.d,{url:e.knowledge.metadata.favicon_url,size:16}),title:e.knowledge.title,subtitles:[e.knowledge.metadata.site_domain],url:null!=(s=e.knowledge.url)?s:void 0})},e.knowledge.url):null})})},T=e=>{let{isExpanded:t,results:s}=e;return(0,a.jsx)(a.Fragment,{children:s.map(e=>(0,a.jsx)(k.P.div,{variants:I,children:(0,a.jsx)(U,{disabled:!t,knowledge:e.knowledge})},e.uuid))})},U=e=>{let{disabled:t,knowledge:s}=e,n=(e=>{let{isError:t}=e,{isDriveAuthenticated:s}=(0,r.cI)();return(0,r.yy)()?s?t?i.I5.ACCESS_DENIED:i.I5.READY:i.I5.UNAUTHENTICATED:i.I5.DISABLED})({isError:!s});return(0,a.jsx)(A.Tc,{syncSourceType:i.v8.GDRIVE,syncStatus:n,disabled:t,title:(null==s?void 0:s.title)||"Untitled document",subtitles:(null==s?void 0:s.metadata.type)==="google_doc_metadata"&&s.metadata.owner?[s.metadata.owner]:void 0,url:(null==s?void 0:s.url)||void 0})},L=p.z.object({query:p.z.string(),n:p.z.number().int().optional()}),F=e=>{var t;let{toolName:s,syncSourceType:n,...i}=e,{input:l,toolResult:r,isStreaming:o,groupItemKey:d}=i,{isExpanded:c,setIsExpanded:u,snappyTransition:m}=(0,S.a)(!1,d),f=(0,C.A)(),x=null==r?void 0:r.is_error,g=x?null:function(e){if(!e)return null;if(e.content.some(e=>"knowledge"===e.type||"rag_reference"===e.type)){let t=[];for(let s of e.content)if("knowledge"===s.type)t.push({uuid:z(s),knowledge:s});else if("rag_reference"===s.type){let e=s.doc_uuid;t.push({uuid:e})}return M()(t,e=>e.uuid)}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let s=JSON.parse(t.text),a=(Array.isArray(s)?s.map(e=>{let t=h.ey.safeParse(e);return t.success?t.data:null}).filter(e=>null!==e):[]).map(e=>({uuid:z(e),knowledge:e}));return M()(a,e=>e.uuid)}catch(e){return[]}}(r),{data:p}=L.safeParse(l),j="web_search"===s?f.formatMessage({defaultMessage:"Searching the web",id:"5KajyzHSXj"}):f.formatMessage({defaultMessage:"Searching Google Drive",id:"V/QOi0yNF0"});if(!p)return;let b=f.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",id:"s88ium+h8p"},{count:null!=(t=null==g?void 0:g.length)?t:0}),y=!g&&o?j:p.query;return(0,a.jsx)(v.sH,{isExpandingDisabled:!!o,isExpanded:c,setIsExpanded:u,isError:x,text:y,secondaryText:o?void 0:b,icon:"web_search"===s?(0,a.jsx)(_.q,{size:16}):!!n&&(0,a.jsx)(w.A9,{type:n,size:14}),...i,children:(0,a.jsx)(v.NG,{isExpanded:c,snappyTransition:m,isScrollable:!0,children:!x&&!!(null==g?void 0:g.length)&&(0,a.jsx)(E,{isExpanded:c,toolName:s,results:g})})})};var D=s(70067);s(1761),p.z.object({prompt:p.z.string()});var O=s(33792),P=s(9946),B=s(54890),W=s(32987);function G(e){var t,s,n,i;let{input:r,toolResult:o,isStreaming:d,isLastMessage:c,onOpenArtifact:u,publishedArtifacts:m,artifacts:f,message:x,artifactCellType:h,selectedArtifactId:g,selectedArtifactVersion:p,isFirstBlockOfMessage:v,isLastBlockOfMessage:j}=e,b=B.oE.parse(r),y=c&&d,{versions:w,..._}=null!=(n=f[null!=(s=b.id)?s:""])?n:{},k=(0,l.useMemo)(()=>{let e=null==w?void 0:w.findIndex(e=>e.uuid===b.version_uuid);if(-1!==e)return e},[w,b.version_uuid]),N=null==(t=null!=(i=b.content)?i:b.new_str)?void 0:t.slice(0,250),M={isClosed:void 0!==o,..._,...b},C=g===M.id&&p===b.version_uuid,A="individual_cell_create"===h||"multi_edit_not_last"!==h;return(0,a.jsx)("div",{className:(0,W.A)(A&&(v?"pt-2":"pt-3"),A&&(j?"pb-2":"pb-3"),"multi_edit_not_last"===h&&"h-0"),children:(0,a.jsx)(P.uL,{versionNum:k?k+1:void 0,preview:N,versionCount:null==w?void 0:w.length,properties:M,isStreaming:d,isEdit:"individual_cell_create"!==h,isNotLastEdit:"multi_edit_not_last"===h,isLastMessage:c,onOpenArtifact:e=>{u&&u(e,x.uuid,b.version_uuid)},publishedArtifacts:y?P.b2:m,isExpanded:C})})}var J=s(22134);s(41417);var H=s(13625),V=s(82199),Y=s(70825),q=s(55563);let K=p.z.object({code:p.z.string().nullish().transform(e=>(null==e?void 0:e.charAt(0))==="\n"?e.slice(1):null!=e?e:void 0)}),X=e=>{var t;let{input:s,toolResult:n,isStreaming:i,groupItemKey:r}=e,o=(0,C.A)(),{isExpanded:d,setIsExpanded:c,snappyTransition:u}=(0,S.a)(i,r),m=null!=(t=K.parse(s).code)?t:"",{toolResultLogs:f,toolResultErrors:x}=(0,l.useMemo)(()=>n?(e=>{let t;if(!e.content||0===e.content.length||!e.content[0])return{toolResultLogs:"",toolResultErrors:"Error: Missing content data"};if("text"!==e.content[0].type)return{toolResultLogs:"",toolResultErrors:""};try{t=JSON.parse(e.content[0].text)}catch(e){return(0,Y.Cp)(e,{tags:{source:"repl-tool-result"}}),{toolResultLogs:"",toolResultErrors:"Error: failed to parse Analysis tool result"}}let s=t.logs?"Result\n\n"+t.logs.join("\n"):"";return"error"===t.status?{toolResultLogs:s,toolResultErrors:"Error\n\n"+t.error}:{toolResultLogs:s,toolResultErrors:""}})(n):{toolResultLogs:"",toolResultErrors:""},[n]);return(0,a.jsx)(v.sH,{isExpanded:d,setIsExpanded:c,icon:(0,a.jsx)(V.N,{size:16}),text:i?o.formatMessage({defaultMessage:"Analyzing data",id:"UkajfL/9Yh"}):o.formatMessage({defaultMessage:"Analyzed data",id:"NbwDtG2acW"}),secondaryText:i?void 0:o.formatMessage({defaultMessage:"View analysis",id:"fL+Q/8QHAy"}),...e,children:(0,a.jsx)(v.NG,{isExpanded:d,snappyTransition:u,isScrollable:!0,children:(0,a.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-1","data-testid":"repl-output",children:[(0,a.jsx)(q.z,{language:"javascript",code:m}),(0,a.jsx)(q.z,{title:o.formatMessage({defaultMessage:"Output",id:"fio5opLcOZ"}),language:"javascript",code:f}),!!x&&(0,a.jsx)(q.z,{title:o.formatMessage({defaultMessage:"Error",id:"KN7zKn8z4F"}),code:x,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"})]})})})};function Z(e){let{toolUseId:t,isLastMessage:s,isStreaming:l,toolName:d,input:c,message:m,onOpenArtifact:f,publishedArtifacts:x,toolResult:h,artifacts:g,onAllow:p,artifactCellType:v,isFirstBlockOfMessage:j,isLastBlockOfMessage:y,conversationUUID:w,selectedDrawerItem:_,isShared:k,displayData:N,approvalData:M,context:C,renderMode:A=O.l.Standard,groupItemKey:S,isFirstItemInGroup:z,isLastItemInGroup:E}=e,I=(0,r.fb)(),R=(0,o.be)(),{value:T}=(0,n.fS)("prism_enabled"),U={input:c,toolResult:h,isStreaming:l,isFirstBlockOfMessage:j,isLastBlockOfMessage:y,renderMode:A,groupItemKey:S,isFirstItemInGroup:z,isLastItemInGroup:E,message:m};if("end_conversation"===d)return(0,a.jsx)(u,{});let L=(null==_?void 0:_.type)==="artifact"?_:void 0,P=!!h&&!!_&&"compass"===_.type&&_.data.toolUseId===h.tool_use_id;switch(d){case"artifacts":return(0,a.jsx)(G,{input:c,toolResult:h,isLastMessage:s,isStreaming:l,onOpenArtifact:f,publishedArtifacts:x,artifacts:g,message:m,artifactCellType:v,selectedArtifactId:null==L?void 0:L.id,selectedArtifactVersion:null==L?void 0:L.versionUUID,isFirstBlockOfMessage:j,isLastBlockOfMessage:y});case"dolphin":return(0,a.jsx)(a.Fragment,{});case"repl":return(0,a.jsx)(X,{...U});case"drive_search":if(!I)break;return(0,a.jsx)(F,{syncSourceType:i.v8.GDRIVE,toolName:d,...U});case"web_search":if(!R)break;return(0,a.jsx)(F,{toolName:d,...U});case"web_fetch":return(0,a.jsx)(b,{...U});case"launch_extended_search_task":return(0,a.jsx)(D.wD,{toolUseId:t,isFirstBlockOfMessage:j,isLastBlockOfMessage:y,conversationUUID:w,toolResult:h,isShared:k,isExpanded:P,isStreaming:l,context:C})}let B=d.includes(":");return!B&&(null==N?void 0:N.integrationName)?(0,a.jsx)(J.K,{...N,toolName:d,isError:null==h?void 0:h.is_error,isStreaming:l,isFirstBlockOfMessage:j,isLastBlockOfMessage:y,renderMode:A,groupItemKey:S,isFirstItemInGroup:z,isLastItemInGroup:E}):(0,a.jsx)(H.d,{toolName:B?d.split(":")[1]:d,integrationName:null==N?void 0:N.integrationName,integrationIcon:null==N?void 0:N.integrationIcon,approvalData:M,...U})}p.z.object({returncode:p.z.number().int(),stdout:p.z.string(),stderr:p.z.string()}),s(95675),s(56273),s(49146)},65755:(e,t,s)=>{s.d(t,{u:()=>l});var a=s(40169),n=s(7904),i=s(57259);function l(e){let t=e.trim();return(0,a.yt)(t,{extensions:[(0,n.x)()],htmlExtensions:[(0,i.k)()]})}},67532:(e,t,s)=>{s.d(t,{a:()=>i});var a=s(7620),n=s(11480);let i=(e,t)=>{let s=(0,a.useRef)(!!e),[i,l]=(0,a.useState)(!!e),[r,o]=(0,a.useState)(!e),{expandedItemKey:d,setExpandedItemKey:c}=(0,n.D8)(),u=t&&c,m=(0,a.useCallback)(e=>{u&&c(e?t:void 0),l(e)},[u,c,l,t]),f=u?d===t:i;return(0,a.useEffect)(()=>{!e&&s.current&&setTimeout(()=>{l(!1),setTimeout(()=>{o(!0)},600)},2e3)},[e]),{isExpanded:f,setIsExpanded:m,snappyTransition:r}}},70067:(e,t,s)=>{s.d(t,{wD:()=>P,z7:()=>O});var a=s(54568),n=s(94275),i=s.n(n),l=s(8027),r=s(11515),o=s(77186),d=s(1761),c=s(41417),u=s(37076),m=s(98411),f=s(37711),x=s(98769),h=s(27062),g=s(85544),p=s(4705),v=s(67902),j=s(32987),b=s(37463),y=s(49645),w=s(7620),_=s(46760),k=s(62971),N=s(75006),M=s(92947),C=s(73325),A=s(93271),S=s(73817),z=s(38807),E=s(16310),I=s(33562);function R(e){let{onCancel:t,onConfirm:s}=e,n=(0,w.useRef)(null),{menuOptions:i,getEnabledRemoteTools:l}=(0,E.$3)(),r=(0,I.Cn)({setMcpDirectoryModalIsOpen:T,setStyleModalOpenWithScreen:T,setCreateProjectModalIsOpen:T,setGithubModalIsOpen:T,setGmailAuthModalIsOpen:T,setCreatePromptArgumentModalIsOpen:T}),o=(0,z._9)({actions:r,inputMenuIsOpen:!0,setInputMenuIsOpen:()=>void 0,rootItems:i,menuType:"research"});return(0,w.useEffect)(()=>{setTimeout(()=>{n.current&&n.current.focus()})},[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(u.aF,{isOpen:!0,modalSize:"2lg",onClose:t,className:"!px-4 !py-6",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:(0,a.jsx)(k.A,{defaultMessage:"Enable integrations for Claude to use in research",id:"OW3ZJC49V0"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S.s,{path:o.path,inputMenuSearchQuery:o.inputMenuSearchQuery,setInputMenuSearchQuery:o.setInputMenuSearchQuery,handleBack:o.handleBack}),o.menuView.currentItems.filter(e=>{let{menuItemHidden:t}=e;return!t}).map(e=>(0,a.jsx)(A.$,{item:e,onClick:()=>o.handleClickItem(e),isHighlighted:o.highlightedItemKey===e.key,countDisplayVariant:"verbose"},e.key))]}),(0,a.jsx)("div",{className:"bg-bg-300 border-border-400 border px-4 py-3 rounded-lg text-sm text-text-300",children:(0,a.jsx)(k.A,{defaultMessage:"Ensure you have appropriate permissions and trust third-party tools before continuing. <link>Learn more</link> about safely using research with connected apps.",id:"VU67M+9esK",values:{link:e=>(0,a.jsx)("a",{href:"https://support.anthropic.com/",className:"underline",target:"_blank",rel:"noreferrer noopener",children:e})}})}),(0,a.jsxs)("div",{className:"flex flex-row justify-end gap-2 mt-4",children:[(0,a.jsx)(c.$,{variant:"outline",onClick:t,children:(0,a.jsx)(k.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsxs)(c.$,{ref:n,onClick:function(){s({tools:l()})},children:[(0,a.jsx)(k.A,{defaultMessage:"Confirm",id:"N2IrpMDHDB"}),(0,a.jsx)("span",{className:"inline-block ml-2 p-1 bg-bg-000/20 rounded-sm",children:(0,a.jsx)(C.y,{size:12})})]})]})]})})})}function T(){}var U=s(95675),L=s(56273),F=s(84137),D=s(73347);let O=N.z.preprocess(e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},N.z.object({task_id:N.z.string()}));function P(e){let{toolUseId:t,isFirstBlockOfMessage:s=!1,isLastBlockOfMessage:n=!1,conversationUUID:i,toolResult:l,isShared:r,isExpanded:c=!1,isStreaming:u=!1,context:m}=e,{value:f}=(0,h.fS)("papi_mcp"),{activeOrganization:x}=(0,d.YL)(),{dispatchChatResource:p}=(0,L.i)(),{setIsDrawerExpanded:v}=(0,U.x)(),{decisionState:b,approveTool:y,denyTool:k}=function(e,t,s,a){let[n,i]=(0,w.useState)("pending"),l=!!(e&&t&&a),{isPending:r}=(0,o.Sk)("/api/organizations/".concat(e,"/chat_conversations/").concat(t,"/tool_approval_state/").concat(s),{enabled:l}),d=(0,o.L2)("/api/organizations/".concat(e,"/chat_conversations/").concat(t,"/tool_approval"),"POST",{enabled:!!(t&&!r),onSuccess(e,t){i(t.is_approved?"approved":"denied")}}).mutate;return{decisionState:n,isStatePending:r,approveTool:(0,w.useCallback)(e=>{let{tools:t}=e;d({tool_use_id:s,is_approved:!0,params:{tools:t}})},[d,s]),denyTool:(0,w.useCallback)(()=>{d({tool_use_id:s,is_approved:!1})},[d,s])}}(null==x?void 0:x.uuid,i,t,u),N=u?"approved"===b:l&&!(null==l?void 0:l.is_error),M=f&&(null==m?void 0:m.tools.length)&&u&&"pending"===b,C=(0,w.useMemo)(()=>{if(!(null==l?void 0:l.content))return;let e=l.content.map(e=>e&&"text"in e?e.text:"").join("\n"),{data:t}=O.safeParse(e);return null==t?void 0:t.task_id},[null==l?void 0:l.content]),{compassStatus:A,isLoading:S,error:z}=(0,F.CH)({organizationUUID:null==x?void 0:x.uuid,conversationUUID:i,taskId:C,isShared:r,enabled:N});(0,F.IK)(i,null==A?void 0:A.status);let E=!A,I=(0,w.useCallback)(()=>{E||(v(!0),p({type:"OPEN_COMPASS_STATUS",data:{conversationUUID:i,organizationUUID:null==x?void 0:x.uuid,isShared:r,toolUseId:null==l?void 0:l.tool_use_id,taskId:C}}))},[E,p,i,null==x?void 0:x.uuid,v,r,l,C]),T=(null==A?void 0:A.status)||g.zu.Starting,D=!!z||!!(null==l?void 0:l.is_error),P=(0,_.A)(),{title:B,subtitle:J}=(0,w.useMemo)(()=>{let e,t;if(D)return{title:P.formatMessage({defaultMessage:"Something went wrong",id:"JqiqNj0Ooi"})};let s=(null==A?void 0:A.total_sources)||0,a=0===s?P.formatMessage({defaultMessage:"Searching for sources...",id:"+4r/aaeR9v"}):P.formatMessage({defaultMessage:"{count, plural, one {# source} other {# sources}} and counting...",id:"wfqjY4cYXF"},{count:s}),n=P.formatMessage({defaultMessage:"{count, plural, one {# source} other {# sources}}",id:"WrpI57Uej/"},{count:s}),i=(0,F.Ui)(A),l=i||P.formatMessage({defaultMessage:"Researching...",id:"eD084+/kcH"}),r=i||P.formatMessage({defaultMessage:"Research complete",id:"9Tbl1w5GjC"});switch(T){case g.zu.Starting:{let t=[P.formatMessage({defaultMessage:"Getting everything ready...",id:"5nJVpwt8gP"}),P.formatMessage({defaultMessage:"Preparing your research assistant...",id:"vxRKHhLIWM"}),P.formatMessage({defaultMessage:"Initializing research tools...",id:"Lm6wYLrJ1Q"}),P.formatMessage({defaultMessage:"Setting up my research space...",id:"EGN8CB7IRt"}),P.formatMessage({defaultMessage:"Configuring research parameters...",id:"eYoO3vRQgY"}),P.formatMessage({defaultMessage:"Loading research capabilities...",id:"GHM/w3WPnr"}),P.formatMessage({defaultMessage:"Preparing to dive in...",id:"EW22N+F8aq"}),P.formatMessage({defaultMessage:"Setting the stage for discovery...",id:"l8a+mVgI7N"}),P.formatMessage({defaultMessage:"Getting your assistant ready...",id:"GLpbkAPwDC"}),P.formatMessage({defaultMessage:"Activating research mode...",id:"SPBnT2clve"}),P.formatMessage({defaultMessage:"Warming up the engines...",id:"biUnCTBtnQ"})],s=Math.floor(Math.random()*t.length);e=t[s];break}case g.zu.Planning:e=l,t=P.formatMessage({defaultMessage:"Creating my research plan...",id:"4eRg5buC9J"});break;case g.zu.InitiatingAgents:e=l,t=P.formatMessage({defaultMessage:"Searching for sources...",id:"+4r/aaeR9v"});break;case g.zu.Searching:e=l,t=a;break;case g.zu.CreatingArtifact:e=l,t=P.formatMessage({defaultMessage:"Writing and citing report...",id:"2b/CKxnAiJ"});break;case g.zu.Completed:t=n,e=r;break;case g.zu.Cancelled:e=l,t=P.formatMessage({defaultMessage:"Interrupted",id:"rJQDmlVOoX"});break;case g.zu.TimedOut:case g.zu.Failed:e=P.formatMessage({defaultMessage:"Something went wrong",id:"JqiqNj0Ooi"}),t=n}return{title:e,subtitle:t}},[P,T,A,D]);return M&&(null==m?void 0:m.use_finegrained_approval)?(0,a.jsx)(R,{onCancel:k,onConfirm:e=>{let{tools:t}=e;y({tools:t})}}):M?(0,a.jsx)(H,{tools:m.tools,onCancel:k,onApprove:()=>{y({tools:[]})}}):(0,a.jsx)("div",{className:(0,j.A)("my-3",s?"mt-2":"mt-3",n?"mb-2":"mb-3"),children:S?(0,a.jsxs)("div",{className:"w-full p-4 text-text-000 font-ui tracking-tight rounded-xl border border-border-300 shadow-xs",children:[(0,a.jsx)("div",{className:"h-5 bg-bg-300/30 rounded-md w-3/4"}),(0,a.jsx)("div",{className:"flex text-text-300 text-xs items-center mt-2",children:(0,a.jsx)("div",{className:"h-5 bg-bg-300/30 rounded-md w-24"})})]}):(0,a.jsxs)("button",{className:(0,j.A)("transition-[border] duration-300 w-full p-4 !pt-0 text-text-000 font-ui tracking-tight rounded-xl border shadow-xs overflow-hidden",!E&&"cursor-pointer hover:shadow-sm hover:bg-bg-000/50 hover:border-border-200",c?"!border-accent-secondary-200":"border-border-300"),disabled:E,onClick:I,children:[(0,a.jsx)(W,{title:B,compassStatus:A,useShimmer:T===g.zu.Starting,isError:D||T===g.zu.Failed||T===g.zu.TimedOut,isExpanded:c}),(0,a.jsx)(G,{subtitle:J,compassStatus:A,isError:T===g.zu.Cancelled,useShimmer:!c&&!!A&&![g.zu.CreatingArtifact,g.zu.Completed,g.zu.Cancelled,g.zu.TimedOut,g.zu.Failed].includes(A.status)})]})})}function B(e){let{className:t,text:s,useShimmer:n}=e,[l,r]=(0,w.useState)(s),[o,d]=(0,w.useState)(!1),[c,u]=(0,w.useState)("");return(0,w.useEffect)(()=>{if(s!==l){u(l),r(s),d(!0);let e=setTimeout(()=>{d(!1)},300);return()=>clearTimeout(e)}},[s,l]),(0,a.jsxs)("div",{title:l,className:"jsx-34e91f3cef6c43c9 "+((0,j.A)("relative overflow-hidden",t)||""),children:[(0,a.jsx)(i(),{id:"34e91f3cef6c43c9",children:"@keyframes slideUpFadeOut{0%{transform:translatey(0);opacity:1}100%{transform:translatey(-100%);opacity:0}}@keyframes slideUpFadeIn{0%{transform:translatey(100%);opacity:0}100%{transform:translatey(0);opacity:1}}"}),o&&(0,a.jsx)("div",{style:{animation:"slideUpFadeOut 300ms forwards"},className:"jsx-34e91f3cef6c43c9 absolute w-full text-ellipsis overflow-hidden whitespace-nowrap text-left",children:n?(0,a.jsx)(f.N,{children:c}):c}),(0,a.jsx)("div",{style:o?{animation:"slideUpFadeIn 300ms forwards"}:void 0,className:"jsx-34e91f3cef6c43c9 w-full relative text-ellipsis overflow-hidden whitespace-nowrap text-left",children:n?(0,a.jsx)(f.N,{children:l}):l})]})}function W(e){let{title:t,isError:s,compassStatus:n,useShimmer:i,isExpanded:l}=e,[r,o]=(0,w.useState)(!1),d=(0,F.Nw)(n),c=(0,w.useRef)(d);(0,w.useEffect)(()=>{d&&!c.current&&(o(!0),setTimeout(()=>{o(!1)},3.5*d.length+.5),c.current=d)},[d]);let u=!l&&r;return(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center h-9 gap-4 relative",children:[(0,a.jsxs)("div",{className:"h-9 min-w-0 w-full",children:[u&&!!d&&(0,a.jsx)(b.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:(0,a.jsx)(J,{thought:d})}),(0,a.jsx)(y.N,{initial:!1,children:!(u&&d)&&(0,a.jsxs)(b.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,ease:x.A.inOutQuart},className:(0,j.A)("absolute w-[calc(100%-1.75rem)] top-0 left-0 flex items-center rounded-lg text-sm min-w-0 mt-4",s?"text-danger-000":""),children:[s&&(0,a.jsx)(p.N,{className:"text-danger-000 mr-1 flex-shrink-0",size:16}),(0,a.jsx)("p",{className:"flex-1 overflow-hidden text-left text-ellipsis break-words text-nowrap",children:(0,a.jsx)(B,{text:t,useShimmer:!!i&&!s})})]})})]}),!!n&&(0,a.jsx)(v.K,{size:12,className:"text-text-500 mt-4"})]})}function G(e){var t,s;let{subtitle:n,isError:i,compassStatus:l,useShimmer:r}=e,o=(0,w.useMemo)(()=>(null==l?void 0:l.agents)&&!(l.agents.length<1)?(0,F.mk)({agents:l.agents,n:3}):[],[null==l?void 0:l.agents]);return n?(0,a.jsxs)("div",{className:"flex text-text-300 text-xs items-center mt-2 tabular-nums h-5",children:[!!o.length&&(0,a.jsx)("div",{className:"flex-shrink-0 mr-1",children:(0,a.jsx)(F.mq,{hrefs:o})}),(null==l?void 0:l.status)===g.zu.Completed&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.A,{defaultMessage:"Research complete",id:"9Tbl1w5GjC"}),(0,a.jsx)("span",{className:"text-[0.4rem] mx-1 text-[#A29F95]",children:"•"})]}),(0,a.jsx)(B,{text:n,useShimmer:r,className:i?"text-danger-000":""}),!!(null==l?void 0:l.started_at)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-[0.4rem] mx-1 text-[#A29F95]",children:"•"}),(0,a.jsx)("div",{className:"text-text-500",children:(0,a.jsx)(F.YE,{startedAt:null!=(t=null==l?void 0:l.started_at)?t:null,completedAt:null!=(s=null==l?void 0:l.finished_at)?s:null})})]})]}):null}function J(e){let{thought:t}=e;return(0,a.jsx)("div",{className:"h-9 w-full",children:(0,a.jsx)("div",{className:"blur-[2px] h-11 px-1 -mx-1 -mb-2 w-full relative overflow-y-hidden overflow-x-visible [mask-image:linear-gradient(to_top,_hsl(var(--always-black)/0%)_0%,hsl(var(--always-black)/100%)_75%,_hsl(var(--always-black)/0%)_100%)]",children:(0,a.jsx)(b.P.div,{className:"absolute top-0 left-1 right-0 text-left",initial:{y:40},animate:{y:"calc(-100%)"},transition:{delay:.5,duration:3.5*t.length/1e3,ease:x.A.inOutBase},children:(0,a.jsx)(F.GT,{thought:t})})})})}function H(e){let{tools:t,onCancel:s,onApprove:n}=e,{servers:i}=(0,M.gt)();return(0,a.jsx)(u.aF,{modalSize:"xl",isOpen:!0,onClose:s,title:(0,a.jsx)(k.A,{defaultMessage:"Claude may use the following custom integrations while researching",id:"OKJu4YENMc"}),children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 pt-4",children:[(0,a.jsxs)("div",{className:"border-0.5 border-border-300 rounded-lg my-4 relative",children:[(0,a.jsx)("div",{className:"flex flex-col gap-4 p-4 max-h-[300px] overflow-y-auto",children:i.map(e=>{let s=t.filter(t=>t.server_uuid===e.uuid).map(e=>e.tool_name),n=e.tools.filter(e=>s.includes(e.name));return n.length?n.map(t=>(0,a.jsx)(m.fI,{className:"!py-0",children:(0,a.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,a.jsx)(r.d,{url:e.url,fallbackSvg:(0,a.jsx)(l.B,{letter:e.name,size:30,fontSize:11,className:"shrink-0 font-medium mt-1"}),size:30}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("div",{className:"text-sm font-mono",style:{fontWeight:700},children:t.name}),(0,a.jsx)(D.M,{text:t.description,className:"text-[0.9rem] !text-text-500"})]})]})},t.name)):null})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-2 right-2 h-6 bg-gradient-to-t from-bg-200 to-bg-200/0 pointer-events-none z-10"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 p-4 border border-accent-secondary-900 rounded-lg bg-accent-secondary-900/30",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(p.N,{className:"text-accent-secondary-000",size:16,weight:"bold"}),(0,a.jsx)("h4",{className:"text-accent-secondary-000 font-medium",children:(0,a.jsx)(k.A,{defaultMessage:"You are enabling Claude to retrieve content from your connected apps.",id:"RPQTc1f34V"})})]}),(0,a.jsx)("p",{className:"text-text-300",children:(0,a.jsx)(k.A,{defaultMessage:"Please ensure you have all appropriate permissions and trust these tools before continuing. <link>Learn more</link> about safely using Research with connected apps.",id:"b86SF7HKhH",values:{link:e=>(0,a.jsx)("a",{className:"underline",href:"https://support.anthropic.com/en/articles/11175166-about-custom-integrations-using-remote-mcp",target:"_blank",rel:"noopener noreferrer",children:e})}})})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)(c.$,{variant:"outline",onClick:s,children:(0,a.jsx)(k.A,{defaultMessage:"Cancel Research",id:"GuxgLirKvY"})}),(0,a.jsx)(c.$,{onClick:n,children:(0,a.jsx)(k.A,{defaultMessage:"Research with {count, plural, one {# tool} other {# tools}}",id:"H0wjvrIsuM",values:{count:t.length}})})]})]})})}},77336:(e,t,s)=>{s.d(t,{E:()=>n,V:()=>i});var a=s(7620);function n(e){let t=[];for(let a of e){var s;for(let e of null!=(s=a.files_v2)?s:a.files)"file_kind"in e&&t.push(e)}return t}let i=e=>(0,a.useMemo)(()=>n(e),[e])},79746:(e,t,s)=>{s.d(t,{U:()=>d});var a=s(54568),n=s(41417),i=s(29242),l=s(64786),r=s(90119),o=s(46760);function d(e){let{children:t,disabledReason:s,...d}=e,c=(0,r.V)(l.E_),u=(0,o.A)(),m={defaultMessage:t.props.defaultMessage,id:t.props.id};if(!c)return(0,a.jsx)(i.m,{tooltipContent:s,side:"bottom",children:(0,a.jsx)("div",{children:(0,a.jsx)(n.$,{...d,children:t})})});let f=u.formatMessage(m);return(0,a.jsx)(i.m,{tooltipContent:null!=s?s:f,side:"bottom",children:(0,a.jsx)("div",{children:(0,a.jsx)(n.$,{...d,size:"icon_sm"})})})}},84137:(e,t,s)=>{s.d(t,{CH:()=>b,GT:()=>C,IK:()=>j,Nw:()=>k,OQ:()=>w,Ui:()=>y,YE:()=>M,mk:()=>v,mq:()=>p});var a=s(54568),n=s(7726),i=s(11515),l=s(9946),r=s(77186),o=s(85544),d=s(21036),c=s(32987),u=s(37463),m=s(68864),f=s(7620),x=s(46760),h=s(75006),g=s(57383);function p(e){let{hrefs:t}=e,s=t.map((e,t)=>(0,a.jsx)(u.P.div,{className:(0,c.A)("shadow-xs h-5 w-5 rounded-full overflow-hidden border-0.5 border-border-300 bg-bg-100 flex items-stretch justify-stretch","z-".concat(t+1)),initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.1+.05*t,duration:.3},children:(0,a.jsx)(i.d,{url:e,shouldFillBackground:!0,size:14})},t));return(0,a.jsx)("div",{className:"flex items-center -space-x-2",children:s})}function v(e){let{agents:t,n:s=5}=e,a=new Set;for(let e of t)for(let t of e.annotated_snippets)for(let e of t.tool_calls){var n;if("web_search"===e.tool_name&&(null==(n=e.output)?void 0:n.type)==="rich_content"&&e.output.content.length){for(let t of e.output.content.map(e=>{let{url:t}=e;return t}).filter(Boolean))if("string"==typeof t)try{let e=new URL(t);if(a.add(e.origin),a.size>=s)return Array.from(a).slice(0,s)}catch(e){}}}return Array.from(a)}function j(e,t){let s=!t||t===o.zu.Completed,a=(0,f.useRef)(s),{mutate:i}=(0,n.HF)(e,{refetchOnSettled:!0});(0,f.useEffect)(()=>{s&&!a.current&&i({settings:{compass_mode:null}}),a.current=s},[i,s,e])}function b(e){var t,s;let{organizationUUID:a,conversationUUID:i,taskId:l,isShared:c,enabled:u}=e,[x,h]=(0,f.useState)(!0),[,p]=(0,f.useState)(0),v=(0,d.useDynamicConfig)("use_confused_carousel_sounds").get("polling",[{intervalSeconds:30}]),j=null!=(s=null==(t=v[0])?void 0:t.intervalSeconds)?s:30,[b,y]=(0,f.useState)(j),w=(0,n._W)(i),{setCurrentCompassTask:_}=(0,g.o)(),k=c?"/api/organizations/".concat(a,"/chat_snapshots/").concat(i,"/task/").concat(l,"/status"):"/api/organizations/".concat(a,"/chat_conversations/").concat(i,"/task/").concat(l,"/status"),{data:N,isLoading:M,error:C}=(0,r.Sk)(k,{refetchInterval:!!x&&1e3*b,enabled:!!(u&&i&&a&&l),meta:{noToast:!0}}),A=(null==N?void 0:N.status)!==void 0&&!(0,o.i3)(null==N?void 0:N.status);return(0,f.useEffect)(()=>{if(u&&i&&a&&l)if(A)h(!1),_(void 0),w(),p(0);else if(C){if(!(null==N?void 0:N.started_at))return void h(!1);p(e=>{let t=e+1,s=m.c9.fromISO(N.started_at).plus({hours:3}),a=m.c9.now();return h(t<3&&a<s),t})}else N&&!A&&(p(0),_(l))},[u,l,A,C,w,a,i,N,_]),(0,f.useEffect)(()=>{if(!(null==N?void 0:N.started_at)||!x)return;let e=setInterval(()=>{let e=function(e,t){let s=m.c9.fromISO(e),a=m.c9.now().diff(s,"seconds").seconds;for(let e of t)if(!e.durationSeconds||a<e.durationSeconds)return e.intervalSeconds;return 30}(N.started_at,v);e!==b&&y(e)},1e3*b);return()=>clearInterval(e)},[null==N?void 0:N.started_at,x,v,b]),{compassStatus:N,isLoading:M,error:C,completed:A}}let y=e=>{var t;return null==e||null==(t=e.agents[0])?void 0:t.name};function w(e){let t=(0,x.A)(),s=y(e);return s||(e.status!==o.zu.Completed?t.formatMessage({defaultMessage:"Researching...",id:"eD084+/kcH"}):t.formatMessage({defaultMessage:"Done researching",id:"/ONMTL4lXm"}))}let _=h.z.object({thought:h.z.string()});function k(e){let t=null==e?void 0:e.agents[0];return(0,f.useMemo)(()=>{var e,s,a;let n=null==t||null==(e=t.annotated_snippets[0])?void 0:e.thinking_blocks,i=n&&n.length>0?n[0]:void 0;if(i)return i.thinking;let l=null==t||null==(a=t.annotated_snippets[0])||null==(s=a.tool_calls)?void 0:s.find(e=>"think"===e.tool_name);if(null==l?void 0:l.tool_input)try{let e=JSON.parse(l.tool_input),{data:t}=_.safeParse(e);return null==t?void 0:t.thought}catch(e){return}},[null==t?void 0:t.annotated_snippets])}function N(e){let t=Math.floor(e/1e3),s=Math.floor(t/60),a=Math.floor(s/60);return a>0?"".concat(a,"h ").concat(s%60,"m"):s>0?"".concat(s,"m ").concat(t%60,"s"):t>0?"".concat(t,"s"):"0s"}function M(e){let{startedAt:t,completedAt:s}=e,[n,i]=(0,f.useState)(()=>m.c9.now());if((0,f.useEffect)(()=>{if(!t||s)return;let e=setInterval(()=>{i(m.c9.now())},1e3);return()=>clearInterval(e)},[t,s,i]),!t)return"Starting";let l=m.c9.fromISO(t);if(s){let e=m.c9.fromISO(s).diff(l,"milliseconds").milliseconds;return e<=0?"Starting":(0,a.jsx)(a.Fragment,{children:N(e)})}let r=n.diff(l,"milliseconds").milliseconds;return r<=1e3?"Starting":(0,a.jsx)(a.Fragment,{children:N(r)})}function C(e){let{thought:t,className:s}=e;return t?(0,a.jsx)("div",{className:(0,c.A)("text-text-100 font-claude-response-body",s),children:(0,a.jsx)(l.fP,{text:t})}):null}},88346:(e,t,s)=>{s.d(t,{CV:()=>ea});var a=s(42977),n=s(54568),i=s(68096),l=s(27143),r=s(57067),o=s(98518),d=s(10158),c=s(1761),u=s(51121),m=s(9537),f=s(90510),x=s(43195),h=s(41417),g=s(56370),p=s(24934),v=s(18179),j=s(37076),b=s(29242),y=s(9786),w=s(54890),_=s(91961),k=s(64786),N=s(27062),M=s(90119),C=s(61670),A=s(32987),S=s(49645),z=s(37463),E=s(20591),I=s.n(E),R=s(61773),T=s(27261),U=s.n(T),L=s(7620),F=s(62971),D=s(46760),O=s(22336),P=s(41932),B=s(81527),W=s(92947),G=s(56273),J=s(65755),H=s(42153),V=s(67048),Y=s(7845);function q(){let e=(0,a._)(["\n  border\n  border-border-400\n  bg-bg-100\n  w-96\n  rounded-xl\n  font-medium\n  text-text-300\n  text-sm\n"]);return q=function(){return e},e}function K(e){let t,{onClose:s,onSubmitRating:a,onSubmitNotes:i}=e,l=(0,D.A)(),[r,o]=(0,L.useState)(!1),[d,c]=(0,L.useState)(""),u=e=>{a(e),o(!0)},f=()=>{s()};return t=r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,n.jsx)("div",{className:"ml-1",children:(0,n.jsx)(F.A,{defaultMessage:"What were you trying to accomplish when this artifact was created?",id:"CrrumB/FnI"})}),(0,n.jsx)("div",{className:"pt-1",children:(0,n.jsx)("button",{onClick:f,children:(0,n.jsx)(H.X,{size:20})})})]}),(0,n.jsx)("form",{onSubmit:e=>{e.preventDefault(),i(d),f()},children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("div",{className:"grow",children:(0,n.jsx)(m.ks,{className:"w-full",placeholder:l.formatMessage({defaultMessage:"e.g. make a graph",id:"g1RrFC72N+"}),value:d,onChange:e=>c(e.target.value)})}),(0,n.jsx)("div",{children:(0,n.jsx)(h.$,{variant:"primary",type:"submit",children:(0,n.jsx)(F.A,{defaultMessage:"Send",id:"9WRlF4R2gm"})})})]})})]}):(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(F.A,{defaultMessage:"Is this artifact useful?",id:"RxVIwIW9vn"})}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(h.$,{variant:"ghost",size:"icon_sm",onClick:()=>u(!0),"aria-label":l.formatMessage({defaultMessage:"Thumbs up",id:"0HnZ1ci6be"}),children:(0,n.jsx)(V.t,{size:20})}),(0,n.jsx)(h.$,{variant:"ghost",size:"icon_sm",onClick:()=>u(!1),"aria-label":l.formatMessage({defaultMessage:"Thumbs down",id:"go4L4rFJNq"}),children:(0,n.jsx)(Y.S,{size:20})}),(0,n.jsx)(h.$,{variant:"ghost",size:"icon_sm",onClick:f,"aria-label":l.formatMessage({defaultMessage:"Close",id:"rbrahOGMC3"}),children:(0,n.jsx)(H.X,{size:20})})]})]}),(0,n.jsxs)(X,{children:[(0,n.jsx)("div",{className:"p-3",children:t}),(0,n.jsx)("div",{className:"p-3 border-t border-border-400 w-full font-normal text-xs text-text-500",children:(0,n.jsx)("a",{className:"hover:underline",href:"https://support.anthropic.com/en/articles/9957937-how-does-anthropic-use-submitted-feedback",target:"_blank",children:(0,n.jsx)(F.A,{defaultMessage:"Learn more about how Anthropic uses feedback",id:"NBSES31K7c"})})})]})}let X=f.J.div(q());var Z=s(66849),Q=s(26631);let $=e=>{let{currentArtifact:t,hasMenuOpen:s,setHasMenuOpen:a}=e,i=(0,L.useCallback)(()=>{a(!1)},[a]),{chatResourceState:{artifacts:l},dispatchChatResource:r}=(0,G.i)(),o=Object.values(l).reverse().sort((e,t)=>{let s=e.versions[e.versions.length-1];return new Date(t.versions[t.versions.length-1].created_at).getTime()-new Date(s.created_at).getTime()}),d=(0,L.useRef)(t),c=(0,L.useRef)(!1),u=(0,L.useCallback)(e=>{queueMicrotask(()=>{r({type:"SELECT_ARTIFACT",id:e.id,versionUUID:e.versions[e.versions.length-1].uuid})})},[r]);(0,L.useEffect)(()=>{let e=d.current;return()=>{e&&!c.current&&(null==t?void 0:t.id)!==e.id&&u(e),c.current=!1}},[]);let m=(0,Z.w)(),f=(0,D.A)();return o.length<2?null:(0,n.jsxs)(Q.bL,{open:s,onOpenChange:e=>a(e),children:[(0,n.jsx)(Q.l9,{asChild:!0,children:(0,n.jsx)(h.$,{variant:"ghost",size:"icon_sm",className:"-mx-1",children:(0,n.jsx)(b.m,{side:"right",className:"ml-2",tooltipContent:s?"":f.formatMessage({defaultMessage:"Switch between artifacts",id:"mYiLqlDMdl"}),delayDuration:800,children:(0,n.jsx)(x.zDc,{size:20})})})}),(0,n.jsx)(Q.UC,{align:"start",asChild:!0,children:(0,n.jsx)("ul",{className:"\n            relative\n            z-dropdown\n            overflow-y-auto\n            max-h-[min(var(--radix-dropdown-menu-content-available-height),var(--dropdown-max-height))]\n            flex flex-col gap-1\n            py-2 pr-3\n          ",onMouseLeave:()=>d.current&&u(d.current),children:o.map((e,t)=>{var s;let a=e.type?m[e.type]:null,l=(null==(s=d.current)?void 0:s.id)===e.id,r=f.formatMessage({defaultMessage:"versions",id:"bhuRmwJBaN"}),x=e.versions.length>1?"".concat(e.versions.length):"",h=e.versions.length>1&&a?" \xb7 ":"";return(0,n.jsx)(z.P.li,{initial:{y:-12,opacity:0},animate:{y:0,opacity:1},exit:{opacity:0,transition:{ease:"easeOut",duration:.1,delay:0}},transition:{delay:.035*t,type:"spring",stiffness:285,damping:25,mass:1},role:"none",children:(0,n.jsxs)(Q.q7,{className:(0,A.A)("bg-bg-000 border-0.5 cursor-pointer can-focus","flex flex-col py-2 pl-3 pr-4 w-full max-w-72 mb-px rounded-lg overflow-hidden","text-sm text-left transition duration-300 drop-shadow-[0_2px_8px_hsl(var(--always-black)/5%)]",l?"border-accent-secondary-100 shadow-[0_0_0_1px_hsl(var(--accent-secondary-100))]":"text-text-300 hover:text-text-100 border-border-200 hover:border-accent-secondary-100 focus-within:border-accent-secondary-100 focus-within:text-text-100"),onClick:()=>(e=>{c.current=!0,i();let t=o[e];d.current=t,u(t)})(t),onMouseEnter:()=>{u(e)},"aria-label":"".concat(e.title).concat(a?", ".concat(a):"").concat(x?", ".concat(x," ").concat(r):""),children:[(0,n.jsx)("div",{className:"line-clamp-2",children:e.title}),(0,n.jsxs)("span",{className:"text-text-300",children:[e.versions.length>1?(0,n.jsxs)(n.Fragment,{children:[x," ",r]}):null,h?(0,n.jsx)(n.Fragment,{children:h}):null,a]})]},e.id)},e.id)})})})]})};async function ee(e){if(e.type!==w.vU.Markdown)throw Error("Only markdown artifacts can be saved as PDF");let t=document.getElementById("markdown-artifact");if(!t)throw Error("Markdown artifact element not found");return new Promise((s,a)=>{try{var n;let i=document.head.innerHTML,l=document.createElement("iframe");l.style.position="fixed",l.style.right="0",l.style.bottom="0",l.style.width="0",l.style.height="0",l.style.border="0",l.setAttribute("sandbox","allow-same-origin allow-modals"),l.setAttribute("csp",""),document.body.appendChild(l);let r=l.contentDocument||(null==(n=l.contentWindow)?void 0:n.document);if(!r){document.body.removeChild(l),a(Error("Could not access iframe document"));return}let o=(null==e?void 0:e.title)||"Artifact";r.write("\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <title>".concat(o,"</title>\n            ").concat(i,"\n            <style>\n              /* Remove browser-added headers and footers */\n              @page {\n                size: auto;\n                margin: 0; /* Keep at 0 to remove datetime, page count, website, etc */\n                padding: 25px 0; /* top and bottom page padding */\n              }\n              @media print {\n                html, body, pre, code {\n                  -webkit-print-color-adjust: exact !important;\n                  color-adjust: exact !important;\n                  print-color-adjust: exact !important;\n                }\n              \n                * Smart page breaks */\n                h1, h2, h3 {\n                  page-break-after: avoid !important;\n                }\n                img, pre, table {\n                  page-break-inside: avoid !important;\n                }\n              }\n            </style>\n          </head>\n          <body>\n            ").concat(t.outerHTML,"\n          </body>\n        </html>\n      ")),r.close();let d=document.title,c=()=>{try{document.title=d,document.body.removeChild(l)}catch(e){}};l.onload=()=>{try{var t,n;document.title="".concat((null==e?void 0:e.title)||"Markdown Artifact");try{null==(t=l.contentWindow)||t.print()}catch(e){null==(n=l.contentDocument)||n.execCommand("print")}setTimeout(()=>{c(),s()},100)}catch(e){c(),a(e)}},l.onerror=e=>{c(),a(e)}}catch(e){a(e)}})}function et(){let e=(0,a._)(["\n  flex\n  flex-none\n  items-center\n  justify-between\n  text-sm\n  text-text-500\n  py-2\n  px-2\n  border-t\n  border-border-400\n"]);return et=function(){return e},e}function es(){let e=(0,a._)(["\n  border-border-400\n  sticky\n  flex\n  items-center\n  gap-1\n  border-b\n  px-2\n  py-2\n"]);return es=function(){return e},e}let ea=e=>{var t,s,a,d,u,m,f,x,h,g;let{onClose:p,artifact:v,isStreaming:j,selectedArtifactMessageUUID:b,selectedArtifactVersionUUID:y,setSelectedArtifactVersionUUID:_,projectUuid:k,selectDoc:M,disablePublishing:E,sendMessage:I,richSandboxCapabilities:R,isOpen:T,isTemporary:U=!1}=e,{account:F}=(0,c.YL)(),D=(0,o.st)(),{servers:P}=(0,W.gt)(),[J,H]=(0,L.useState)("normal"),V=(0,L.useRef)(null),Y=(0,c.mV)(),[q,X]=(0,L.useState)(!0),{value:Z}=(0,N.fS)("publish_artifacts"),{data:Q}=(0,B.fo)(k),$=!E&&Z&&!Y,[ee,{open:et,close:es}]=(0,C.j)(!1),ea=(0,L.useCallback)(()=>{X(!1)},[]),{data:ei}=(0,O.rC)({includeDeletedArtifacts:!0}),eo=j&&!(null==v||null==(t=v.versions[v.versions.length-1])?void 0:t.isClosed),ed=(0,L.useMemo)(()=>{if(!v)return 0;if(!eo&&y&&b!==r.gv){let e=v.versions.findIndex(e=>e.uuid===y);if(-1!==e)return e}return!eo&&b&&b!==r.gv?v.versions.findIndex(e=>e.message===b):v.versions.length-1},[b,y,eo,v]),{value:ec}=(0,N.fS)("apps_artifacts_sh"),eu=null==v||null==(s=v.versions[ed])?void 0:s.uuid;(0,L.useEffect)(()=>{eu&&eu!==y&&_(eu),H("normal")},[null==v?void 0:v.id,eu,_,y]);let em=ec&&Y&&!U,[ef,{open:ex,close:eh}]=(0,C.j)(!1),eg=v&&(null==ei||null==(a=ei.find(e=>{let{artifact_identifier:t,message_uuid:s}=e;return t===v.id&&s===v.versions[ed].message}))?void 0:a.published_artifact_uuid),ep=null!=(f=null==ei?void 0:ei.some(e=>{let{published_artifact_uuid:t,deleted:s}=e;return t===eg&&s}))&&f,ev=null==v||null==(d=v.versions[ed])?void 0:d.message,[ej,eb]=(0,L.useState)(!1);(0,L.useEffect)(()=>eb(ej||j),[ej,j]);let[ey,ew]=(0,L.useState)(!1);(0,L.useEffect)(()=>ew(!1),[b,ev]);let[e_,ek]=(0,L.useState)(!1),{data:eN}=(0,O.SN)(),{mutate:eM}=(0,i.Jy)(),{track:eC}=(0,o.st)(),eA=null!=(x=(0,G.i)().chatResourceState.conversationUUID)?x:"",{mutateAsync:eS}=(0,O._2)(eA),ez=(0,L.useCallback)(async()=>{if(!y)try{var e;let{artifactVersionUUID:t}=await eS({version_index:ed,artifact_identifier:null!=(e=null==v?void 0:v.id)?e:""});_(t)}catch(e){console.error("Error getting artifact UUID: ".concat(e));return}eC({event_key:"artifact.share_button_clicked",message_uuid:ev,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),ex()},[y,ex,eS,ed,null==v?void 0:v.id,_,eC,ev,null==v?void 0:v.type,null==v?void 0:v.language]),eE=(0,L.useCallback)(()=>{eC({event_key:"artifact.publish_button_clicked",message_uuid:ev,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),et()},[et,eC,ev,null==v?void 0:v.type,null==v?void 0:v.language]),eI=(null==v?void 0:v.type)===w.vU.Text,eR=(null==v?void 0:v.type)===w.vU.Markdown||(null==v?void 0:v.type)===w.vU.Code,eT=(null==v?void 0:v.type)===w.vU.Html||(null==v?void 0:v.type)===w.vU.React,eU=(null==v?void 0:v.type)!==w.vU.Text&&!(eo&&((null==v?void 0:v.type)===w.vU.Svg||(null==v?void 0:v.type)===w.vU.Mermaid||(null==v?void 0:v.type)===w.vU.React||(null==v?void 0:v.type)===w.vU.Html)),eL=!eU||"raw"===J,eF=ey||ej&&!j&&!e_&&!(null==F?void 0:F.settings.dismissed_artifact_feedback_form)&&eN,eD=null!=(h=null==v?void 0:v.versions.length)?h:0,[eO,eP]=(0,L.useState)(!1),eB=k&&v?{show:!eo&&!(null==Q?void 0:Q.is_starter_project),artifact:v,projectUuid:k,selectedVersion:ed,selectDoc:M}:void 0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:(0,A.A)(v?"bg-bg-000 flex h-full flex-col relative":"absolute opacity-0 w-0 h-0 overflow-hidden pointer-events-none"),onClick:()=>eO&&eP(!1),children:[(0,n.jsx)(en,{versionCount:eD,selectedVersion:ed,artifact:v,canRenderNormal:eU,canOnlyRenderRaw:eI,canOnlyRenderNormal:eR,viewing:J,setViewing:H,showRaw:eL,canRefresh:eT,isSandboxLoading:q,handleRefresh:()=>{X(!0),V.current&&V.current.refresh()},canShare:em,handleOpenShareModal:ez,isStreaming:j,onClose:p,hasMenuOpen:eO,setHasMenuOpen:eP,canPublish:$,wasUnpublished:ep,publishedArtifactUuid:eg,openPublishModal:eE,projectParams:eB,richSandboxRef:V,handleVersionSelect:e=>{let t=null==v?void 0:v.versions[e].uuid;t&&_(t)}}),(0,n.jsx)(l.k,{isOpen:T,content:null!=(g=null==v||null==(u=v.versions[ed])?void 0:u.resultState)?g:"",type:null==v?void 0:v.type,citations:null==v||null==(m=v.versions[ed])?void 0:m.citations,language:void 0===v?void 0:v.language||w.K5[v.type].syntaxName,showRaw:eL,richSandboxRef:V,isCurrentStreaming:eo,isChatStreaming:j,onSandboxConfirmation:ea,sendMessage:I,richSandboxCapabilities:R,isLatestVersion:!!v&&ed===v.versions.length-1,artifactId:null==v?void 0:v.id,artifactVersion:ed,onArtifactRuntimeError:e=>{D.track({event_key:"claudeai.artifacts.execution.error",artifact_version_uuid:null==y?void 0:y.toString(),error_type:e.type,source:null==v?void 0:v.versions[ed].source})},artifact:v,hasMenuOpen:eO,mcpServers:P}),(0,n.jsx)(S.N,{children:eF&&(0,n.jsx)(z.P.div,{initial:{opacity:0,y:20,x:"-50%"},animate:{opacity:1,y:0,x:"-50%"},transition:{duration:.3,delay:.8,ease:"easeOut"},exit:{opacity:0,y:20,x:"-50%",transition:{duration:.3,ease:"easeOut"}},className:"absolute bottom-20 left-1/2",children:(0,n.jsx)("div",{children:(0,n.jsx)(K,{onSubmitNotes:e=>{eC({event_key:"artifact.feedback.note",note:e,message_uuid:ev,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),ew(!1)},onSubmitRating:e=>{eC({event_key:"artifact.feedback.sentiment",type:e?"thumbs_up":"thumbs_down",message_uuid:ev,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),eM({...null==F?void 0:F.settings,dismissed_artifact_feedback_form:!0}),ew(!0)},onClose:()=>{ek(!0),eM({...null==F?void 0:F.settings,dismissed_artifact_feedback_form:!0}),ew(!1)}})})})})]}),(null==v?void 0:v.versions[ed])&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(er,{messageUuid:v.versions[ed].message,isOpen:ee&&!ep,onClose:es,artifact:v,selectedVersion:ed,publishedArtifactUuid:eg,richSandboxRef:V}),em&&y&&(0,n.jsx)(el,{isOpen:ef,onClose:eh,artifactVersionUuid:y,artifact:v,messageUuid:v.versions[ed].message,isProjectArtifact:!!(null==Q?void 0:Q.is_private)})]})]})};function en(e){var t;let{versionCount:s,selectedVersion:a,artifact:i,canRenderNormal:l,canOnlyRenderRaw:r,canOnlyRenderNormal:o,viewing:d,setViewing:c,showRaw:f,canRefresh:j,isSandboxLoading:_,handleRefresh:N,canShare:C,handleOpenShareModal:S,isStreaming:z,canPublish:E,wasUnpublished:R,publishedArtifactUuid:T,projectParams:U,onClose:O,openPublishModal:B,handleVersionSelect:W,hasMenuOpen:G,setHasMenuOpen:H,richSandboxRef:V}=e,Y=(0,D.A)(),q=(0,M.V)(k.E_),{copyToClipboard:K,didCopy:X}=(0,y.C)(),{copyToProject:Z,isCopiedToProject:Q}=function(e){let{projectUuid:t,artifact:s,selectedVersion:a}=e,[i,l]=(0,L.useState)(!1),{mutateAsync:r,data:o}=(0,P.fh)(null!=t?t:""),{addError:d}=(0,u.Y)();return(0,L.useEffect)(()=>{if(null==o?void 0:o.uuid){l(!0);let e=setTimeout(()=>{l(!1)},12e3);return()=>clearTimeout(e)}},[o]),{copyToProject:async()=>{if(s)try{var e;await r({file_name:"".concat(s.title,".").concat(w.K5[s.type].extension()),content:null!=(e=s.versions[a].resultState)?e:""})}catch(e){d((0,n.jsx)(F.A,{defaultMessage:"Error adding artifact to project: {error}",id:"sSg3OiDDja",values:{error:e}}))}},isCopiedToProject:i}}({artifact:i,projectUuid:null!=(t=null==U?void 0:U.projectUuid)?t:"",selectedVersion:a});async function et(){var e,t;if(!i)return;let s=i.type===w.vU.Markdown,n=i.type===w.vU.React,l=null!=(e=i.versions[a].resultState)?e:"";if(n&&V.current){let e=await (null==(t=V.current)?void 0:t.copyHtmlContent());e?await K({text:e,html:e}):await K(l)}else if(s)try{let e=(0,J.u)(l);await K({text:l,html:e})}catch(e){await K(l)}else await K(l)}let{ref:es,width:ea}=function(){let e=(0,L.useRef)(null),[t,s]=(0,L.useState)(()=>{var t,s;return null!=(s=null==(t=e.current)?void 0:t.offsetWidth)?s:null});return(0,L.useEffect)(()=>{let t=I()(()=>{e.current&&s(e.current.offsetWidth)},20,{leading:!0,trailing:!0}),a=new ResizeObserver(t);if(e.current){let s=e.current;return t(),a.observe(s),()=>a.disconnect()}},[]),{ref:e,width:t}}(),en=ea&&ea<480,el=!f&&j,{addError:er}=(0,u.Y)(),eo=(null==i?void 0:i.type)===w.vU.Markdown&&"raw"!==d?(0,n.jsx)(g.tJ,{onSelect:async()=>{try{await ee(i)}catch(e){er((0,n.jsx)(F.A,{defaultMessage:"Error saving as PDF",id:"kemaiSh7+2"}))}},children:(0,n.jsx)(F.A,{defaultMessage:"Save as PDF",id:"rv9NrWszM1"})},"saveAsPdf"):null,ed=i?(0,n.jsx)(g.tJ,{asChild:!0,"data-testid":"export-download",children:(0,n.jsx)(ei,{artifact:i,selectedVersion:a})},"download"):null;return(0,n.jsxs)("div",{ref:es,className:(0,A.A)("pr-2 pl-3 flex items-center justify-between gap-2 select-none",q?[k.X_,k.zo,"draggable"]:"py-2"),children:[i&&(0,n.jsx)($,{currentArtifact:i,hasMenuOpen:G,setHasMenuOpen:H}),G?(0,n.jsxs)("div",{className:"flex justify-between items-center flex-1 text-sm text-text-300 pl-1",children:[(0,n.jsx)(F.A,{defaultMessage:"Switch between artifacts",id:"mYiLqlDMdl"}),!f&&el&&_?(0,n.jsx)("div",{className:"flex h-8 w-8 items-center justify-center",children:(0,n.jsx)(v.Loading,{size:"sm"})}):null]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center flex-1 gap-2",children:[!(!l||r||o)&&(0,n.jsx)(m.Iz,{options:[{key:"normal",label:(0,n.jsx)(x.kU3,{size:16}),ariaLabel:Y.formatMessage({defaultMessage:"Preview",id:"TJo5E6JuIN"})},{key:"code",label:(0,n.jsx)(x.CyN,{size:16}),ariaLabel:Y.formatMessage({defaultMessage:"Code",id:"h2vipunVVd"})}],initialKey:"normal"===d?"normal":"code",onSelect:e=>{c("normal"===e?"normal":"raw")},itemClassName:"!px-1"},"normal"===d?"normal":"code"),s>1?(0,n.jsx)(g.ms,{align:"start",trigger:(0,n.jsxs)(h.$,{variant:"ghost",size:"sm",className:"group !text-text-000 gap-1 justify-between !pl-1.5 !pr-1 !text-sm","data-testid":"artifact-version-trigger",children:["v",a+1,en||a!==s-1?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"∙"}),(0,n.jsx)(F.A,{defaultMessage:"Latest",id:"adThp5MDl0"})]}),(0,n.jsx)(x.biH,{size:16,className:"opacity-0 group-hover:opacity-100 group-[&[data-state=open]]:opacity-100"})]}),children:Array.from({length:s}).map((e,t)=>s-t).map(e=>(0,n.jsxs)(g.tJ,{"data-testid":"version-dropdown",className:"flex justify-between",onSelect:()=>W(e-1),children:[(0,n.jsx)(F.A,{defaultMessage:"Version {versionNum}",id:"iMMX+ZCJ/I",values:{versionNum:e}}),e===s?(0,n.jsxs)(n.Fragment,{children:[" - ",(0,n.jsx)(F.A,{defaultMessage:"Latest",id:"adThp5MDl0"})]}):null,e-1===a?(0,n.jsx)(x.Jlk,{className:"text-accent-secondary-100",size:16}):null]},e))}):null]}),(0,n.jsxs)("div",{className:(0,A.A)("flex gap-2 items-center text-sm"),children:[en?(0,n.jsxs)(g.ms,{align:"end",trigger:(0,n.jsx)(h.$,{variant:"ghost",size:"unset",className:"!text-text-000 !shrink gap-1 !px-1 !py-0.5 text-sm","data-testid":"artifact-menu-trigger","aria-label":Y.formatMessage({defaultMessage:"More options for artifact",id:"O91Ji7GVP2"}),children:(0,n.jsx)(x.txq,{size:16})}),children:[el&&(0,n.jsx)(g.tJ,{disabled:_,onSelect:N,children:(0,n.jsx)(F.A,{defaultMessage:"Refresh",id:"rELDbByu8U"})},"refresh"),(0,n.jsx)(g.tJ,{onSelect:et,children:(0,n.jsx)(F.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})},"copy"),C?(0,n.jsx)(g.tJ,{onSelect:S,children:(0,n.jsx)(F.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})},"share"):null,R?(0,n.jsx)(g.tJ,{disabled:!0,onSelect:B,children:(0,n.jsx)(F.A,{defaultMessage:"Unpublished",id:"wbU4tD+0G+"})},"unpublished"):E?(0,n.jsx)(g.tJ,{onSelect:B,children:(0,n.jsx)(F.A,{defaultMessage:"Publish",id:"syEQFEKfku"})},"publish"):null,ed,eo]}):(()=>{let e=!f&&el&&(_?(0,n.jsx)("div",{className:"flex h-8 w-8 items-center justify-center",children:(0,n.jsx)(v.Loading,{size:"sm"})}):(0,n.jsx)(h.$,{variant:"ghost",size:"icon_sm",onClick:N,children:(0,n.jsx)(x.MvQ,{size:16})})),t=C&&(0,n.jsx)(h.$,{onClick:S,variant:"primary",size:"sm",disabled:z,prepend:(0,n.jsx)(x.SYj,{size:16,className:"mr-0.5"}),children:(0,n.jsx)("span",{className:"text-sm",children:(0,n.jsx)(F.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})})}),s=E&&(0,n.jsx)(b.m,{open:!!R&&void 0,tooltipContent:(0,n.jsx)(F.A,{defaultMessage:"This artifact was previously unpublished. Create a new artifact to publish again.",id:"173M62fqu+"}),children:(0,n.jsx)(h.$,{onClick:B,variant:"primary",size:"sm",disabled:R||z,prepend:(0,n.jsx)(x.SYj,{size:16}),className:(0,A.A)("font-medium !text-sm",R&&"!pointer-events-auto"),children:void 0===T||R?(0,n.jsx)(F.A,{defaultMessage:"Publish",id:"syEQFEKfku"}):(0,n.jsx)(F.A,{defaultMessage:"Published",id:"w7tf2zwi6+"})})}),a=(0,n.jsxs)(p.g,{align:"end",defaultButtonLabel:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:(0,A.A)(X?"invisible":""),children:(0,n.jsx)(F.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})}),X?(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)(x.Jlk,{size:16})}):null]}),onClickDefaultButton:et,children:[(null==U?void 0:U.show)?Q?(0,n.jsx)(g.tJ,{disabled:!0,children:(0,n.jsx)(F.A,{defaultMessage:"Copied to project",id:"KYVs6Ta+VU"})},"added-to-project"):(0,n.jsx)(g.tJ,{onSelect:Z,children:(0,n.jsx)(F.A,{defaultMessage:"Copy to project",id:"Xmf/Sp7n9T"})},"add-to-project"):null,ed,eo]});return(0,n.jsxs)(n.Fragment,{children:[e,a,t,s]})})(),(0,n.jsx)(h.$,{variant:"ghost",size:"icon_sm",onClick:O,children:(0,n.jsx)(x.X,{size:16})})]})]})]})}function ei(e){let{artifact:t,selectedVersion:s}=e,{downloadUrl:a,filename:i}=((e,t)=>{let[s,a]=(0,L.useState)(""),[n,i]=(0,L.useState)("");return(0,L.useEffect)(()=>{var s;let n=null!=(s=e.versions[t].resultState)?s:"",l=(0,w.eg)(e),r=new Blob([n],{type:"text/plain"}),o=URL.createObjectURL(r);return a(o),i("".concat(e.id,".").concat(l)),()=>{URL.revokeObjectURL(o)}},[e,t]),{downloadUrl:s,filename:n}})(t,s),l=function(e){switch(e.type){case w.vU.Markdown:return"Markdown";case w.vU.Html:return"HTML";case w.vU.React:return"TSX";case w.vU.Svg:return"SVG";case w.vU.Text:return"TXT";case w.vU.Mermaid:return"Mermaid";case w.vU.Code:var t;return null!=(t=w.K5[e.type].extension(e))?t:null;default:return null}}(t);return(0,n.jsx)("a",{href:a,download:i,className:"py-1 px-2 rounded-md cursor-pointer whitespace-nowrap overflow-hidden grid grid-cols-[minmax(0,_1fr)_auto] gap-2 hover:bg-bg-200 hover:text-text-000",children:l?(0,n.jsx)(F.A,{defaultMessage:"Download as {fileType}",values:{fileType:l},id:"PJh4v0uaV6"}):(0,n.jsx)(F.A,{defaultMessage:"Download file",id:"k9qHCCLPA5"})})}f.J.div(et()),f.J.div(es());let el=e=>{let{onClose:t,isOpen:s,artifactVersionUuid:a,artifact:i,messageUuid:l,isProjectArtifact:r}=e,d=(0,D.A)(),{track:c}=(0,o.st)(),{mutateAsync:u,isPending:m}=(0,O.yE)(a),{data:f,isLoading:g}=(0,O.EC)(a),p=(null==f?void 0:f.visibility)==="shared",v=m||g,[b,w]=(0,L.useState)("");(0,L.useEffect)(()=>{if(""===b)return;let e=setTimeout(()=>w(""),5e3);return()=>clearTimeout(e)},[b]);let _="".concat(window.location.origin,"/artifacts/").concat(a),{copyToClipboard:k,didCopy:N}=(0,y.C)(),M=v?"loading":p?"shared":"private",C=(0,L.useRef)(M);C.current!==M&&("loading"!==C.current&&"private"===M&&w(d.formatMessage({defaultMessage:"Artifact no longer shared",id:"5AFOwOoFPe"})),C.current=M);let A=e=>{"private"===e&&p&&u({visibility:"private"}).then(()=>t()),"shared"!==e||p||u({visibility:"shared"}).then(()=>k(_))};return(0,n.jsx)(j.aF,{title:(0,n.jsx)("span",{className:"text-text-200 font-claude-response text-xl font-medium",children:p?(0,n.jsx)(F.A,{defaultMessage:"Artifact shared",id:"0TqmonlxQo"}):(0,n.jsx)(F.A,{defaultMessage:"Share artifact",id:"FeSSOL+/49"})}),isOpen:s,onClose:t,modalSize:"lg",hasCloseButton:!0,children:(0,n.jsxs)("div",{className:"mt-1 flex flex-col gap-2.5",children:[p&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col rounded-xl",children:[(0,n.jsxs)("div",{className:"border-b-0.5 border-border-300 flex gap-3 py-3 pl-3 pr-5",children:[(0,n.jsx)("div",{children:(0,n.jsx)(x.qzq,{className:"mt-1",size:16})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h6",{className:"font-medium",children:(0,n.jsx)(F.A,{defaultMessage:"Shared",id:"kWI6zXRaHY"})}),(0,n.jsx)("p",{className:"text-text-300 tracking-tight",children:r?(0,n.jsx)(F.A,{defaultMessage:"Anyone who has access to this project can view this artifact and its associated attachments and files.",id:"fxjJJNetIb"}):(0,n.jsx)(F.A,{defaultMessage:"Anyone in your organization can view this artifact and its associated attachments and files.",id:"P+skcC6AMa"})})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3 py-3 pl-3 pr-5",children:[(0,n.jsx)(U(),{className:"text-text-300 truncate text-sm",href:_,children:_}),(0,n.jsx)(h.$,{variant:"ghost",className:"!text-accent-secondary-000 hover:bg-accent-secondary-900 font-medium",onClick:()=>{k(_)},prepend:N?(0,n.jsx)(x.rAV,{size:16}):(0,n.jsx)(x.Xq1,{size:16}),children:N?(0,n.jsx)(F.A,{defaultMessage:"Link copied",id:"zU/q1NoIdN"}):(0,n.jsx)(F.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})})]})]}),(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)(h.$,{size:"lg",variant:"secondary",loading:v,onClick:()=>A("private"),children:(0,n.jsx)(F.A,{defaultMessage:"Unshare",id:"bEq+NWNIXF"})})})]}),!p&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-text-400 flex flex-col gap-3 py-3",children:r?(0,n.jsxs)("p",{className:"bg-bg-300 text-text-300 flex gap-2 rounded-xl p-3 text-sm",children:[(0,n.jsx)(x.R2D,{size:16,className:"mt-0.5 shrink-0"}),(0,n.jsx)(F.A,{defaultMessage:"This artifact was created in a private project. Anyone in your organization who has access to this project will be able to view this artifact.",id:"g6r4HATHuW"})]}):(0,n.jsx)("p",{children:(0,n.jsx)(F.A,{defaultMessage:"Anyone in your organization can view this artifact. It also has access to attachments and files in the conversation.",id:"AnqiBApCMX"})})}),(0,n.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex gap-3 rounded-xl py-3 pl-3 pr-5",children:[(0,n.jsx)(x.c_I,{className:"mt-0.5",size:16}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h6",{className:"font-medium",children:(0,n.jsx)(F.A,{defaultMessage:"Unshared",id:"0r/9ANkloS"})}),(0,n.jsx)("p",{className:"text-text tracking-tight-300",children:(0,n.jsx)(F.A,{defaultMessage:"Only you have access",id:"U+7IIlpC6m"})})]})]}),(0,n.jsx)("div",{className:"mt-3 flex w-full items-center justify-end gap-2",children:(0,n.jsx)(h.$,{size:"lg",loading:v,onClick:()=>{A("shared"),c({event_key:"artifact.share.modal.share_button_clicked",message_uuid:l,artifact_type:i.type,artifact_language:i.language})},children:(0,n.jsx)(F.A,{defaultMessage:"Share & copy link",id:"E7GQdF/HSA"})})})]})]})})},er=e=>{var t;let{onClose:s,isOpen:a,artifact:i,selectedVersion:l,messageUuid:r,publishedArtifactUuid:c,richSandboxRef:u}=e,m=(0,D.A)(),{track:f}=(0,o.st)(),{mutateAsync:g,isPending:p}=(0,O.yx)(),{publishedArtifactsBaseUrl:v}=(0,d._r)(),[b,w]=(0,L.useState)(),_=!!c,{mutateAsync:k,isPending:N}=(0,O.lT)(c),{data:M,isSuccess:C}=(0,O.gY)(c),{mutateAsync:A,isPending:S}=(0,O.eH)(c),z=p||N||S,[E,I]=(0,L.useState)(""),[T,P]=(0,L.useState)(!1),B=E.split(/[\n,]/).map(e=>e.trim().toLowerCase()).filter(e=>e.length>0);(0,L.useEffect)(()=>{if(C&&M){var e,t;I(null!=(t=null==(e=M.embed_whitelist)?void 0:e.join("\n"))?t:"")}},[C,M]);let[W,G]=(0,L.useState)("");(0,L.useEffect)(()=>{if(""===W)return;let e=setTimeout(()=>G(""),5e3);return()=>clearTimeout(e)},[W]);let J="".concat(v,"/public/artifacts/").concat(c),{copyToClipboard:H,didCopy:V}=(0,y.C)(),Y=z?"loading":_?"shared":"private",q=(0,L.useRef)(Y),K=(0,L.useCallback)(async()=>{var e;let t=await (null==(e=u.current)?void 0:e.getScreenshot());t&&w(t)},[u]);(0,L.useEffect)(()=>{a&&u.current&&K()},[u,a,K]),q.current!==Y&&("loading"!==q.current&&"private"===Y&&G(m.formatMessage({defaultMessage:"Artifact no longer published",id:"2ERgiFTuIj"})),q.current=Y);let X=e=>{if("private"===e&&_&&k({}).then(()=>s()),"shared"===e&&!_){var t;g({title:i.title,artifact_type:i.type,code_language:i.language,message_uuid:r,artifact_identifier:i.id,content:null!=(t=i.versions[l].resultState)?t:"",screenshot:b,artifact_version_uuid:i.versions[l].uuid,embed_whitelist:B.length>0?B:void 0}).then(e=>{let{published_artifact_uuid:t}=e;return H("".concat(v,"/public/artifacts/").concat(t))})}};return(0,n.jsx)(j.aF,{title:(0,n.jsx)("span",{className:"text-text-200 font-claude-response text-xl font-medium",children:_?(0,n.jsx)(F.A,{defaultMessage:"Artifact published",id:"ykyvCB8a6W"}):(0,n.jsx)(F.A,{defaultMessage:"Publish artifact",id:"D1fyBhklj/"})}),isOpen:a,onClose:s,modalSize:"lg",hasCloseButton:!0,children:(0,n.jsxs)("div",{className:"mt-1 flex flex-col gap-2.5",children:[W&&(0,n.jsx)("div",{className:"bg-accent-secondary-900 text-accent-secondary-000 rounded-lg px-3 py-2 text-sm",children:W}),_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col rounded-xl",children:[(0,n.jsxs)("div",{className:"border-b-0.5 border-border-300 flex gap-3 py-3 pl-3 pr-5",children:[(0,n.jsx)("div",{children:(0,n.jsx)(x.qzq,{className:"mt-1",size:16})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h6",{className:"font-medium",children:(0,n.jsx)(F.A,{defaultMessage:"Published (Public)",id:"7G+T0FbG5h"})}),(0,n.jsx)("p",{className:"text-text-300 tracking-tight",children:(0,n.jsx)(F.A,{defaultMessage:"Anyone on the web with the link can view the Artifact only. Your chat will remain private.",id:"lJBHtZSUCz"})})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3 py-3 pl-3 pr-5",children:[(0,n.jsx)(U(),{className:"text-text-300 truncate text-sm",href:J,children:J}),(0,n.jsx)(h.$,{variant:"ghost",className:"!text-accent-secondary-000 hover:bg-accent-secondary-900 font-medium",onClick:()=>{H(J)},prepend:V?(0,n.jsx)(x.rAV,{size:16}):(0,n.jsx)(x.Xq1,{size:16}),children:V?(0,n.jsx)(F.A,{defaultMessage:"Link copied",id:"zU/q1NoIdN"}):(0,n.jsx)(F.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})})]})]}),"",(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(h.$,{size:"lg",variant:"secondary",loading:z,onClick:()=>X("private"),children:(0,n.jsx)(F.A,{defaultMessage:"Unpublish",id:"VjZ6FKc+ZZ"})}),(0,n.jsxs)("p",{className:"text-text-400 text-xs tracking-tight",children:[(0,n.jsx)(F.A,{defaultMessage:"Once Artifact is unpublished, it cannot be republished.",id:"HKGP87Xpbb"}),(0,n.jsx)("br",{}),(0,n.jsx)(F.A,{defaultMessage:"A new Artifact must be created.",id:"vWfM4LMkFW"})]})]})]}),!_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-text-400 flex flex-col gap-3 py-3",children:(0,n.jsx)("p",{children:(0,n.jsx)(F.A,{defaultMessage:"Publishing this Artifact will make it accessible to anyone on the internet and potentially visible in search engine results. Your chat will remain private.",id:"zG4O5rdNXZ"})})}),(0,n.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col sm:flex-row gap-4 rounded-xl py-3 pl-3 pr-5 items-center",children:[(0,n.jsxs)("div",{className:"relative group w-[160px] h-[84px]",children:[(0,n.jsxs)("div",{className:"rounded-lg overflow-hidden shrink-0 relative w-full h-full",children:[b?(0,n.jsx)("img",{src:b,alt:i.title,className:"w-full h-auto bg-always-white"}):(0,n.jsx)(R.default,{src:"/images/claude_ogimage.png",alt:i.title,className:"w-full h-auto",width:1138,height:640}),!b&&(0,n.jsx)(ed,{handleCapture:()=>void K()})]}),b&&(0,n.jsx)("div",{className:"absolute top-0 right-0 translate-x-1/4 -translate-y-1/4 hidden group-hover:block",children:(0,n.jsx)(eo,{handleRemove:()=>w(void 0)})})]}),(0,n.jsx)("div",{children:null!=(t=i.title)?t:(0,n.jsx)(F.A,{defaultMessage:"Claude Artifact",id:"l6aMQuX1m4"})})]}),"",(0,n.jsxs)("div",{className:"bg-bg-300 text-text-300 mt-3 flex gap-3 rounded-xl px-4 py-3 text-sm leading-normal",children:[(0,n.jsx)(x.R2D,{size:16,className:"mt-0.5 shrink-0"}),(0,n.jsx)("span",{children:(0,n.jsx)(F.A,{defaultMessage:"Anthropic’s <link>Usage Policy</link> prohibits use of Claude for harmful use cases like producing violent, abusive, or deceptive content. Don’t share personal information or third-party content without permission.",id:"3BDMxIIlWR",values:{link:e=>(0,n.jsx)(U(),{href:"https://www.anthropic.com/legal/aup",target:"_blank",className:"underline",children:e})}})})]}),(0,n.jsx)("div",{className:"mt-3 flex w-full items-center justify-end gap-2",children:(0,n.jsx)(h.$,{size:"lg",loading:z,onClick:()=>{X("shared"),f({event_key:"artifact.publish.modal.publish_button_clicked",message_uuid:r,artifact_type:null==i?void 0:i.type,artifact_language:null==i?void 0:i.language})},children:(0,n.jsx)(F.A,{defaultMessage:"Publish & copy link",id:"q8Svey6avC"})})})]})]})})},eo=e=>{let{handleRemove:t}=e;return(0,n.jsx)(b.m,{tooltipContent:(0,n.jsx)(F.A,{defaultMessage:"Remove",id:"G/yZLul6P1"}),side:"bottom",children:(0,n.jsx)("button",{className:(0,A.A)("transition-all hover:bg-bg-000/50 text-text-500 hover:text-text-200 w-5 h-5 rounded-full border-0.5 border-border-300/25 bg-bg-000/90 backdrop-blur-sm flex items-center justify-center",(0,_.Fr)()&&"!opacity-100 !bg-bg-000/50"),onClick:e=>{e.stopPropagation(),e.preventDefault(),t()},children:(0,n.jsx)(x.X,{size:12})})})},ed=e=>{let{handleCapture:t}=e;return(0,n.jsx)("div",{className:"absolute inset-0 items-center justify-center bg-accent-main-900/20 hidden group-hover:flex",children:(0,n.jsx)(b.m,{tooltipContent:(0,n.jsx)(F.A,{defaultMessage:"Capture screenshot",id:"4aPgLNzYUy"}),side:"right",children:(0,n.jsx)(h.$,{variant:"secondary",size:"icon",onClick:t,className:"!bg-bg-100",children:(0,n.jsx)(x.i7d,{})})})})}},89436:(e,t,s)=>{s.d(t,{t:()=>l});var a=s(54568),n=s(1761),i=s(62971);function l(e){let t,{project:s,className:l}=e,{account:r}=(0,n.YL)();if(s.is_starter_project)t=(0,a.jsx)(i.A,{defaultMessage:"Created by Anthropic",id:"qWDgsCW3nw"});else{var o;if(null==(o=s.creator)?void 0:o.full_name){let e=s.creator.uuid===(null==r?void 0:r.uuid)?"You":s.creator.full_name;t=(0,a.jsx)(i.A,{defaultMessage:"Created by {author}",id:"7POMfMfi+y",values:{author:e}})}else t=(0,a.jsx)(i.A,{defaultMessage:"Created by unknown",id:"QEI1plMxfE"})}return(0,a.jsx)("span",{className:l,children:t})}},94748:(e,t,s)=>{s.d(t,{NG:()=>x,aX:()=>h,sH:()=>g});var a=s(54568),n=s(43195),i=s(64359),l=s(37711),r=s(29242),o=s(98769),d=s(32987),c=s(37463),u=s(7620),m=s(33792),f=s(11480);let x=e=>{let{isExpanded:t,isScrollable:s,snappyTransition:n,children:l,className:r,onTransitionEnd:m,collapsesHalfway:f,setIsExpanded:x,footer:h}=e,g=(0,u.useRef)(t),p=!!(f&&!t&&x),v=f&&!t;return(0,a.jsxs)(c.P.div,{className:(0,d.A)("overflow-hidden shrink-0",!t&&p&&"cursor-pointer"),tabIndex:-1,initial:{opacity:0,height:g.current?"auto":0},animate:t?"expanded":"collapsed",variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:.6*!!f,height:72*!!f}},whileHover:{opacity:1},transition:n?{ease:o.A.snappyOut,duration:.4}:{ease:"easeInOut",duration:.4},onTransitionEnd:m,onClick:p?()=>x(!0):void 0,children:[(0,a.jsx)(i.r,{gradientHeight:16,tabIndex:-1,style:{scrollbarGutter:"stable"},className:(0,d.A)("h-full",s&&"!max-h-[238px]",r,v&&"[mask-image:linear-gradient(to_bottom,_hsl(var(--always-black)/100%)_0%,_hsl(var(--always-black)/0%)_100%)]",!t&&"pointer-events-none"),children:l}),h]})},h=e=>{let{handleClick:t,isDisabled:s,isExpanded:i,isStreaming:o,isError:u,errorMessage:x,icon:h,text:g,secondaryIcon:p,secondaryText:v,isFirstBlockOfMessage:j,isLastBlockOfMessage:b,className:y,wrapperClassName:w,children:_,renderMode:k=m.l.Standard,isFirstItemInGroup:N,isLastItemInGroup:M}=e,C=s||!t,A=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:t,className:(0,d.A)("group/row flex flex-row items-center justify-between gap-4 transition-colors duration-200 rounded-lg text-text-300 hover:text-text-200 h-[2.625rem] py-2 px-3",C?"cursor-default":"cursor-pointer hover:text-text-000",y),disabled:C,children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 min-w-0",children:[h&&k!==m.l.TimelineGroup&&(0,a.jsx)("div",{className:"w-5 h-5 flex items-center justify-center text-text-100",children:h}),(0,a.jsx)("div",{className:"relative bottom-[0.5px] font-base text-left leading-tight overflow-hidden overflow-ellipsis whitespace-nowrap flex-grow text-text-300",children:o?(0,a.jsx)(l.N,{children:g}):g})]}),(0,a.jsx)("div",{className:"flex flex-row items-center gap-1.5 min-w-0 shrink-0",children:u?(0,a.jsx)(r.m,{tooltipContent:x,align:"center",children:(0,a.jsx)(n.N5l,{size:16,className:"text-danger-000"})}):(0,a.jsxs)(a.Fragment,{children:[!!v&&(0,a.jsx)("p",{className:"relative bottom-[0.5px] pl-1 text-text-500 font-small leading-tight shrink-0 whitespace-nowrap",children:v}),p]})})]},o?"streaming":"non-streaming"),_]});return k===m.l.TimelineGroup?(0,a.jsx)(f.i1,{icon:h,isExpanded:i,isFirstItem:!!N,isLastItem:!!M,isActive:o&&b&&M,children:A}):(0,a.jsx)(c.P.div,{initial:{opacity:+!o},animate:{opacity:1},transition:{duration:.5,ease:"easeIn"},className:(0,d.A)("transition-all duration-400 ease-out rounded-lg border-0.5 flex flex-col font-ui tracking-tight leading-normal my-3 border-border-300 min-h-[2.625rem]",!s&&!i&&"hover:bg-bg-000 hover:shadow-sm",j?"mt-2":"mt-3",b?"mb-2":"mb-3",i&&"bg-bg-000 shadow-sm",w),children:A})},g=e=>{let{isExpandingDisabled:t,setIsExpanded:s,...i}=e,{isExpanded:l,isError:r,secondaryIcon:o}=i,c=t||r;return(0,a.jsx)(h,{...i,isDisabled:c,handleClick:()=>s(!l),secondaryIcon:(0,a.jsxs)(a.Fragment,{children:[o,!c&&(0,a.jsx)(n.biH,{className:(0,d.A)("relative bottom-[0.5px] transform transition-transform duration-400 ease-snappy-out text-text-300",l?"-rotate-180":"rotate-0",c&&"opacity-15"),size:16})]})})}},97527:(e,t,s)=>{s.d(t,{I:()=>n,q:()=>i});var a=s(7620);let n=(0,a.createContext)(null),i=()=>{let e=(0,a.useContext)(n);if(!e)throw Error("useReplExecutionSandbox must be used within a ReplExecutionSandboxContextProvider");return e}}}]);