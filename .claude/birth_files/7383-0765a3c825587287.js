"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7383],{1974:(e,t,n)=>{n.d(t,{PerformanceMetricsProvider:()=>m,B:()=>h});var a=n(54568),r=n(56320);class i extends Error{}class s{add(e){this.buffer[this.head]=e,this.head=(this.head+1)%this.maxSize,this.currentSize<this.maxSize&&this.currentSize++}addAll(e){for(let t of e)this.add(t)}flush(){this.head=0,this.currentSize=0,this.buffer=Array(this.maxSize)}get size(){return this.currentSize}get isEmpty(){return 0===this.currentSize}get isFull(){return this.currentSize===this.maxSize}*values(){if(0===this.currentSize)return;let e=this.isFull?this.head:0;for(let t=0;t<this.currentSize;t++){let n=(e+t)%this.maxSize;yield this.buffer[n]}}toArray(){return Array.from(this.values())}getLast(){if(0===this.currentSize)return;let e=(this.head-1+this.maxSize)%this.maxSize;return this.buffer[e]}getFirst(){if(0===this.currentSize)return;let e=this.isFull?this.head:0;return this.buffer[e]}constructor(e){if(this.maxSize=e,this.head=0,this.currentSize=0,e<1)throw new i("RingBuffer maxSize must be 1 or more");this.buffer=Array(e)}}class l{get mean(){return this.count>0?this._mean:0}get variance(){return this.count>1?this._m2/(this.count-1):0}get stdDev(){return Math.sqrt(this.variance)}calculate(){let e=this._tail-this._mean;this._mean+=e/this.count;let t=this._tail-this._mean;this._m2+=e*t}getSummary(){return{count:this.count,sum:this.sum,min:this.min,max:this.max,mean:this.mean,variance:this.variance,stdDev:this.stdDev}}reset(){this.count=0,this.sum=0,this.min=1/0,this.max=-1/0,this._mean=0,this._m2=0}add(e){this.count+=1,this.sum+=e,this.min=Math.min(this.min,e),this.max=Math.max(this.max,e),this._tail=e,this.calculate()}constructor(){this.count=0,this.sum=0,this.min=1/0,this.max=-1/0,this._tail=0,this._mean=0,this._m2=0,this.reset()}}class o{init(){if("PerformanceLongTaskTiming"in window)try{this.initLongTaskObserver()}catch(e){console.error("PerfMon LongTaskObserver failed to init")}this.startReportMetricsInterval(),this.registerVisibilityHandlers()}initLongTaskObserver(){new PerformanceObserver(e=>{for(let n of e.getEntries()){let{attribution:e}=n;if(this.events.longTask.stats.add(n.duration),n.duration>=250){var t;this.events.longTask.buffer.add({start_time:n.startTime,duration:n.duration,attribution_count:null!=(t=null==e?void 0:e.length)?t:0})}}}).observe({entryTypes:["longtask"]})}startReportMetricsInterval(){let e=()=>{this.reportMetricsTimeoutId=window.setTimeout(()=>{this.reportMetrics(),this.isActive&&e()},12e4)};e()}registerVisibilityHandlers(){document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&this.reportMetrics()},{passive:!0}),window.addEventListener("pagehide",()=>this.reportMetrics(),{passive:!0})}reportSpan(e){let t=this.tracer.startSpan(e.name),n="performance.".concat(e.metricType),a={metric_type:e.metricType,...Object.fromEntries(Object.entries(e.attributes).map(e=>{let[t,a]=e;return[t.startsWith("".concat(n,"."))?t:"".concat(n,".").concat(t),a]})),["".concat(n,".duration_ms")]:e.duration};t.setAttributes(a),t.end()}reportMetrics(){this.isActive&&0!==this.events.longTask.stats.mean&&(this.reportSpan({name:"events.long_task.summary",metricType:"long_task_summary",duration:0,attributes:{...this.events.longTask.stats.getSummary()}}),this.events.longTask.stats.reset(),this.events.longTask.buffer.toArray().forEach(e=>{let{duration:t,...n}=e;this.reportSpan({name:"events.long_task",metricType:"long_task_event",duration:t,attributes:{...n}})}),this.events.longTask.buffer.flush())}destroy(){this.isActive=!1,Object.values(this.events).forEach(e=>{var t;null==(t=e.observer)||t.disconnect(),e.observer=void 0}),clearTimeout(this.reportMetricsTimeoutId),this.reportMetricsTimeoutId=void 0,this.reportMetrics()}forceReport(){this.reportMetrics()}constructor(e){this.tracer=e,this.isActive=!0,this.events={longTask:{stats:new l,buffer:new s(100)}},this.init()}}class u{getTracer(){return this.tracer||(this.tracer=r.u.getTracer("claude-ai-performance","1.0.0")),this.tracer}initPerfMon(){this.perfMon||(this.perfMon=new o(this.getTracer()))}trackNewChatInputReady(e){let t=this.getTracer().startSpan("page.new_chat_input_ready");t.setAttributes({"performance.new_chat_input_ready.duration_ms":e,"performance.metric_type":"new_chat_input_ready"}),t.end()}trackTTFT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getTracer().startSpan("chat.time_to_first_token"),a={"performance.ttft.duration_ms":e,"performance.metric_type":"ttft"};t.model&&(a["chat.model"]=t.model),n.setAttributes(a),n.end()}trackProjectConversationsReady(e){let t=this.getTracer().startSpan("page.project_conversations_ready");t.setAttributes({"performance.project_conversations_ready.duration_ms":e,"performance.metric_type":"project_conversations_ready"}),t.end()}trackMembersListReady(e){let t=this.getTracer().startSpan("page.members_list_ready");t.setAttributes({"performance.members_list_ready.duration_ms":e,"performance.metric_type":"members_list_ready"}),t.end()}constructor(){this.tracer=null,this.perfMon=null}}let c=new u;var d=n(62942),f=n(7620);let p=(0,f.createContext)(null);function m(e){let{children:t}=e,n=(0,d.usePathname)(),r=(0,f.useRef)(null),i=(0,f.useRef)(!1),s=(0,f.useRef)(null),l=(0,f.useRef)(!1),o=(0,f.useRef)(null),u=(0,f.useRef)(!1),m=(0,f.useRef)(null),h=(0,f.useRef)(!1);(0,f.useEffect)(()=>{c.initPerfMon()},[]),(0,f.useEffect)(()=>{"/new"===n?(r.current=performance.now(),i.current=!1):(null==n?void 0:n.startsWith("/project/"))?(o.current=performance.now(),u.current=!1):"/settings/members"===n&&(m.current=performance.now(),h.current=!1)},[n]);let g=(0,f.useCallback)(()=>{if(i.current||null===r.current)return;i.current=!0;let e=performance.now()-r.current;c.trackNewChatInputReady(e),r.current=null},[]),v=(0,f.useCallback)(()=>{s.current=performance.now(),l.current=!1},[]),y=(0,f.useCallback)(e=>{if(null===s.current||l.current)return;l.current=!0;let t=performance.now()-s.current;c.trackTTFT(t,e),s.current=null},[]),b=(0,f.useCallback)(()=>{if(u.current||null===o.current)return;u.current=!0;let e=performance.now()-o.current;c.trackProjectConversationsReady(e),o.current=null},[]),_=(0,f.useCallback)(()=>{if(h.current||null===m.current)return;h.current=!0;let e=performance.now()-m.current;c.trackMembersListReady(e),m.current=null},[]),x=(0,f.useMemo)(()=>({markEditorReady:g,markMessageSent:v,markFirstTokenReceived:y,markProjectConversationsReady:b,markMembersListReady:_}),[g,v,y,b,_]);return(0,a.jsx)(p.Provider,{value:x,children:t})}function h(){let e=(0,f.useContext)(p);if(!e)throw Error("usePerformanceMetrics must be used within a PerformanceMetricsProvider");return e}},9896:(e,t,n)=>{n.d(t,{F:()=>o});var a=n(27062),r=n(67933),i=n(7620),s=n(70011),l=n(85644);let o=()=>{let e="sticky-model-selector",{value:t}=(0,a.fS)("sticky_model_selector"),{value:n}=(0,a.fS)("model_selector_enabled"),{activeModelOptions:o}=(0,l.A9)(),u=(0,s.Z3)(null),c=(0,r.useQuery)({queryKey:[e],queryFn:()=>{if(!t||!n)return null;let a=localStorage.getItem(e);return a===u?null:a&&o.find(e=>e.model===a)?a:null},initialData:null}),d=(0,i.useCallback)(t=>{t&&localStorage.setItem(e,t),c.refetch()},[c]);return{stickyModelPreference:c.data,setStickyModelPreference:d}}},17423:(e,t,n)=>{n.d(t,{M$:()=>c,O5:()=>l,f$:()=>o,lo:()=>u,n7:()=>d});var a=n(77186),r=n(1761),i=n(71473),s=n(87606);let l=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,a.Sk)("/api/organizations/".concat(t,"/list_styles"),{queryKey:[i.ss,{orgUUID:t}]})},o=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid,n=(0,s.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/styles/create"),"POST",{onSuccess:()=>{n.invalidateQueries({queryKey:[i.ss,{orgUUID:t}]})}})},u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{activeOrganization:n}=(0,r.YL)(),l=null==n?void 0:n.uuid,o=(0,s.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(l,"/styles/").concat(e,"/edit"),"PUT",{onSuccess:()=>{o.invalidateQueries({queryKey:[i.ss,{orgUUID:l}]})},enabled:!t})},c=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,l=(0,s.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(n,"/styles/").concat(e,"/delete"),"DELETE",{onSuccess:()=>{l.invalidateQueries({queryKey:[i.ss,{orgUUID:n}]})}})},d=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,a.L2)("/api/organizations/".concat(t,"/styles/preview"),"POST")}},22529:(e,t,n)=>{n.d(t,{ClientIntlProvider:()=>p,O:()=>v,X5:()=>h,YX:()=>m,fl:()=>g});var a=n(54568),r=n(55428),i=n(68864),s=n(7620),l=n(88982),o=n(62971),u=n(18483);let c=new Set,d=e=>{if(e.message.includes("MISSING_TRANSLATION")){if(c.has(e.message))return;c.add(e.message)}console.error(e)},f=()=>void 0;function p(e){let{locale:t,messages:n,children:o,hideErrors:u}=e;return(0,s.useEffect)(()=>{i.wB.defaultLocale=t},[t]),(0,a.jsx)(l.A,{locale:t,messages:n,onError:u?f:(0,r.O0)()?d:void 0,fallbackOnEmptyString:!1,children:(0,a.jsx)(a.Fragment,{children:o})})}function m(e){let{id:t}=e;return(0,a.jsx)(o.A,{id:(0,u.ey)(t),defaultMessage:" "})}function h(e){let{id:t}=e;return(0,a.jsx)(o.A,{id:(0,u.lK)(t),defaultMessage:" "})}function g(e){let{id:t,intl:n}=e;return n.formatMessage({id:(0,u.lK)(t),defaultMessage:" "})}function v(e){let{id:t,intl:n}=e;return n.formatMessage({id:(0,u.ey)(t),defaultMessage:" "})}},32442:(e,t,n)=>{function a(e){let t=e,n="",a=0;for(;t!==n&&a<10;)n=t,t=(t=(t=(t=t.normalize("NFKC")).replace(RegExp("[\\p{Cf}\\p{Co}\\p{Cn}]","gu"),"")).replace(RegExp("[\\p{Cc}]","gu"),e=>"\n"===e||"	"===e||"\r"===e?e:"")).replace(/[\u200B-\u200F]/g,"").replace(/[\u202A-\u202E]/g,"").replace(/[\u2066-\u2069]/g,"").replace(/[\uFEFF]/g,"").replace(/[\uE000-\uF8FF]/g,""),a++;if(a>=10)throw Error("Unicode sanitization reached maximum iterations (".concat(10,") for input: ").concat(e.slice(0,100)));return t}n.d(t,{M:()=>function e(t){if("string"==typeof t)return a(t);if(Array.isArray(t))return t.map(e);if(null!==t&&"object"==typeof t){let n={};for(let[a,r]of Object.entries(t))n[e(a)]=e(r);return n}return t},P:()=>a})},33200:(e,t,n)=>{n.d(t,{N:()=>i});var a=n(27062),r=n(21036);function i(e){let t=(0,r.useLayer)("frontend").get("analysis_tool_experiment_enabled",!1),{value:n}=(0,a.fS)("rely_on_analysis_flag"),{value:i}=(0,a.fS)("analysis_tool_launch_ga");if(n){var s;return{value:null!=(s=null==e?void 0:e.enabled_artifacts_attachments)?s:i,source:"flag"}}return{value:(null==e?void 0:e.enabled_artifacts_attachments)||t,source:"experiment"}}},42685:(e,t,n)=>{n.d(t,{OpusRateLimitModalProvider:()=>o,T:()=>l});var a=n(54568),r=n(7620),i=n(71165);let s=null;function l(){s&&s(!0)}function o(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>(s=t,()=>{s=null}),[]),(0,a.jsx)(i.v,{isOpen:e,onClose:()=>t(!1),limitType:"opus"})}},45727:(e,t,n)=>{n.d(t,{p:()=>s});var a=n(19125),r=n(27062),i=n(17423);let s=()=>{let{value:e}=(0,r.fS)("concise_mode_enabled"),{data:t,isLoading:n}=(0,i.O5)(),s=(null==t?void 0:t.defaultStyles)||[],l=[...s,...((null==t?void 0:t.customStyles)||[]).map(e=>({...e,key:e.key||e.uuid}))],[o,u,c]=(0,a.V)("claude_personalized_style",null);if(n||!(null==l?void 0:l.length))return{personalizedStyleOptions:[],defaultStyle:null,storedStyle:null,setStoredStyle:u,clearStoredStyle:c,conciseModeEnabled:e};let d=s.length?s.find(e=>!0===e.isDefault)||s[0]:null;if(e&&(d=s.find(e=>"Concise"===e.key)||d),!o)return{personalizedStyleOptions:l,defaultStyle:d,storedStyle:o,setStoredStyle:u,clearStoredStyle:c,conciseModeEnabled:e};let f=l.find(e=>((e,t)=>"default"===e.type&&e.key===t||"custom"===e.type&&e.uuid===t)(e,o.styleKey)),p=Date.now()-new Date(o.timestamp).getTime()>432e5;return{personalizedStyleOptions:l,storedStyle:f&&!p?f:null,defaultStyle:d,setStoredStyle:u,clearStoredStyle:c,conciseModeEnabled:e}}},50707:(e,t,n)=>{n.d(t,{M:()=>s});var a=n(54568),r=n(32987),i=n(62971);function s(e){let{className:t,onClick:n,as:s="span"}=e;return(0,a.jsx)(s,{className:(0,r.A)("border-0.5 border-border-400 text-accent-secondary-000 px-1.5 py-px rounded-3xl font-small",n&&"cursor-pointer hover:border-border-300 transition-colors",t),onClick:n,children:(0,a.jsx)(i.A,{defaultMessage:"Upgrade",id:"0h/lPMeYkq"})})}},52909:(e,t,n)=>{n.d(t,{CO:()=>f,M3:()=>u,bG:()=>c,ks:()=>m,pz:()=>o,z_:()=>d});var a=n(77186),r=n(1761),i=n(71473),s=n(87606),l=n(91768);let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,r.YL)(),i=null==n?void 0:n.uuid,s=p(),o=(0,l.eL)();return(0,a.L2)(()=>"/api/organizations/".concat(i,"/projects/").concat(e,"/syncs"),"POST",{enabled:!!(n&&e),...t,onSuccess:function(){for(var n,a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];s(e),null==(n=t.onSuccess)||n.call(t,...r)},onError:function(){for(var e,n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];null==(e=t.onError)||e.call(t,...a);let[i,s]=a;o(i,s)}})},u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,r.YL)(),i=null==n?void 0:n.uuid,s=p();return(0,a.L2)(()=>"/api/organizations/".concat(i,"/projects/").concat(e,"/syncs"),"PUT",{enabled:!!(n&&e),...t,onSuccess:function(){for(var n,a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];s(e),null==(n=t.onSuccess)||n.call(t,...r)}})},c=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,s=p();return(0,a.Qv)(t=>"/api/organizations/".concat(n,"/projects/").concat(e,"/syncs/").concat(t),"DELETE",(e,t)=>t?t.filter(t=>t.uuid!==e):t,{queryKey:[i.LV,{orgUuid:n,projectUuid:e}],enabled:!!t,onSuccess:()=>{s(e)}})},d=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,s=p();return(0,a.Qv)(()=>"/api/organizations/".concat(n,"/projects/").concat(e,"/syncs/delete_many"),"POST",(e,t)=>t?t.filter(t=>!e.sync_source_uuids.includes(t.uuid)):t,{queryKey:[i.LV,{orgUuid:n,projectUuid:e}],enabled:!!t,onSuccess:()=>{s(e)}})},f=function(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{activeOrganization:o}=(0,r.YL)(),u=null==o?void 0:o.uuid,c=(0,s.useQueryClient)(),d=!!(o&&e&&n),{data:f,isLoading:p}=(0,a.Sk)("/api/organizations/".concat(u,"/projects/").concat(e,"/syncs?calculate_size=").concat(null!=t&&t),{queryKey:[i.LV,{orgUuid:u,projectUuid:e,calculateSize:t}],enabled:d,refetchInterval:e=>{var t;return(null==(t=e.state.data)?void 0:t.some(l.z3))?5e3:3e5},structuralSharing:(t,n)=>{let a=void 0!==t&&t.some(l.z3),r=void 0!==n&&n.some(l.z3);return a&&!r&&c.invalidateQueries({queryKey:[i.qz,{orgUuid:u,projectUuid:e}]}),n}});return{data:f,isLoading:!!d&&p}},p=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid,n=(0,s.useQueryClient)();return e=>{n.invalidateQueries({queryKey:[i.LV,{orgUuid:t,projectUuid:e}]}),n.invalidateQueries({queryKey:[i._G,{orgUuid:t,projectUuid:e}]}),n.invalidateQueries({queryKey:[i.qz,{orgUuid:t,projectUuid:e}]})}},m=e=>{let{data:t}=f(e);return!!(null==t?void 0:t.some(l.z3))}},57383:(e,t,n)=>{n.d(t,{_:()=>j,o:()=>C});var a=n(54568),r=n(66860),i=n(61125),s=n(74530),l=n(9896),o=n(77186),u=n(29585),c=n(7620),d=n(67455),f=n(98251),p=n(67094),m=n(52909),h=n(1761),g=n(51121),v=n(45727),y=n(42685),b=n(1974),_=n(72431),x=n(19125),w=n(32442);let S={type:"doc",content:[{type:"paragraph",content:[]}]},k=c.createContext({attachments:[],files:[],transitionFiles:[],syncSourceUuids:[],isAtMaxNumUploads:!1,model:"",prompt:"",tipTapEditorState:{},projectUuid:void 0,beamChatUuid:void 0,isNewBeamChat:!1,isChatSyncing:!1,personalizedStyle:void 0,isProjectSyncing:!1,isNewConversation:!1,isProjectLocked:!1,isSending:!1,setPrompt:()=>void 0,setTipTapEditorState:()=>void 0,setAttachments:()=>void 0,setFiles:()=>void 0,setSyncSourceUuids:()=>void 0,setModel:()=>Promise.resolve(),setProjectUuid:()=>void 0,setBeamChatUuid:()=>void 0,setIsNewBeamChat:()=>void 0,sendMessage:()=>void 0,sendTransparentMessage:()=>void 0,stopSampling:()=>void 0,pendingConversationSettings:{},conversation:void 0,focusInput:()=>void 0,improvePrompt:()=>void 0,isImprovingPrompt:!1,isFocused:!1,setIsFocused:()=>void 0,promptInputRef:{current:null},willRedirectOnSubmit:!1,hasBlockingWarning:!1,setHasBlockingWarning:()=>void 0,setPersonalizedStyle:()=>void 0,isUploadingDriveSync:!1,isUploadingGithubSync:!1,setIsUploadingDriveSync:()=>void 0,setIsUploadingGithubSync:()=>void 0,includeProfilePreferences:!0,setIncludeProfilePreferences:()=>void 0,isUploadingFile:!1,setIsUploadingFile:()=>void 0,validateMaxUploadLimit:()=>!1,onDrop:()=>void 0,onPasteFiles:()=>Promise.resolve(),handleUpload:()=>Promise.resolve(),uploadInputProps:{type:"",accept:"",onChange:()=>void 0,multiple:!1,"aria-label":""},hasAttachments:!1,isModelSelectorOpen:!1,setIsModelSelectorOpen:()=>void 0,setPendingConversationSettings:()=>void 0,isPromptUnsafe:()=>!1,currentCompassTask:void 0,setCurrentCompassTask:()=>void 0}),C=()=>c.useContext(k),j=e=>{var t,n,C,j,z,M,T;let{onSend:A,willRedirectOnSubmit:E,onCreate:P,onStopSampling:L,customFileUploadHandler:U}=e,{incognitoModeEnabled:I}=(0,_.S)(),O=(0,c.useRef)(null),N="conversation"in e,{children:F,projectUuid:R,namespace:D}=e,Y=N?e.conversation:void 0,{markMessageSent:K}=(0,b.B)(),Q=(0,c.useCallback)(()=>{N&&L&&L()},[L,N]);(e=>{let t=(0,c.useCallback)(t=>{if(e&&!(e=>!!e&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName||"true"===e.getAttribute("contenteditable")||"textbox"===e.getAttribute("role")))(document.activeElement)&&1===t.key.length&&!t.ctrlKey&&!t.altKey&&!t.metaKey){var n;if(!(" "===t.key&&(e=>{if(!e)return!1;let t=e.tagName;return"BUTTON"===t||"SUMMARY"===t||"SELECT"===t||("INPUT"===t?["button","submit","reset","checkbox","radio"].includes(e.type):["button","checkbox","radio","switch","menuitem","menuitemcheckbox","menuitemradio","option"].includes(e.getAttribute("role")||""))})(document.activeElement)))t.preventDefault(),null==(n=e.getEditor())||n.chain().insertContent(t.key).focus().run()}},[e]);(0,c.useEffect)(()=>(document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)),[t])})(O.current);let{tipTapEditorState:q,setTipTapEditorText:B,setTipTapEditorJSON:V,isTipTapEditorStateUnsafe:G,attachments:J,setAttachments:W,files:X,setFiles:Z,syncSourceUuids:H,setSyncSourceUuids:$,clear:ee}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,a="".concat(n?"".concat(n,":"):"").concat(e),[r,i,l]=(0,x.V)("".concat(a,":attachment"),[]),[o,u,d]=(0,x.V)("".concat(a,":files"),[]),[f,p,m]=(0,x.V)("".concat(a,":syncSourceUuids"),[]),[h,g,v]=(0,x.V)("".concat(a,":textInput"),t?{type:"doc",content:[{type:"paragraph",content:[{type:"text",text:t}]}]}:S),y=(0,c.useCallback)(()=>!!h.__ant_unsafe,[h]),b=(0,c.useCallback)((e,t)=>{let n=(0,w.P)(e),a={type:"doc",content:[{type:"paragraph",content:[{type:"text",text:n}]}]};return n.length>0&&t&&(a.__ant_unsafe=!0),g(a),n},[g]);return{attachments:r,setAttachments:i,files:o,setFiles:u,syncSourceUuids:f,setSyncSourceUuids:p,tipTapEditorState:h,setTipTapEditorJSON:(0,c.useCallback)(e=>{let t=(0,s.h0)(e);return t.length>0&&y()&&(e.__ant_unsafe=!0),g(e),t},[g,y]),setTipTapEditorText:b,isTipTapEditorStateUnsafe:y,clear:(0,c.useCallback)(()=>{v(),l(),d(),m()},[l,v,d,m])}}(null!=(n=null==Y?void 0:Y.id)?n:void 0===R?"new-conversation":"".concat(R,":conversation"),"",D),et=q?(0,s.h0)(q):"",[en,ea]=c.useState(et),er=(0,c.useCallback)(e=>{ea(V(e))},[V,ea]),ei=(0,c.useCallback)(function(e){let{forceUpdateTiptap:t=!0,unsafe:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=B(e,n);if(ea(a),!0===t){var r;null==(r=O.current)||r.setContent(a)}},[B]),es=(0,d.NY)(H),el=(0,d.qJ)(es),eo=(0,o.B7)(es),eu=J.length+X.length+H.length>=r.Jn,[ec,ed]=c.useState(!1),[ef,ep]=c.useState(),{stickyModelPreference:em}=(0,l.F)(),eh=null!=(z=null!=(j=null!=(C=null==Y?void 0:Y.model)?C:ef)?j:em)?z:void 0,[eg,ev]=c.useState(),ey=(0,c.useCallback)(e=>{ev(t=>({...t,...e}))},[]),[eb,e_]=c.useState(R),ex=(0,p.Ah)(),{mutate:ew}=(0,f.nI)(),eS=(0,c.useCallback)(e=>{e_(e),ex&&e&&ew&&ew({project_uuid:e})},[ex,ew]),ek=(0,m.ks)(eb),[eC,ej]=c.useState(void 0),[ez,eM]=c.useState(!1),eT=(0,c.useCallback)(e=>{ej(e),e&&eM(!1)},[]),eA=(0,c.useCallback)(e=>{eM(e),e&&ej(void 0)},[]),[eE,eP]=c.useState(!1),[eL,eU]=c.useState(),[eI,eO]=c.useState(!1),[eN,eF]=c.useState(!1),[eR,eD]=c.useState(!1),{storedStyle:eY,defaultStyle:eK}=(0,v.p)(),[eQ,eq]=c.useState(),[eB,eV]=c.useState(!0),[eG,eJ]=c.useState();(0,c.useEffect)(()=>{let e=null!=eY?eY:eK;!eQ&&e&&eq(e)},[eY,eK,eQ]),(0,c.useEffect)(()=>{R&&eb!==R&&eS(R)},[R,eb,eS]);let eW="setPersonalizedStyleCallback"in e?e.setPersonalizedStyleCallback:null;(0,c.useEffect)(()=>{eU(void 0),eP(!1)},[null==Y?void 0:Y.id]),(0,c.useEffect)(()=>{null==eW||eW(eQ)},[eQ,eW]);let eX=(0,c.useCallback)(async()=>{if(O.current&&(""!==en.trim()||0!==J.length||0!==X.length||0!==H.length)){E&&eU([...X]),ee(),ea(""),E?O.current.setEditable(!1):O.current.setContent(""),eP(!0);try{K(),N&&A?(await A({prompt:en,attachments:J,files:X,syncSources:eo,personalized_style:eQ}),eP(!1),eU(void 0)):await P({prompt:en,attachments:J,files:X,syncSources:eo,model:eh,project_uuid:eb,is_new_beam_chat:ez||void 0,beam_chat_uuid:eC,personalized_style:eQ,include_conversation_preferences:eB,is_temporary:I,...eg})}catch(t){var e;if(t instanceof u.LG&&"opus_messages_rate_limit_exceeded"===t.errorCode)(0,y.T)();else throw t;ei(en),null==(e=O.current)||e.setContent(en),W(J),Z(X),$(H),O.current.setEditable(!0),eP(!1),eU(void 0)}}},[eg,J,ee,X,eB,N,eh,P,A,eQ,eb,en,W,Z,ei,$,H,eo,E,I,K,ez,eC]),eZ=(0,c.useCallback)(async e=>{if(void 0!==e&&""!==e.trim()&&N){eP(!0);try{A&&(await A({prompt:e,attachments:[],files:[],syncSources:[],personalized_style:eQ}),eP(!1))}catch(e){if(e instanceof u.LG&&"opus_messages_rate_limit_exceeded"===e.errorCode)(0,y.T)();else throw e;eP(!1)}}},[N,A,eQ]),{streamImprovement:eH,isStreaming:e$}=function(){let{activeOrganization:e}=(0,h.YL)(),[t,n]=(0,c.useState)(!1),[a,r]=(0,c.useState)(null),i=(0,c.useRef)(null),{addError:s}=(0,g.Y)(),l=(0,c.useCallback)(async(t,a,l,o)=>{i.current&&i.current.abort();let u=new AbortController;i.current=u,n(!0),r(null);let c="/api/organizations/".concat(null==e?void 0:e.uuid,"/prompt/improve/stream");try{var d,f,p;let e=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include",signal:u.signal});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let n=null==(d=e.body)?void 0:d.getReader(),r=new TextDecoder;if(!n)throw Error("No response body");let i="",s="",o=!1;for(;!o;){let e=await n.read();if(e.done){o=!0;break}let t=e.value,u=(i+=r.decode(t,{stream:!0})).split("\n");for(let e of(i=u.pop()||"",u))if(e.startsWith("data: ")){let t=e.slice(6);if("[DONE]"===t)continue;try{let e=JSON.parse(t);switch(e.type){case"content_block_delta":(null==(f=e.delta)?void 0:f.text)&&(s+=e.delta.text,a(e.delta.text));break;case"message_stop":l(e.improved_prompt||s);break;case"error":throw Error((null==(p=e.error)?void 0:p.message)||"Unknown error occurred")}}catch(e){}}else e.startsWith("event: ")&&e.slice(7)}}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;let e=t instanceof Error?t:Error(String(t));r(e),null==o||o(e),s("Failed to improve prompt: "+e.message)}finally{n(!1),i.current===u&&(i.current=null)}},[null==e?void 0:e.uuid,s]);return(0,c.useEffect)(()=>()=>{i.current&&i.current.abort()},[]),{streamImprovement:l,isStreaming:t,error:a}}(),e0=(0,c.useCallback)(async()=>{var e,t,n,a;if(!en.trim())return;null==(e=O.current)||e.setEditable(!1);let r="",i=!1;try{await eH({conversation_uuid:(null==Y?void 0:Y.id)||"new-conversation",prompt:en},e=>{var t,n,a;i||(i=!0,ei(""),null==(a=O.current)||a.setContent("")),r+=e,ei(r,{forceUpdateTiptap:!1}),null==(t=O.current)||t.setContent(r),null==(n=O.current)||n.scrollToEnd()},e=>{var t;ei(e),null==(t=O.current)||t.setContent(e)},e=>{var t;ei(en),null==(t=O.current)||t.setContent(en)})}catch(e){ei(en),null==(t=O.current)||t.setContent(en)}finally{null==(n=O.current)||n.setEditable(!0),null==(a=O.current)||a.focus()}},[en,null==Y?void 0:Y.id,eH,ei]),e1=(0,c.useCallback)(async e=>{if(ep(e),N){eP(!0);try{var t;await P({prompt:en,attachments:J,files:X,syncSources:eo,model:e,project_uuid:eb,create_mode:null==Y||null==(t=Y.conversationSettings)?void 0:t.create_mode,...eg})}finally{eP(!1)}}},[eg,J,X,N,eb,en,P,eo,null==Y||null==(t=Y.conversationSettings)?void 0:t.create_mode]),e2=(0,c.useCallback)(()=>{var e;return null==(e=O.current)?void 0:e.focus()},[O]),[e5,e6]=c.useState(!1),e7=(0,i.cV)(),[e4,e3,e8,e9,te,tt,tn,ta]=(0,r.Si)({syncSourceCount:H.length,attachments:J,setAttachments:W,numExistingConversationAttachments:null!=(M=null==Y?void 0:Y.attachmentsSoFar)?M:0,files:X,setFiles:Z,numExistingConversationFiles:null!=(T=null==Y?void 0:Y.files.length)?T:0,detectSameAttachment:()=>!1,selectedModel:eh,blobFileUploadsEnabled:e7,customFileUploadHandler:U}),tr=J.length+X.length,ti=H.length,ts=e4||eN||eR,tl=tr>0||ti>0||ts,to=(0,c.useMemo)(()=>{var t;return{prompt:en,tipTapEditorState:q,attachments:J,files:e.willRedirectOnSubmit&&eE?null!=eL?eL:[]:X,syncSourceUuids:H,isAtMaxNumUploads:eu,isUploadingDriveSync:eN,isUploadingGithubSync:eR,model:eh,projectUuid:eb,beamChatUuid:eC,isNewBeamChat:ez,isChatSyncing:el,personalizedStyle:eQ,isProjectSyncing:ek,isNewConversation:void 0===Y||0===Y.messagesSoFar,isProjectLocked:void 0!==R||void 0!==Y,isSending:eE,setPrompt:ei,setTipTapEditorState:er,setAttachments:W,setFiles:Z,setSyncSourceUuids:$,setModel:e1,setProjectUuid:eS,setBeamChatUuid:eT,setIsNewBeamChat:eA,sendMessage:eX,sendTransparentMessage:eZ,improvePrompt:e0,isImprovingPrompt:e$,stopSampling:Q,conversation:Y,focusInput:e2,isFocused:eI,setIsFocused:eO,promptInputRef:O,willRedirectOnSubmit:null!=(t=e.willRedirectOnSubmit)&&t,hasBlockingWarning:e5,setHasBlockingWarning:e6,setPersonalizedStyle:eq,setIsUploadingDriveSync:eF,setIsUploadingGithubSync:eD,includeProfilePreferences:eB,setIncludeProfilePreferences:eV,pendingConversationSettings:eg,setPendingConversationSettings:ey,isUploadingFile:e4,setIsUploadingFile:e3,validateMaxUploadLimit:e8,onDrop:e9,onPasteFiles:te,handleUpload:tt,uploadInputProps:ta,hasAttachments:tl,isModelSelectorOpen:ec,setIsModelSelectorOpen:ed,isPromptUnsafe:G,currentCompassTask:eG,setCurrentCompassTask:eJ}},[J,Y,X,e2,R,e5,eB,eu,el,eI,ek,eE,eN,eR,eh,eQ,eb,eS,eC,ez,en,e.willRedirectOnSubmit,eX,eZ,e0,e$,W,Z,e1,eg,ey,eT,eA,ei,$,er,Q,H,q,eL,e4,e3,e8,e9,te,tt,ta,tl,ec,ed,G,eG,eJ]);return(0,a.jsx)(k.Provider,{value:to,children:F})}},61125:(e,t,n)=>{n.d(t,{F9:()=>k,QC:()=>_,_F:()=>c,cV:()=>C,cb:()=>x,cm:()=>v,eT:()=>S,kd:()=>w});var a=n(1761),r=n(2341),i=n(27062),s=n(33200);let l=[".DS_Store"],o=["jpg","jpeg","png","gif","webp"],u=["image/jpeg","image/png","image/gif","image/webp"],c={"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp"},d=["bmp","ico","tiff","tif","psd","raw","cr2","nef","orf","sr2","mobi","jp2","jpx","jpm","mj2","svg","svgz","ai","eps","ps","indd","heic","mp4","mov","avi","mkv","wmv","flv","webm","mpeg","mpg","m4v","3gp","ogv","ogg","rm","rmvb","asf","amv","mpe","m1v","m2v","svi","3g2","roq","nsv","f4v","f4p","f4a","f4b","qt","hdmov","divx","div","m2ts","mts","vob","mp3","wav","wma","aac","flac","alac","aiff","ogg","opus","m4a","amr","awb","wmv","ra","rm","mid","midi","mka","ttf","otf","woff","woff2","eot","sfnt","ttc","suit","zip","doc","pptx"],f=["xls","xlsx","xlsb","xlm","xlsm","xlt","xltm","xltx","ods"],p=["txt","py","ipynb","js","jsx","html","css","java","cs","php","c","cc","cpp","cxx","cts","h","hh","hpp","rs","R","Rmd","swift","go","rb","kt","kts","ts","tsx","m","mm","mts","scala","rs","dart","lua","pl","pm","t","sh","bash","zsh","csv","log","ini","cfg","config","json","proto","yaml","yml","toml","lua","sql","bat","md","coffee","tex","latex","gd","gdshader","tres","tscn"],m=["docx","rtf","epub","odt","odp","pdf"],h=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/rtf","application/epub+zip","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.presentation","application/pdf"],g=["csv"],v=e=>{let{imagesEnabled:t=!1,outOfContextFilesEnabled:n=!1,wiggleEnabled:a=!1}=e;return[...a?[".pptx",".doc",".docx",".zip"]:[],...m.map(e=>".".concat(e)),...b(),...t?y():[],...n?f.map(e=>".".concat(e)):[]]},y=()=>o.map(e=>".".concat(e)),b=()=>p.map(e=>".".concat(e)),_=e=>e.split(".").pop().toLowerCase(),x=e=>{let t=_(e.name);return o.includes(t)||u.includes(e.type)},w=(e,t)=>{let{imagesEnabled:n=!1,blobFileUploadsEnabled:a=!1,rasterizePdfUploadsEnabled:r}=t,i=[],s=[],c=[],p=[],m=[],h=[];return e.filter(e=>!l.includes(e.name)).forEach(e=>{let t=n&&x(e);((e,t)=>{let{imagesEnabled:n=!1,blobFileUploadsEnabled:a=!1}=t,r=_(e.name);return!!(!n&&(o.includes(r)||u.includes(e.type)))||(a?d.includes(r):[...d,...f].includes(r))})(e,{imagesEnabled:n,blobFileUploadsEnabled:a})?m.push(e):e.size>3e7?h.push(e):a&&[...g,...f].includes(_(e.name))?c.push(e):r&&("pdf"===_(e.name)||"application/pdf"===e.type)?p.push(e):S(e)?i.push(e):t?s.push(e):i.push(e)}),{attachmentUploads:i,imageUploads:s,rasterizedDocumentUploads:p,unsupportedUploads:m,tooLargeUploads:h,outOfContextFileUploads:c}},S=e=>{let t=_(e.name);return m.includes(t)||h.includes(e.type)},k=async e=>{let t=await e.arrayBuffer(),n=(e=>{let t=new Uint8Array(e);if(t.length>=4){if(239===t[0]&&187===t[1]&&191===t[2])return"utf-8";if(254===t[0]&&255===t[1]||255===t[0]&&254===t[1])return"utf-16";if(0===t[0]&&0===t[1]&&254===t[2]&&255===t[3]||255===t[0]&&254===t[1]&&0===t[2]&&0===t[3])return"utf-32"}let n=!0,a=Math.min(t.length-1,1e3);for(let e=0;e<a;e+=2)if(0===t[e]&&0===t[e+1]||0!==t[e]&&0!==t[e+1]){n=!1;break}if(n)return"utf-16";let r=!0,i=!1;for(let e=0;e<t.length;e++){let n=t[e];if(n>127)if(i=!0,(224&n)==192){if(e+1>=t.length||(192&t[e+1])!=128){r=!1;break}e+=1}else if((240&n)==224){if(e+2>=t.length||(192&t[e+1])!=128||(192&t[e+2])!=128){r=!1;break}e+=2}else if((248&n)==240){if(e+3>=t.length||(192&t[e+1])!=128||(192&t[e+2])!=128||(192&t[e+3])!=128){r=!1;break}e+=3}else{r=!1;break}}if(r&&i)return"utf-8";let s=(e=>{let t={ascii:0,nonAscii:0,cyrillic:0,latin1:0,control:0,total:Math.min(e.length,4e3)};for(let n=0;n<t.total;n++){let a=e[n];a<32?t.control++:a<127?t.ascii++:a>127&&(t.nonAscii++,(a>=192&&a<=255||a>=168&&a<=183)&&t.cyrillic++,(a>=128&&a<=159||a>=160&&a<=255)&&t.latin1++)}return t})(t),l=s.cyrillic/s.total*100,o=s.latin1/s.total*100,u=s.ascii/s.total*100;if(s.nonAscii>0){if(l>.3)return"windows-1251";if(o>s.control/s.total*100)return"windows-1252"}return u>90&&s.control/s.total<.1?"ascii":"utf-8"})(t);try{return new TextDecoder(n,{fatal:!0}).decode(t)}catch(e){if("utf-8"!==n)return new TextDecoder("utf-8",{fatal:!0}).decode(t)}throw Error("Failed to decode file as plain text")};function C(){var e;let{value:t}=(0,i.fS)("ooc_attachments"),{account:n}=(0,a.YL)(),l=(0,r.B)(),o=null!=(e=null!=l?l:null==n?void 0:n.settings)?e:{},{value:u}=(0,s.N)(o);return!!t&&u}},66860:(e,t,n)=>{n.d(t,{Jn:()=>M,Si:()=>P,fU:()=>U,i1:()=>D,pD:()=>E,vV:()=>O});var a=n(42977),r=n(54568),i=n(61125),s=n(70011),l=n(85644),o=n(98518),u=n(77186),c=n(1761),d=n(51121),f=n(90510),p=n(29242),m=n(29585),h=n(46612),g=n(71473),v=n(27062),y=n(69055),b=n(7033),_=n(70825),x=n(87606),w=n(7620),S=n(62971),k=n(46760),C=n(81133),j=n(17936);function z(){let e=(0,a._)(["\n  relative\n  grid\n  place-content-center\n  aspect-square\n  rounded-xl\n  cursor-pointer\n  transition\n  [fieldset:not(:disabled)_&]:hover:bg-bg-400\n  [fieldset:disabled_&]:opacity-50\n  [fieldset:disabled_&]:pointer-events-none\n  focus-within:ring\n  inline-flex\n  items-center\n  justify-center\n  relative\n  shrink-0\n  ring-offset-2\n  ring-offset-bg-300\n  ring-accent-main-100\n  focus-visible:outline-none\n  focus-visible:ring-1\n  disabled:pointer-events-none\n  disabled:opacity-50\n  disabled:shadow-none\n  disabled:drop-shadow-none\n  bg-[radial-gradient(ellipse,_var(--tw-gradient-stops))]\n  from-bg-500/10\n  from-50%\n  to-bg-500/30\n  border-0.5\n  border-border-400\n  font-medium\n  font-ui\n  text-text-100/90\n  transition-colors\n  active:bg-bg-500/50\n  hover:text-text-000\n  hover:bg-bg-500/60\n"]);return z=function(){return e},e}let M=20,T=e=>{let t=e.webkitRelativePath;return t&&t.length?t:e.name},A=e=>e.replace(/\0/g,""),E=e=>{e.extracted_content=A(e.extracted_content),e.file_name=A(e.file_name),e.file_type=A(e.file_type)};function P(e){let{syncSourceCount:t,files:n,setFiles:a,numExistingConversationFiles:o,attachments:u,setAttachments:c,numExistingConversationAttachments:f,detectSameAttachment:m,selectedModel:h,blobFileUploadsEnabled:g,customFileUploadHandler:_}=e,{addError:x}=(0,d.Y)(),C=(0,s.Z3)(null);return function(e){let{syncSourceCount:t,onUploadComplete:n,existingAttachments:a,existingFiles:s,numExistingConversationAttachments:o,numExistingConversationFiles:u,selectedModel:c,blobFileUploadsEnabled:d,customFileUploadHandler:f}=e,m=(0,k.A)(),{modelConfig:h}=(0,l.fC)(c),{value:g}=(0,v.fS)("trials_and_tribulations_of_high_school_football"),_=g&&!1,x=h.image_in,[C,j,z,T]=function(e){let{syncSourceCount:t,onUploadComplete:n,existingAttachments:a,existingFiles:s,numExistingConversationFiles:o,selectedModel:u,blobFileUploadsEnabled:c,customFileUploadHandler:d}=e,{modelConfig:f}=(0,l.fC)(u),p=f.image_in,m=D()&&f.pdf_in,{isUploading:h,setIsUploading:g,handleError:v,handleUpload:y}=O({imagesEnabled:p,blobFileUploadsEnabled:c,onUploadComplete:n,rasterizePdfUploadsEnabled:m,customFileUploadHandler:d}),b=(0,w.useCallback)(e=>{let{newUploads:n=[],numNewPotentialAttachments:l=0,showError:u=!0}=e,{attachmentUploads:d,imageUploads:f,rasterizedDocumentUploads:h,outOfContextFileUploads:g}=(0,i.kd)(n,{imagesEnabled:p,blobFileUploadsEnabled:c,rasterizePdfUploadsEnabled:m});return l+d.length+f.length+h.length+g.length+a.length+s.length+t>M?(u&&v((0,r.jsx)(S.A,{defaultMessage:"You can add at most {count, plural, one {# attachment} other {# attachments}} to a message. Please select fewer attachments.",id:"qxV00r12ob",values:{count:M}})),!1):!(f.length+h.length+s.length+o>100)||(u&&v((0,r.jsx)(S.A,{defaultMessage:"You can add at most {count, plural, one {# file} other {# files}} to a chat. {suggestion}",id:"QyrCxYs5Jy",values:{count:100,suggestion:o<100?(0,r.jsx)(S.A,{defaultMessage:"Please select fewer files.",id:"a6KVizNPLe"}):(0,r.jsx)(S.A,{defaultMessage:"Please consider starting a new chat.",id:"oN0R8lZNm6"})}})),!1)},[p,c,a,s,t,o,v,m]);return[h,g,b,(0,w.useCallback)(async e=>{b({newUploads:e})&&await y(e)},[y,b])]}({syncSourceCount:t,onUploadComplete:n,existingFiles:s,existingAttachments:a,numExistingConversationFiles:u,numExistingConversationAttachments:o,selectedModel:c,blobFileUploadsEnabled:d,customFileUploadHandler:f}),A=function(e){let{handleUpload:t}=e,n=(0,w.useRef)({ready:0,total:0}),a=(0,w.useCallback)(()=>{n.current={ready:0,total:0}},[]),r=(0,w.useCallback)(e=>{n.current.ready+=1,n.current.total===n.current.ready&&t(e)},[t]),i=(0,w.useCallback)((e,t)=>{let a=e.length;for(let s=0;s<a;s++){let a=e[s];a.isFile?(n.current.total+=1,a.file(e=>{t.push(e),r(t)})):a.isDirectory&&a.createReader().readEntries(e=>{i(e,t)})}},[r]);return(0,w.useCallback)(e=>{var t;e.preventDefault(),a();let n=null==(t=e.dataTransfer)?void 0:t.items;if(!n)return;let r=[];for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e].webkitGetAsEntry();t&&r.push(t)}i(r,[])},[i,a])}({handleUpload:T}),E=(0,w.useCallback)(async e=>{await T(Array.from(e))},[T]),P=(0,w.useCallback)(async e=>{let t=e.target.files;t&&await T(Array.from(t)),e.target.value=""},[T]),L=x?(0,r.jsx)(S.A,{defaultMessage:"Upload docs or images to Claude\\n(Max {maxUploads}, 30mb each)",id:"ialBpH0eLp",values:{maxUploads:M}}):(0,r.jsx)(S.A,{defaultMessage:"Add content ({maxUploads} max, 30mb each)\\nAccepts pdf, txt, csv, etc.",id:"70asB5brJP",values:{maxUploads:M}}),U=(0,w.useCallback)(e=>{P(e)},[P]),I=(0,w.useMemo)(()=>({type:"file",accept:(0,i.cm)({imagesEnabled:x,outOfContextFilesEnabled:d,wiggleEnabled:_}).join(","),onChange:U,multiple:!0,"aria-label":m.formatMessage({defaultMessage:"Upload files",id:"2jjdVzJX0c"})}),[x,d,_,U,m]);return[C,j,z,A,E,T,(0,r.jsx)(p.m,{className:"text-center",tooltipContent:L,children:(0,r.jsxs)(N,{children:[(0,r.jsx)("input",{"data-testid":"file-upload",className:"absolute inset-0 -z-10 overflow-hidden rounded-xl opacity-0",...I}),C?(0,r.jsx)(y.N,{className:"animate-spin",size:18}):(0,r.jsx)(b.x,{size:18,weight:"light"})]})},"upload-tooltip"),I]}({syncSourceCount:t,onUploadComplete:(0,w.useCallback)(async(e,t)=>{m&&e.find(e=>m(e.extracted_content))&&x((0,r.jsx)(S.A,{defaultMessage:"The same attachment was already added earlier. Claude sees the full conversation when replying, so there’s no need to re-upload.",id:"Uo3qvhGn7z"})),c(t=>[...t,...e]),a(e=>[...e,...t])},[m,x,c,a]),existingAttachments:u,existingFiles:n,numExistingConversationAttachments:f,numExistingConversationFiles:o,selectedModel:null!=h?h:C,blobFileUploadsEnabled:g,customFileUploadHandler:_})}let L=async(e,t,n)=>{let a=new Image;if(a.src=URL.createObjectURL(e),await new Promise(e=>{a.onload=e,setTimeout(e,250)}),!a.width||!a.height||"image/png"!==e.type&&a.width<=t&&a.height<=n)return e;let r=a.width/a.height,i=a.width,s=a.height;a.width>t&&(s=(i=t)/r),s>n&&(i=(s=n)*r);let l=document.createElement("canvas");l.style.display="none",document.body.appendChild(l);let o=l.getContext("2d");if(!o||!o.imageSmoothingQuality)return document.body.removeChild(l),e;o.imageSmoothingQuality="high",l.width=i,l.height=s,o.drawImage(a,0,0,i,s);let u=await new Promise(e=>{l.toBlob(t=>e(t),"image/webp",.85)});return(document.body.removeChild(l),u)?new File([u],e.name,{type:"image/webp"}):e},U=()=>{let e=(0,u.mn)(),t=(0,x.useQueryClient)();return async(n,a,r)=>{let i=new FormData;i.append("file",n);let s=r?"/api/organizations/".concat(a,"/projects/").concat(r,"/upload"):"/api/".concat(a,"/upload"),l=await e(s,{method:"POST",body:i}),o=await l.json();if(l.ok)return r&&t.invalidateQueries({queryKey:[g.qz,{orgUuid:a,projectUuid:r}]}),o;throw(0,m.a5)(l.status,o,"File upload failed",l.headers)}},I=async(e,t,n,a)=>{let i,s=new FormData;s.append("file",t);try{i=await e("/api/organizations/".concat(n,"/convert_document"),{method:"POST",body:s})}catch(e){return(0,_.Cp)(e),a((0,r.jsx)(S.A,{defaultMessage:"One or more file uploads have failed. Please try again.",id:"FIwcYDeyIC"}))}if(429===i.status)return a((0,r.jsx)(S.A,{defaultMessage:"Too many file upload attempts. Please wait and try again later.",id:"h/6cMHSn1V"}));if(413===i.status)return a((0,r.jsx)(S.A,{defaultMessage:"Uploaded file is too large. Try uploading a smaller part of the document, or copy/pasting an excerpt from the file.",id:"/mCoauj3Ws"}));if(!i.ok)return a((0,r.jsx)(S.A,{defaultMessage:"Text extraction failed for one of the uploaded files. Please try again.",id:"ngYPeW4aWf"}));let l=await i.json();return l&&0!==Object.keys(l).length&&l.extracted_content?(l.file_name=T(t),l):a((0,r.jsx)(S.A,{defaultMessage:"Text extraction failed for one of the uploaded files. Please try again.",id:"ngYPeW4aWf"}))},O=e=>{var t;let{imagesEnabled:n,blobFileUploadsEnabled:a,rasterizePdfUploadsEnabled:s,onUploadComplete:l,onError:f,projectUuid:p,customFileUploadHandler:g}=e,{activeOrganization:y}=(0,c.YL)(),b=null!=(t=null==y?void 0:y.uuid)?t:"",[_,x]=(0,w.useState)(!1),{addError:k}=(0,d.Y)(),j=(0,w.useCallback)(e=>{x(!1),k(e),f&&f()},[k,f,x]),z=(()=>{let{value:e}=(0,v.fS)("use_canvas_resize");return(0,w.useCallback)(async t=>e?await L(t,2e3,2e3):t,[e])})(),M=(()=>{let e=R(),t=U();return async(n,a,r)=>{try{return await t(n,a,r)}catch(t){e(t,(0,i.cb)(n)?"image":"file")}}})(),T=(e=>{let t=R(),n=U(),a=(0,u.mn)();return async(r,i,s)=>{let l={};try{l.file=await n(r,i,s)}catch(n){n instanceof m.LG&&"document_too_many_pages"===n.errorCode?l.attachment=await F(a,r,i,e):t(n,"document")}return l}})(j),A=(0,u.mn)(),E=(0,o.st)(),P=(0,w.useCallback)(async(e,t)=>{if(g){x(!0);try{let t=await g(e);t&&t.length>0&&await l([],t)}catch(e){j(e instanceof Error?e.message:"File upload failed")}finally{x(!1)}return}let{attachmentUploads:o,imageUploads:u,rasterizedDocumentUploads:c,unsupportedUploads:d,tooLargeUploads:f,outOfContextFileUploads:m}=(0,i.kd)(e,{imagesEnabled:n,blobFileUploadsEnabled:a,rasterizePdfUploadsEnabled:s}),v=d.map(e=>(0,i.QC)(e.name));if(v.length>0)return j((0,r.jsx)(S.A,{defaultMessage:"Files of the following {count, plural, one {format is} other {formats are}} not supported: {formats}",id:"9JcWWPAZoB",values:{count:v.length,formats:(0,r.jsx)(C.dT,{type:"conjunction",value:[...new Set(v)]})}}));if(f.length>0)return E.track({event_key:"file_upload_too_large",large_files:f.map(e=>({file_type:e.type,file_size:e.size}))}),j((0,r.jsx)(S.A,{defaultMessage:"You may not upload files larger than 30mb.",id:"Gr/GvEZTX1"}));x(!0);let y=[],_=0,w=(e,n)=>{if(void 0===t)return!0;let a=new Blob([n]).size/h.t2;return!((_+=a)>t)||(j((0,r.jsx)(S.A,{defaultMessage:"Failed to upload file {filename}. Project knowledge exceeds maximum. Remove files to continue.",id:"MbvF6K3PJd",values:{filename:e}})),!1)};for(let e of o){let t=await F(A,e,b,j);if(!(t&&w(e.name,t.extracted_content)))return;await l([t],[])}for(let e of u){let t=await z(e),n=await M(t,b,p);n&&y.push(n)}for(let e of c){let{file:t,attachment:n}=await T(e,b,p);if(t&&y.push(t),n)if(!w(e.name,n.extracted_content))return;else await l([n],[])}for(let e of m){let t=await M(e,b,p);t&&y.push(t)}await l([],y),x(!1)},[a,A,l,n,j,M,T,b,z,E,s,p,g]);return{isUploading:_,setIsUploading:x,handleError:j,handleUpload:P}},N=f.J.label(z()),F=async(e,t,n,a)=>{if(!(0,i.eT)(t))try{let e=await (0,i.F9)(t);return((e,t)=>({file_name:T(e),file_type:e.type,file_size:e.size,extracted_content:t}))(t,e)}catch(e){}let r=await I(e,t,n,a);if(r)return E(r),r},R=()=>{let{addError:e}=(0,d.Y)();return(0,w.useCallback)((t,n)=>{if(t instanceof m.LG){if("rate_limit_error"===t.type)return void e((0,r.jsxs)("p",{children:[(0,r.jsx)(S.A,{defaultMessage:"You’ve reached your limit for {resourceType} uploads. Please try again later.",id:"M88GeEDB7r",values:{resourceType:n}}),(0,r.jsx)(j.W,{})]}));if("document_password_protected"===t.errorCode)return void e((0,r.jsx)("p",{children:(0,r.jsx)(S.A,{defaultMessage:"The document you uploaded is password protected. Please remove the password and try again.",id:"DHwwKwuaCR"})}))}if(t instanceof m.LG&&"Image is too large"===t.message)return void e((0,r.jsx)("p",{children:(0,r.jsx)(S.A,{defaultMessage:"Image is too large. <link>Learn more</link>",id:"SFbt+MAvby",values:{link:e=>(0,r.jsx)("a",{href:"https://support.anthropic.com/en/articles/9002500-what-kinds-of-images-can-i-upload-to-claude-ai",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-accent-main-100",children:e})}})}));e((0,r.jsx)("p",{children:(0,r.jsx)(S.A,{defaultMessage:"Your {resourceType} upload failed. Please try again.",id:"ymWsV10Pz1",values:{resourceType:n}})}))},[e])},D=()=>{let{value:e}=(0,v.fS)("janus_claude-ai");return e}},67094:(e,t,n)=>{n.d(t,{Ah:()=>S,I_:()=>C,L1:()=>b,Mf:()=>_,OC:()=>y,SK:()=>w,jg:()=>v,k0:()=>x,tW:()=>g,xt:()=>k});var a=n(68096),r=n(77186),i=n(1761),s=n(51121),l=n(22529),o=n(71473),u=n(27062),c=n(87606),d=n(7620),f=n(46760),p=n(75006),m=n(98251);let h=p.z.object({memory:p.z.string(),user_instructions:p.z.string().nullable().optional(),updated_at:p.z.string().datetime({offset:!0}).nullable().optional()}),g=(e,t)=>{var n;let{account:a,activeOrganization:s}=(0,i.YL)(),l=null==a?void 0:a.uuid,u=null==s?void 0:s.uuid,c=_(),d=e?"/api/organizations/".concat(u,"/memory/synthesis?project_uuid=").concat(e):"/api/organizations/".concat(u,"/memory/synthesis"),{data:f,isPending:p}=(0,r.Sk)(d,{queryKey:[o.IX,{accountUUID:l,orgUUID:u,projectUUID:e}],enabled:!!s&&(null==(n=null==t?void 0:t.enabled)||n)&&c},e=>h.parse(e));return{...f?{...f,user_instructions:(null==f?void 0:f.user_instructions)?f.user_instructions.split("\n\n").filter(Boolean):[]}:void 0,isPending:p}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:t,activeOrganization:n}=(0,i.YL)(),a=null==t?void 0:t.uuid,u=null==n?void 0:n.uuid,d=_(),{addError:p}=(0,s.Y)(),m=(0,f.A)(),h=(0,c.useQueryClient)(),{mutate:g,isPending:v}=(0,r.L2)("/api/organizations/".concat(u,"/memory/synthesize"),"POST",{enabled:!!n&&d,...e,onSuccess:function(){for(var t,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];let[s,l]=r;h.invalidateQueries({queryKey:[o.IX,{accountUUID:a,orgUUID:u,projectUUID:l.project_uuid}]}),null==(t=e.onSuccess)||t.call(e,...r)},onError:function(){for(var t,n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];null==(t=e.onError)||t.call(e,...a),p((0,l.O)({id:"frigid_umbrella_sunflower",intl:m}))}});return{synthesizeMemory:g,isSynthesizingMemory:v}},y=function(){let{projectUUID:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:t,activeOrganization:n}=(0,i.YL)(),a=null==t?void 0:t.uuid,u=null==n?void 0:n.uuid,c=_(),{addError:d,addSuccess:p}=(0,s.Y)(),m=(0,f.A)(),h=e=>e.join("\n\n"),{mutate:g,isPending:v}=(0,r.Qv)("/api/organizations/".concat(u,"/memory/instructions"),"PUT",(e,t)=>{var n;return{memory:null!=(n=null==t?void 0:t.memory)?n:"",updated_at:null==t?void 0:t.updated_at,user_instructions:h(e.user_instructions)}},{queryKey:[o.IX,{accountUUID:a,orgUUID:u,projectUUID:e}],enabled:!!n&&c,onSuccess:()=>{p((0,l.O)({id:"serif_net_popcorn",intl:m}))},onError:()=>{d((0,l.O)({id:"frigid_umbrella_sunflower",intl:m}))},transformVariables:e=>({...e,user_instructions:h(e.user_instructions)})});return{updateMemoryUserInstructions:g,updateMemoryUserInstructionsIsPending:v}},b=()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid,n=t?"/api/organizations/".concat(t,"/memory/themes"):null;return(0,r.Sk)(n,{staleTime:3e5,enabled:!!t&&!!n})},_=()=>{let{value:e}=(0,u.fS)("claudeai_saffron_enabled");return e},x=()=>{let{value:e}=(0,u.fS)("claudeai_saffron_themes_enabled");return e},w=()=>{var e;let{account:t}=(0,i.YL)(),{value:n}=(0,u.fS)("claudeai_saffron_default_enabled");return null!=(e=null==t?void 0:t.settings.enabled_saffron)?e:n},S=()=>{let{value:e}=(0,u.fS)("claudeai_saffron_search_enabled");return e},k=()=>{let{account:e}=(0,i.YL)(),t=(()=>{var e;let{account:t}=(0,i.YL)(),n=(()=>{let{value:e}=(0,u.fS)("claudeai_saffron_search_default_enabled");return e})();return null!=(e=null==t?void 0:t.settings.enabled_saffron_search)?e:n})(),n=S(),{mutate:r}=(0,a.Jy)(),{mutate:s}=(0,m.nI)(),l=(0,d.useRef)(null==e?void 0:e.settings);return(0,d.useEffect)(()=>{l.current=null==e?void 0:e.settings},[null==e?void 0:e.settings]),{toggleSaffronSearch:(0,d.useCallback)(e=>{r({...l.current,enabled_saffron_search:e}),n&&e&&s({})},[r,s,n]),saffronSearchEnabled:t}},C=()=>_()},67455:(e,t,n)=>{n.d(t,{EF:()=>h,NY:()=>f,Ql:()=>v,VA:()=>g,YO:()=>m,qJ:()=>p});var a=n(77186),r=n(1761),i=n(46612),s=n(71473),l=n(77101),o=n(87606),u=n(7620),c=n(91768),d=n(93049);let f=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,i=!!(t&&e.length>0),l=(0,u.useMemo)(()=>e.map(e=>"/api/organizations/".concat(n,"/sync/chat/").concat(e)),[n,e]),o=(0,u.useMemo)(()=>({queryKey:e.map(e=>[s.GC,{orgUuid:n,syncSourceUuid:e}]),enabled:i,refetchInterval:e=>!!(e.state.data&&(0,c.z3)(e.state.data))&&5e3,meta:{noToast:!0}}),[i,n,e]);return(0,a._i)(l,o)},p=e=>!!e.some(e=>e.isLoading)||e.some(e=>e.data&&(0,c.z3)(e.data)),m=e=>Math.ceil(f(e).reduce((e,t)=>{var n,a,r;return t.isLoading||!t.data?e:e+(null!=(r=null==(a=t.data)||null==(n=a.status)?void 0:n.current_size_bytes)?r:0)},0)/i.t2),h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:t,activeOrganization:n}=(0,r.YL)(),i=null==t?void 0:t.uuid,u=null==n?void 0:n.uuid,f=(0,o.useQueryClient)(),p=(0,c.eL)();return(0,a.L2)(()=>"/api/organizations/".concat(u,"/sync/chat"),"POST",{enabled:!!n,...e,onSuccess:function(){for(var t,n,a,r,o,c=arguments.length,d=Array(c),p=0;p<c;p++)d[p]=arguments[p];let[m]=d;f.setQueryData([s.GC,{orgUuid:u,syncSourceUuid:m.uuid}],m),m.type===l.v8.GDRIVE&&m.config.uri&&(null==(t=m.status)?void 0:t.extra)&&(null==(n=m.status)?void 0:n.current_size_bytes)&&f.setQueryData([s.QB,{accountUUID:i,orgUUID:u,documentId:m.config.uri}],{uri:"drive:///".concat(m.config.uri),title:null==(r=m.status)?void 0:r.extra,size:null==(o=m.status)?void 0:o.current_size_bytes}),null==(a=e.onSuccess)||a.call(e,...d)},onError:function(){for(var t,n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];null==(t=e.onError)||t.call(e,...a);let[i,s]=a;p(i,s),s.sync_source_type===l.v8.GDRIVE&&(0,d.D8)(s.sync_source_config.uri)}})},g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,i=(0,o.useQueryClient)();return(0,a.L2)(()=>"/api/organizations/".concat(n,"/sync/chat"),"PUT",{enabled:!!t,...e,onSuccess:function(){for(var t,a=arguments.length,r=Array(a),l=0;l<a;l++)r[l]=arguments[l];let[o]=r;i.setQueryData([s.GC,{orgUuid:n,syncSourceUuid:o.uuid}],o),null==(t=e.onSuccess)||t.call(e,...r)}})},v=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,a.L2)(e=>"/api/organizations/".concat(t,"/sync/chat/").concat(e),"DELETE",{enabled:!!e})}},71165:(e,t,n)=>{n.d(t,{S:()=>f,v:()=>d});var a=n(54568),r=n(41417),i=n(76761),s=n(60265),l=n(62942),o=n(25173),u=n(62971),c=n(50707);function d(e){let{isOpen:t,onClose:n,limitType:d="projects",customTitle:f,customDescription:p}=e,m=(0,l.useRouter)(),h=["opus"===d?{defaultMessage:"More Opus usage*",id:"JxRTAGj5OB"}:{defaultMessage:"Access to unlimited Projects to organize chats and documents",id:"uK9wA9v6Z3"},"opus"===d&&{defaultMessage:"Access to unlimited Projects to organize chats and documents",id:"uK9wA9v6Z3"},"projects"===d&&{defaultMessage:"More usage*",id:"Rve6Z5dM8k"},{defaultMessage:"Ability to search the web",id:"dl29r7OlXE"},{defaultMessage:"Extended thinking for complex work",id:"mENE7vJhVQ"},{defaultMessage:"Connect Google Workspace: email, calendar, and docs",id:"WwXweMd3IE"},{defaultMessage:"Ability to use more Claude models",id:"Qpr1Da1f7N"}].filter(Boolean);return(0,a.jsx)(o.bL,{open:t,onOpenChange:n,children:(0,a.jsx)(o.ZL,{children:(0,a.jsx)(o.hJ,{className:"fixed inset-0 bg-always-black/50 backdrop-brightness-75 z-modal flex items-center justify-center data-[state=open]:animate-[fade_250ms_ease-in_forwards] data-[state=closed]:animate-[fade_125ms_ease-out_reverse_forwards]",children:(0,a.jsxs)(o.UC,{className:"z-modal w-full max-w-sm bg-bg-000 rounded-2xl shadow-xl overflow-hidden focus:outline-none data-[state=open]:animate-[zoom_250ms_ease-in_forwards] data-[state=closed]:animate-[zoom_125ms_ease-out_reverse_forwards]",onEscapeKeyDown:e=>{e.preventDefault(),n()},onInteractOutside:e=>{e.preventDefault(),n()},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-5 pt-4",children:[(0,a.jsx)(c.M,{}),(0,a.jsx)(o.bm,{asChild:!0,children:(0,a.jsx)(r.$,{variant:"ghost",size:"icon_sm",className:"text-text-400 hover:text-text-200",children:(0,a.jsx)(i.X,{size:20,weight:"regular"})})})]}),(0,a.jsxs)("div",{className:"px-5 pb-4 pt-2",children:[(0,a.jsx)("h2",{className:"text-[24px] leading-tight font-medium mb-2 text-text-000",children:f||("opus"===d?(0,a.jsx)(u.A,{defaultMessage:"More Opus with Pro and Max plans",id:"//ixi/rP/O"}):(0,a.jsx)(u.A,{defaultMessage:"Unlimited projects with Pro and Max plans",id:"RKBJDiWP1p"}))}),(0,a.jsx)("p",{className:"text-base text-text-300 mb-3",children:p||("opus"===d?(0,a.jsx)(u.A,{defaultMessage:"Free plans only get 3 Opus messages per week. Try again after {date}, or upgrade now to get:",id:"IIJcLbtXZK",values:{date:new Date(Date.now()+6048e5).toLocaleDateString("en-US",{month:"long",day:"numeric"})}}):(0,a.jsx)(u.A,{defaultMessage:"Free plans only get access to one Project. Upgrade now to get:",id:"NOiyw9Bber"}))}),(0,a.jsx)("div",{className:"space-y-1.5 mb-6",children:h.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,a.jsx)(s.J,{className:"text-text-400 mt-0.5 flex-shrink-0",size:18,weight:"regular"}),(0,a.jsx)("span",{className:"text-sm text-text-200",children:(0,a.jsx)(u.A,{...e})})]},"benefit-".concat(t)))}),("opus"===d||"projects"===d)&&(0,a.jsx)("p",{className:"text-xs text-text-400 mb-4",children:(0,a.jsx)("a",{href:"https://support.anthropic.com/en/articles/11049762-choosing-a-claude-ai-plan",target:"_blank",rel:"noopener noreferrer",className:"text-text-400 underline hover:text-text-300",children:(0,a.jsx)(u.A,{defaultMessage:"*Usage limits apply",id:"HFRZOFWXCf"})})}),(0,a.jsx)(r.$,{variant:"primary",size:"lg",className:"w-full text-base font-medium",onClick:()=>{n(),m.push("/upgrade")},children:(0,a.jsx)(u.A,{defaultMessage:"See plans",id:"vbFKkTYpN+"})})]})]})})})})}let f=d},72431:(e,t,n)=>{n.d(t,{S:()=>d,r:()=>f});var a=n(54568),r=n(89256),i=n.n(r),s=n(62942),l=n(7620),o=n(67094);let u="incognito",c=l.createContext({incognitoModeEnabled:!1,setIncognitoModeEnabled:i(),temporaryConversationUUID:null,setTemporaryConversationUUID:i()}),d=()=>l.useContext(c),f=e=>{let{children:t}=e,n=(0,s.useRouter)(),r=(0,s.useSearchParams)(),i=(0,o.I_)(),d=r.has(u),[f,p]=(0,l.useState)(d),m=(0,l.useRef)(f),[h,g]=(0,l.useState)(null);(0,l.useEffect)(()=>{m.current=f},[f]);let v=(0,l.useCallback)(e=>{if(p(e),e)n.push("?".concat(u));else{g(null);let e=new URLSearchParams(r.toString());e.delete(u);let t=e.toString();n.push("".concat(window.location.pathname).concat(t?"?".concat(t):""),void 0)}},[n,r]);(0,l.useEffect)(()=>{m.current&&!d&&v(!1)},[v,d]);let y=(0,l.useMemo)(()=>({incognitoModeEnabled:!!i&&f,setIncognitoModeEnabled:v,temporaryConversationUUID:i?h:null,setTemporaryConversationUUID:g}),[f,v,h,g,i]);return(0,a.jsx)(c.Provider,{value:y,children:t})}},74530:(e,t,n)=>{function a(e){return"text"===e.type&&e.text?{...e,text:e.text.replace("​","")}:e.content?{...e,content:e.content.map(a)}:e}n.d(t,{DV:()=>a,h0:()=>r});let r=e=>{let t="",n=0,a=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("doc"===e.type&&e.content)for(let t of e.content)a(t);else if("paragraph"===e.type){if(e.content)for(let t of e.content)a(t);t+="\n"}else if("text"===e.type){let n=e.text;if(e.marks)for(let t of e.marks)"bold"===t.type?n="**".concat(n,"**"):"italic"===t.type?n="*".concat(n,"*"):"underline"===t.type?n="__".concat(n,"__"):"strike"===t.type?n="~~".concat(n,"~~"):"code"===t.type&&(n="`".concat(n,"`"));t+=n}else if("codeBlock"===e.type){let n=e.attrs&&"string"==typeof e.attrs.language?e.attrs.language:"";if(t+="\n```".concat(n,"\n"),e.content)for(let t of e.content)a(t);t+="\n```\n\n"}else if("bulletList"===e.type&&e.content)for(let t of e.content)a(t);else if("orderedList"===e.type&&e.content)for(let t=0;t<e.content.length;t++)a(e.content[t],t+1,!0);else if("listItem"===e.type&&e.content){let s="   ".repeat(n);for(let l of(i?t+="".concat(s).concat(r,". "):t+="".concat(s,"* "),e.content))n+=1,a(l),n-=1}};return a(e),t.replace("​","").trim()}},85644:(e,t,n)=>{n.d(t,{A9:()=>p,Wq:()=>m,fC:()=>c});var a=n(77186),r=n(1761),i=n(71473),s=n(27062),l=n(85544),o=n(75006);let u={image_in:!0,pdf_in:!1},c=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,{data:s,isLoading:l,isPlaceholderData:o}=(0,a.Sk)("/api/organizations/".concat(n,"/model_configs/").concat(e),{queryKey:[i.yV,n,e],enabled:!!n,staleTime:3e5,meta:{noToast:!0}});return{isLoading:l,modelConfig:!o&&s||u}},d=o.z.array(o.z.object({model:o.z.string(),name:o.z.string(),description:o.z.string().optional(),description_i18n_key:o.z.string().optional(),notice_text:o.z.string().optional(),notice_text_i18n_key:o.z.string().optional(),inactive:o.z.boolean().optional(),overflow:o.z.boolean().optional(),knowledgeCutoff:o.z.string().optional(),slow_kb_warning_threshold:o.z.number().optional(),paprika_modes:o.z.array(l.T4).optional(),capabilities:o.z.object({mm_pdf:o.z.boolean().optional(),mm_images:o.z.boolean().optional(),web_search:o.z.boolean().optional(),gsuite_tools:o.z.boolean().optional(),compass:o.z.boolean().optional()}).optional()})),f=[],p=()=>{var e;let{value:t}=(0,s.fS)("backend_model_config"),{activeOrganization:n}=(0,r.YL)(),a=(0,s.T9)("claude_ai_models","models",f,d),i=t?null!=(e=null==n?void 0:n.claude_ai_bootstrap_models_config)?e:f:a,l=i.filter(e=>!e.inactive),o=l.filter(e=>!e.overflow),u=l.filter(e=>e.overflow);return{allModelOptions:i,activeModelOptions:l,mainModels:o,overflowModels:u}},m=()=>{let{allModelOptions:e}=p();return(t,n)=>{let a=e.find(e=>e.model===t);if(!a)return!1;let r=null==a?void 0:a.capabilities;return!r||!1!==r[n]}}},93049:(e,t,n)=>{n.d(t,{Ac:()=>i,D8:()=>l,bI:()=>s});let a="recentDriveDocs";function r(e){return"object"==typeof e&&null!==e&&"string"==typeof e.uri&&("string"==typeof e.title||void 0===e.title)}function i(e){localStorage.setItem(a,JSON.stringify(e))}function s(){if("undefined"==typeof localStorage)return[];let e=localStorage.getItem(a);if(e){let t=JSON.parse(e);if(t&&Array.isArray(t)&&t.every(r))return t}return[]}function l(e){let t=s();i(t=t.filter(t=>t.uri!==e))}}}]);